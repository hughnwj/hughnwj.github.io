<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>8.Agentå®æˆ˜æŠ€èƒ½ä¹‹Difyæ™ºèƒ½åº”ç”¨å¼€å‘</title>
      <link href="/2025/03/23/8.Agent%E5%AE%9E%E6%88%98%E6%8A%80%E8%83%BD%E4%B9%8BDify%E6%99%BA%E8%83%BD%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/"/>
      <url>/2025/03/23/8.Agent%E5%AE%9E%E6%88%98%E6%8A%80%E8%83%BD%E4%B9%8BDify%E6%99%BA%E8%83%BD%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.Agentå®æˆ˜åŸºç¡€ä¹‹ReActæ¶æ„å®æˆ˜</title>
      <link href="/2025/03/23/7.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BReAct%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98/"/>
      <url>/2025/03/23/7.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BReAct%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Agentæµè¡Œçš„å·¥ä½œæ–¹å¼"><a href="#1-Agentæµè¡Œçš„å·¥ä½œæ–¹å¼" class="headerlink" title="1. Agentæµè¡Œçš„å·¥ä½œæ–¹å¼"></a>1. Agentæµè¡Œçš„å·¥ä½œæ–¹å¼</h1><p><img src="/images/7.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BReAct%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98/image-20250323144652133.png" alt="image-20250323144652133"></p><h1 id="2-æ‰‹åŠ¨å®ç°ReActæ™ºèƒ½åº”ç”¨æ¡†æ¶"><a href="#2-æ‰‹åŠ¨å®ç°ReActæ™ºèƒ½åº”ç”¨æ¡†æ¶" class="headerlink" title="2. æ‰‹åŠ¨å®ç°ReActæ™ºèƒ½åº”ç”¨æ¡†æ¶"></a>2. æ‰‹åŠ¨å®ç°ReActæ™ºèƒ½åº”ç”¨æ¡†æ¶</h1><h2 id="2-1-ReAct-æ¶æ„"><a href="#2-1-ReAct-æ¶æ„" class="headerlink" title="2.1 ReAct æ¶æ„"></a>2.1 ReAct æ¶æ„</h2><p><img src="/images/7.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BReAct%E6%9E%B6%E6%9E%84%E5%AE%9E%E6%88%98/image-20250323145522620.png" alt="image-20250323145522620"></p><p>&emsp;&emsp;ReAct Agent ä¹Ÿç§°ä¸º <code>ReAct</code>ï¼Œæ˜¯ä¸€ä¸ªç”¨äºæç¤ºå¤§è¯­è¨€æ¨¡å‹çš„æ¡†æ¶ï¼Œå®ƒé¦–æ¬¡åœ¨ 2022 å¹´ 10 æœˆçš„è®ºæ–‡<a href="https://arxiv.org/pdf/2210.03629">ã€ŠReActï¼šSynergizing Reasoning and Acting in Language Modelsã€‹</a>ä¸­å¼•å…¥ï¼Œå¹¶äº2023 å¹´ 3 æœˆä¿®è®¢ã€‚è¯¥æ¡†æ¶çš„å¼€å‘æ˜¯ä¸ºäº†ååŒå¤§è¯­è¨€æ¨¡å‹ä¸­çš„æ¨ç†å’Œè¡ŒåŠ¨ï¼Œä½¿å®ƒä»¬æ›´åŠ å¼ºå¤§ã€é€šç”¨å’Œå¯è§£é‡Šã€‚é€šè¿‡äº¤å‰æ¨ç†å’Œè¡ŒåŠ¨ï¼ŒReAct ä½¿æ™ºèƒ½ä½“èƒ½å¤ŸåŠ¨æ€åœ°åœ¨äº§ç”Ÿæƒ³æ³•å’Œç‰¹å®šäºä»»åŠ¡çš„è¡ŒåŠ¨ä¹‹é—´äº¤æ›¿ã€‚</p><p>&emsp;&emsp;ReAct æ¡†æ¶æœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼Œç”± <code>Reason</code> å’Œ <code>Act</code> ç»“åˆè€Œæ¥ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œè¿™ç§æ–¹æ³•çš„çµæ„Ÿæ¥è‡ªäºäººç±»å¦‚ä½•é€šè¿‡å’Œè°åœ°ç»“åˆæ€ç»´å’Œè¡ŒåŠ¨æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå°±åƒæˆ‘ä»¬ä¸Šé¢â€œæˆ‘æƒ³å»åŒ—äº¬æ—…æ¸¸â€è¿™ä¸ªçœŸå®ç¤ºä¾‹ä¸€æ ·ã€‚</p><p>&emsp;&emsp;é¦–å…ˆç¬¬ä¸€éƒ¨åˆ† Reasonï¼Œå®ƒåŸºäºä¸€ç§æ¨ç†æŠ€æœ¯â€”â€”<a href="https://arxiv.org/pdf/2201.11903">æ€æƒ³é“¾ï¼ˆCoTï¼‰</a>ï¼Œ CoTæ˜¯ä¸€ç§æç¤ºå·¥ç¨‹ï¼Œé€šè¿‡å°†è¾“å…¥åˆ†è§£ä¸ºå¤šä¸ªé€»è¾‘æ€ç»´æ­¥éª¤ï¼Œå¸®åŠ©å¤§è¯­è¨€æ¨¡å‹æ‰§è¡Œæ¨ç†å¹¶è§£å†³å¤æ‚é—®é¢˜ã€‚è¿™ä½¿å¾—å¤§æ¨¡å‹èƒ½å¤ŸæŒ‰é¡ºåºè§„åˆ’å’Œè§£å†³ä»»åŠ¡çš„æ¯ä¸ªéƒ¨åˆ†ï¼Œä»è€Œæ›´å‡†ç¡®åœ°è·å¾—æœ€ç»ˆç»“æœï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p><ul><li>åˆ†è§£é—®é¢˜ï¼šå½“é¢å¯¹å¤æ‚çš„ä»»åŠ¡æ—¶ï¼ŒCoT æ–¹æ³•ä¸æ˜¯é€šè¿‡å•ä¸ªæ­¥éª¤è§£å†³å®ƒï¼Œè€Œæ˜¯å°†ä»»åŠ¡åˆ†è§£ä¸ºæ›´å°çš„æ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤è§£å†³ä¸åŒæ–¹é¢çš„é—®é¢˜ã€‚</li><li>é¡ºåºæ€ç»´ï¼šæ€ç»´é“¾ä¸­çš„æ¯ä¸€æ­¥éƒ½å»ºç«‹åœ¨ä¸Šä¸€æ­¥çš„ç»“æœä¹‹ä¸Šã€‚è¿™æ ·ï¼Œæ¨¡å‹å°±èƒ½ä»å¤´åˆ°å°¾æ„é€ å‡ºä¸€æ¡é€»è¾‘æ¨ç†é“¾ã€‚</li></ul><h2 id="2-2-æç¤ºè¯è®¾è®¡"><a href="#2-2-æç¤ºè¯è®¾è®¡" class="headerlink" title="2.2 æç¤ºè¯è®¾è®¡"></a>2.2 æç¤ºè¯è®¾è®¡</h2><h3 id="2-2-1-æŒ‡å®šè§’è‰²"><a href="#2-2-1-æŒ‡å®šè§’è‰²" class="headerlink" title="2.2.1 æŒ‡å®šè§’è‰²"></a>2.2.1 æŒ‡å®šè§’è‰²</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨åœ¨ä¸€ä¸ªç”±â€œæ€è€ƒã€è¡ŒåŠ¨ã€è§‚å¯Ÿã€å›ç­”<span class="string">&quot;ç»„æˆçš„å¾ªç¯ä¸­è¿è¡Œã€‚</span></span><br><span class="line"><span class="string">åœ¨å¾ªç¯çš„æœ€åï¼Œæ‚¨è¾“å‡ºä¸€ä¸ªç­”æ¡ˆã€‚</span></span><br><span class="line"><span class="string">ä½¿ç”¨â€œæ€è€ƒâ€æ¥æè¿°æ‚¨å¯¹æ‰€æé—®é¢˜çš„æ€è€ƒã€‚</span></span><br><span class="line"><span class="string">ä½¿ç”¨â€œè¡ŒåŠ¨&quot;</span>æ¥æ‰§è¡Œæ‚¨å¯ç”¨çš„åŠ¨ä½œä¹‹ä¸€-ã€‚</span><br><span class="line">â€œè§‚å¯Ÿâ€å°†æ˜¯æ‰§è¡Œè¿™äº›åŠ¨ä½œçš„ç»“æœã€‚</span><br><span class="line">â€œå›ç­”â€å°†æ˜¯åˆ†æâ€œè§‚å¯Ÿ<span class="string">&quot;ç»“æœåå¾—å‡ºçš„ç­”æ¡ˆã€‚</span></span><br></pre></td></tr></table></figure><h3 id="2-2-2-æŒ‡å®šå·¥å…·"><a href="#2-2-2-æŒ‡å®šå·¥å…·" class="headerlink" title="2.2.2 æŒ‡å®šå·¥å…·"></a>2.2.2 æŒ‡å®šå·¥å…·</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¯ç”¨çš„åŠ¨ä½œåŒ…æ‹¬:</span><br><span class="line">calculate (è®¡ç®—) :</span><br><span class="line">ä¾‹å¦‚: calculate:<span class="number">4</span>*<span class="number">7</span>/<span class="number">3</span></span><br><span class="line">æ‰§è¡Œè®¡ç®—å¹¶è¿”å›æ•°å­—ã€‚ä½¿ç”¨Python,å¦‚æœ‰å¿…è¦è¯·ç¡®ä¿ä½¿ç”¨æµ®ç‚¹æ•°è¯­æ³•</span><br><span class="line">wikipedia (ç»´åŸºç™¾ç§‘) :</span><br><span class="line">ä¾‹å¦‚: wikipedia: Django</span><br><span class="line">è¿”å›ä»ç»´åŸºç™¾æ–™æœç´¢çš„æ‘˜è¦</span><br></pre></td></tr></table></figure><h3 id="2-2-3-ç»™å‡ºç¤ºä¾‹"><a href="#2-2-3-ç»™å‡ºç¤ºä¾‹" class="headerlink" title="2.2.3 ç»™å‡ºç¤ºä¾‹"></a>2.2.3 ç»™å‡ºç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ä¼šè¯:</span><br><span class="line">é—®é¢˜:æ³•å›½çš„é¦–éƒ½æ˜¯ä»€ä¹ˆ?</span><br><span class="line">æ€è€ƒ:æˆ‘åº”è¯¥åœ¨ç»´åŸºç™¾ç§‘ä¸ŠæŸ¥æ‰¾å…³äºæ³•å›½çš„ä¿¡æ¯</span><br><span class="line">è¡ŒåŠ¨: wikipedia: France</span><br><span class="line">ç„¶åæ‚¨åº”è¯¥è°ƒç”¨é€‚å½“çš„åŠ¨ä½œï¼Œå¹¶ä»ç»“æœä¸­ç¡®å®šç­”æ¡ˆ</span><br><span class="line">æ‚¨ç„¶åè¾“å‡º:</span><br><span class="line">å›ç­”:æ³•å›½çš„é¦–éƒ½æ˜¯å·´é»</span><br></pre></td></tr></table></figure><h2 id="2-3-æ‰‹å†™ReAct-Agent"><a href="#2-3-æ‰‹å†™ReAct-Agent" class="headerlink" title="2.3 æ‰‹å†™ReAct Agent"></a>2.3 æ‰‹å†™ReAct Agent</h2><h3 id="2-3-1-å®šä¹‰å¤§æ¨¡å‹æ¥å£"><a href="#2-3-1-å®šä¹‰å¤§æ¨¡å‹æ¥å£" class="headerlink" title="2.3.1 å®šä¹‰å¤§æ¨¡å‹æ¥å£"></a>2.3.1 å®šä¹‰å¤§æ¨¡å‹æ¥å£</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ChatBot</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, system=<span class="string">&quot;&quot;</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.system = system</span><br><span class="line">        <span class="variable language_">self</span>.messages = []</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.system:</span><br><span class="line">            <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: system&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, message</span>):</span><br><span class="line">        <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: message&#125;)</span><br><span class="line">        result = <span class="variable language_">self</span>.execute()</span><br><span class="line">        <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: result&#125;)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self</span>):</span><br><span class="line">        completion = client.chat.completions.create(model=<span class="string">&quot;gpt-4o&quot;</span>, messages=<span class="variable language_">self</span>.messages)</span><br><span class="line">        <span class="keyword">return</span> completion.choices[<span class="number">0</span>].message.content</span><br></pre></td></tr></table></figure><blockquote><p>&emsp;&emsp;å¦‚ä¸Šæ‰€ç¤ºï¼Œè¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ª<code>ChatBot</code>çš„ç±»ï¼Œç”¨æ¥åˆ›å»ºå’Œå¤„ç†ä¸€ä¸ªåŸºäº<code>OpenAI GPT-4</code>æ¨¡å‹çš„èŠå¤©æœºå™¨äººã€‚ä¸‹é¢æ˜¯æ¯ä¸ªéƒ¨åˆ†çš„å…·ä½“è§£é‡Šï¼š</p><ul><li><strong>init</strong> æ–¹æ³•ç”¨æ¥æ¥æ”¶ç³»ç»Ÿæç¤º(System Prompt)ï¼Œå¹¶è¿½åŠ åˆ°å…¨å±€çš„æ¶ˆæ¯åˆ—è¡¨ä¸­ã€‚</li><li><strong>call</strong> æ–¹æ³•æ˜¯ <code>Python</code> ç±»çš„ä¸€ä¸ªç‰¹æ®Šæ–¹æ³•, å½“å¯¹ä¸€ä¸ªç±»çš„å®ä¾‹åƒè°ƒç”¨å‡½æ•°ä¸€æ ·ä¼ é€’å‚æ•°å¹¶æ‰§è¡Œæ—¶ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨è°ƒç”¨è¿™ä¸ªç±»çš„ <strong>call</strong> æ–¹æ³•ã€‚å…¶å†…éƒ¨ä¼š è°ƒç”¨<code>execute</code> æ–¹æ³•ã€‚</li><li>execute æ–¹æ³•å®é™…ä¸Šå°±æ˜¯ä¸<code>OpenAI</code>çš„APIè¿›è¡Œäº¤äº’ï¼Œå‘é€ç´¯ç§¯çš„æ¶ˆæ¯å†å²ï¼ˆåŒ…æ‹¬ç³»ç»Ÿæ¶ˆæ¯ã€ç”¨æˆ·æ¶ˆæ¯å’Œä¹‹å‰çš„å›åº”ï¼‰åˆ°OpenAIçš„èŠå¤©æ¨¡å‹,è¿”å›æœ€ç»ˆçš„å“åº”ã€‚</li></ul></blockquote><h3 id="2-3-2-å®šä¹‰ä»£ç†å¾ªç¯é€»è¾‘"><a href="#2-3-2-å®šä¹‰ä»£ç†å¾ªç¯é€»è¾‘" class="headerlink" title="2.3.2 å®šä¹‰ä»£ç†å¾ªç¯é€»è¾‘"></a>2.3.2 å®šä¹‰ä»£ç†å¾ªç¯é€»è¾‘</h3><p>&emsp;&emsp;ä»<code>Thought</code> åˆ° <code>Action</code> ï¼Œ æœ€ååˆ° <code>Observation</code> çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªå¾ªç¯çš„é€»è¾‘ï¼Œè€Œå¾ªç¯çš„æ¬¡æ•°ï¼Œå–å†³äºå¤§æ¨¡å‹å°†ç”¨æˆ·çš„åŸå§‹ <code>Goal</code> åˆ†æˆäº†å¤šå°‘ä¸ªå­ä»»åŠ¡ã€‚ æ‰€æœ‰åœ¨è¿™æ ·çš„é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å»å¤„ç†çš„æ˜¯ï¼š</p><ol><li>åˆ¤æ–­å¤§æ¨¡å‹å½“å‰å¤„äºå“ªä¸€ä¸ªçŠ¶æ€é˜¶æ®µ</li><li>å¦‚æœåœç•™åœ¨ <code>Action</code> é˜¶æ®µï¼Œéœ€è¦åƒè°ƒç”¨ Function Calling çš„è¿‡ç¨‹ä¸€æ ·ï¼Œå…ˆæ‰§è¡Œå·¥å…·ï¼Œå†å°†å·¥å…·çš„æ‰§è¡Œç»“æœä¼ é€’ç»™<code>Obversation</code> çŠ¶æ€é˜¶æ®µã€‚</li></ol><p>&emsp;ç”±æ­¤ï¼Œæˆ‘ä»¬å®šä¹‰äº†å¦‚ä¸‹çš„ä¸€ä¸ª <code>AgentExecutor</code>å‡½æ•°ã€‚è¯¥å‡½æ•°å®ç°ä¸€ä¸ªå¾ªç¯ï¼Œæ£€æµ‹çŠ¶æ€å¹¶ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–å½“å‰åœç•™çš„çŠ¶æ€é˜¶æ®µã€‚ä¸æ–­åœ°è¿­ä»£ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„ï¼ˆæˆ–è€…æˆ‘ä»¬å·²è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼‰è°ƒç”¨æ“ä½œï¼Œå†è¿”å›æœ€ç»ˆçš„å“åº”ã€‚å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">action_re = re.<span class="built_in">compile</span>(<span class="string">&#x27;^Action: (\w+): (.*)$&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AgentExecutor</span>(<span class="params">question, max_turns=<span class="number">5</span></span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    bot = ChatBot(system_prompt)</span><br><span class="line">    <span class="comment"># é€šè¿‡ next_prompt æ ‡è¯†æ¯ä¸€ä¸ªå­ä»»åŠ¡çš„é˜¶æ®µæ€§è¾“å…¥</span></span><br><span class="line">    next_prompt = question</span><br><span class="line">    <span class="keyword">while</span> i &lt; max_turns:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="comment"># è¿™é‡Œè°ƒç”¨çš„å°±æ˜¯ ChatBot ç±»çš„ __call__ æ–¹æ³•</span></span><br><span class="line">        result = bot(next_prompt)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;result:<span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># åœ¨è¿™é‡Œé€šè¿‡æ­£åˆ™åˆ¤æ–­æ˜¯å¦åˆ°äº†éœ€è¦è°ƒç”¨å‡½æ•°çš„Actioné˜¶æ®µ</span></span><br><span class="line">        actions = [action_re.<span class="keyword">match</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> result.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> action_re.<span class="keyword">match</span>(a)]</span><br><span class="line">        <span class="keyword">if</span> actions:</span><br><span class="line">            <span class="comment"># æå–è°ƒç”¨çš„å·¥å…·åå’Œå·¥å…·æ‰€éœ€çš„å…¥å‚</span></span><br><span class="line">            action, action_input = actions[<span class="number">0</span>].groups()</span><br><span class="line">            <span class="keyword">if</span> action <span class="keyword">not</span> <span class="keyword">in</span> available_actions:</span><br><span class="line">                <span class="keyword">raise</span> Exception(<span class="string">&quot;Unknown action: &#123;&#125;: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(action, action_input))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;running: <span class="subst">&#123;action&#125;</span> <span class="subst">&#123;action_input&#125;</span>&quot;</span>)</span><br><span class="line">            observation = available_actions[action](action_input)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Observation: <span class="subst">&#123;observation&#125;</span>&quot;</span>)</span><br><span class="line">            next_prompt = <span class="string">&quot;Observation: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(observation)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> bot.messages</span><br></pre></td></tr></table></figure><h3 id="2-3-3-LangChainå†…ç½®çš„ReActæ¡†æ¶"><a href="#2-3-3-LangChainå†…ç½®çš„ReActæ¡†æ¶" class="headerlink" title="2.3.3 LangChainå†…ç½®çš„ReActæ¡†æ¶"></a>2.3.3 LangChainå†…ç½®çš„ReActæ¡†æ¶</h3><p>&emsp;&emsp;å°±ç›®å‰çš„AI Agent ç°çŠ¶è€Œè¨€ï¼Œæµè¡Œçš„ä»£ç†æ¡†æ¶éƒ½æœ‰å†…ç½®çš„ ReAct ä»£ç†ï¼Œæ¯”å¦‚<code>Langchain</code>ã€<code>LlamaIndex</code>ä¸­çš„ä»£ç†ï¼Œæˆ–è€… <code>CrewAI</code>è¿™ç§æ–°å…´èµ·çš„AI Agentå¼€å‘æ¡†æ¶ï¼Œéƒ½æ˜¯åŸºäºReActç†å¿µçš„ä¸€ç§å˜ç§ã€‚LangChain çš„ ReAct ä»£ç†å·¥ç¨‹æè¿° ğŸ‘‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Answer the following questions <span class="keyword">as</span> best you can. You have access </span><br><span class="line">to the following tools:</span><br><span class="line"></span><br><span class="line">&#123;tools&#125;</span><br><span class="line"></span><br><span class="line">Use the following <span class="built_in">format</span>:</span><br><span class="line"></span><br><span class="line">Question: the <span class="built_in">input</span> question you must answer</span><br><span class="line">Thought: you should always think about what to do</span><br><span class="line">Action: the action to take, should be one of [&#123;tool_names&#125;]</span><br><span class="line">Action Input: the <span class="built_in">input</span> to the action</span><br><span class="line">Observation: the result of the action</span><br><span class="line"><span class="meta">... </span>(this Thought/Action/Action Input/Observation can repeat N times)</span><br><span class="line">Thought: I now know the final answer</span><br><span class="line">Final Answer: the final answer to the original <span class="built_in">input</span> question</span><br><span class="line"></span><br><span class="line">Begin!</span><br><span class="line"></span><br><span class="line">Question: &#123;<span class="built_in">input</span>&#125;</span><br><span class="line">Thought:&#123;agent_scratchpad&#125;</span><br><span class="line"></span><br><span class="line">There are three placeholders &#123;tool&#125;, &#123;<span class="built_in">input</span>&#125;, <span class="keyword">and</span> &#123;agent_scratchpad&#125; <span class="keyword">in</span> this prompt. These will be replaced <span class="keyword">with</span> the appropriate text before sending it to LLM.</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å°½ä½ æ‰€èƒ½å›ç­”ä»¥ä¸‹é—®é¢˜ã€‚æ‚¨æœ‰è®¿é—®æƒé™</span><br><span class="line">ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š</span><br><span class="line"></span><br><span class="line">&#123;tool&#125;</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼šæ‚¨å¿…é¡»å›ç­”çš„è¾“å…¥é—®é¢˜</span><br><span class="line">æ€è€ƒï¼šä½ åº”è¯¥å§‹ç»ˆæ€è€ƒè¯¥åšä»€ä¹ˆ</span><br><span class="line">æ“ä½œï¼šè¦é‡‡å–çš„æ“ä½œï¼Œåº”è¯¥æ˜¯ã€”ï½›tool_namesï½ã€•ä¹‹ä¸€</span><br><span class="line">åŠ¨ä½œè¾“å…¥ï¼šåŠ¨ä½œçš„è¾“å…¥</span><br><span class="line">è§‚å¯Ÿï¼šè¡ŒåŠ¨çš„ç»“æœ</span><br><span class="line">â€¦ï¼ˆè¿™ä¸ªæƒ³æ³•/è¡ŒåŠ¨/è¡ŒåŠ¨è¾“å…¥/è§‚å¯Ÿå¯ä»¥é‡å¤Næ¬¡ï¼‰</span><br><span class="line">æƒ³ï¼šæˆ‘ç°åœ¨çŸ¥é“æœ€ç»ˆç­”æ¡ˆäº†</span><br><span class="line">æœ€ç»ˆç­”æ¡ˆï¼šåŸå§‹è¾“å…¥é—®é¢˜çš„æœ€ç»ˆç­”æ¡ˆ</span><br><span class="line"></span><br><span class="line">å¼€å§‹ï¼</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼š&#123;<span class="built_in">input</span>&#125;</span><br><span class="line">æ€è€ƒï¼š&#123;agent_scratchpad&#125;</span><br><span class="line"></span><br><span class="line">æ­¤æç¤ºä¸­æœ‰ä¸‰ä¸ªå ä½ç¬¦&#123;tool&#125;ã€&#123;<span class="built_in">input</span>&#125;å’Œ&#123;agent_scratchpad&#125;ã€‚åœ¨å‘é€ç»™LLMä¹‹å‰ï¼Œè¿™äº›å°†è¢«æ›¿æ¢ä¸ºé€‚å½“çš„æ–‡æœ¬ã€‚</span><br></pre></td></tr></table></figure><h1 id="3-åŸºäº-ReAct-Agent-å®ç°æ™ºèƒ½å®¢æœ"><a href="#3-åŸºäº-ReAct-Agent-å®ç°æ™ºèƒ½å®¢æœ" class="headerlink" title="3. åŸºäº ReAct Agent å®ç°æ™ºèƒ½å®¢æœ"></a>3. åŸºäº ReAct Agent å®ç°æ™ºèƒ½å®¢æœ</h1><h2 id="3-1-æç¤ºè¯è®¾è®¡"><a href="#3-1-æç¤ºè¯è®¾è®¡" class="headerlink" title="3.1 æç¤ºè¯è®¾è®¡"></a>3.1 æç¤ºè¯è®¾è®¡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">self</span>.system_prompt = <span class="string">&quot;&quot;&quot; ä½ æ˜¯ä¸€ä½æ™ºèƒ½çš„ç”µå­å•†åŠ¡å¹³å°å®¢æœåŠ©æ‰‹ã€‚å¿…é¡»åŠæ—¶å›ç­”ç”¨æˆ·å…³äºäº§å“çš„å’¨è¯¢ã€‚å¦‚æœé—®é¢˜ä¸å…·ä½“äº§å“æ— å…³ï¼Œä½ å¯ä»¥ç›´æ¥å›ç­”ã€‚ è¾“å‡ºæ ¼å¼ä¸ºï¼šAnswer: [ä½ çš„å›ç­”]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç¤ºä¾‹ï¼š Answer: è¿˜æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®æ‚¨çš„å—ï¼Ÿ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¦‚æœæ¶‰åŠå…·ä½“äº§å“ä¿¡æ¯ï¼Œä½ éœ€è¦è¿›å…¥æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿçš„å¾ªç¯æ¨¡å¼ã€‚ ä½¿ç”¨Thoughtæ¥æè¿°ä½ çš„åˆ†æè¿‡ç¨‹ã€‚ ä½¿ç”¨Actionæ¥è¿è¡Œä¸€ä¸ªå¯ç”¨çš„å·¥å…·â€”â€”ç„¶åç­‰å¾…Observationã€‚ å½“ä½ å¾—å‡ºæœ€ç»ˆç­”æ¡ˆæ—¶ï¼Œè¾“å‡ºæ ¼å¼ä¸ºï¼šAnswer: [ä½ çš„å›ç­”]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å¯ç”¨å·¥å…·ï¼š</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">query_by_product_name: æŸ¥è¯¢æ•°æ®åº“ï¼Œæ£€ç´¢ä¸æŒ‡å®šäº§å“åç§°åŒ¹é…æˆ–åŒ…å«è¯¥åç§°çš„äº§å“åˆ—è¡¨ã€‚æ­¤åŠŸèƒ½å¯ç”¨äºå¸®åŠ©å®¢æˆ·é€šè¿‡åœ¨çº¿å¹³å°æˆ–å®¢æœç•Œé¢æŒ‰åç§°æŸ¥æ‰¾äº§å“ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">read_store_promotions: è¯»å–å•†åº—çš„ä¿ƒé”€æ–‡ä»¶ï¼ŒæŸ¥æ‰¾ä¸æä¾›çš„äº§å“åç§°ç›¸å…³çš„å…·ä½“ä¿ƒé”€ä¿¡æ¯ã€‚æ­¤åŠŸèƒ½ä¼šæ‰«ææ–‡æœ¬æ–‡ä»¶ï¼Œå¯»æ‰¾åŒ…å«äº§å“åç§°çš„ä¿ƒé”€æ¡ç›®ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">calculate: ç»“åˆäº§å“çš„å”®ä»·å’Œä¼˜æƒ ä¿¡æ¯ï¼Œè®¡ç®—æœ€ç»ˆäº¤æ˜“ä»·æ ¼ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½¿ç”¨Actionæ—¶ï¼Œå§‹ç»ˆæŒ‰ä»¥ä¸‹æ ¼å¼ï¼š Action: tool_name: argument1, argument2, ...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç¤ºä¾‹ï¼š Human: ä½ ä»¬åº—é‡Œæœ‰å–è¶³çƒå—ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œç°åœ¨æœ‰ä»€ä¹ˆä¼˜æƒ æ”¿ç­–ï¼Ÿæˆ‘ç°åœ¨ä¹°çš„è¯ï¼Œæœ€åå¤šå°‘é’±ï¼Ÿ Thought: è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘éœ€è¦å…ˆæŸ¥è¯¢åå°çš„æ•°æ®åº“ã€‚ Action: query_by_product_name: football</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Observation: ç›®å‰æˆ‘å·²æŸ¥åˆ°è¶³çƒæœ‰åº“å­˜ï¼Œä»·æ ¼ä¸º120å…ƒã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Thought: æˆ‘éœ€è¦è¿›ä¸€æ­¥æŸ¥è¯¢å…³äºè¶³çƒçš„ä¼˜æƒ æ”¿ç­– Action: read_store_promotions: football</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Observation: ç›®å‰è¶³çƒçš„ä¿ƒé”€æ”¿ç­–æ˜¯ï¼šè´­ä¹°äº«å—9æŠ˜ä¼˜æƒ </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Thought: ç°åœ¨æˆ‘éœ€è¦ç»“åˆè¶³çƒçš„å”®ä»·å’Œä¼˜æƒ æ”¿ç­–ï¼Œè®¡ç®—æœ€ç»ˆäº¤æ˜“ä»·æ ¼ Action: calculate: 120 * 0.9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Observation: è¶³çƒæœ€ç»ˆä»·æ ¼ä¸º108.0å…ƒ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Thought: æˆ‘å·²ç»è·å¾—äº†å›ç­”é—®é¢˜æ‰€éœ€çš„å…¨éƒ¨ä¿¡æ¯ã€‚ Answer: æ ¹æ®æ‚¨çš„å’¨è¯¢ï¼Œæˆ‘ä»¬åº—é‡Œç¡®å®æœ‰è¶³çƒå‡ºå”®ï¼Œå½“å‰å”®ä»·ä¸º120å…ƒã€‚ç›®å‰è´­ä¹°äº«å—9æŠ˜ä¼˜æƒ ï¼Œå› æ­¤å¦‚æœæ‚¨ç°åœ¨è´­ä¹°ï¼Œæœ€ç»ˆæˆäº¤ä»·æ ¼æ˜¯108å…ƒã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ³¨æ„ï¼šä½ å¿…é¡»ç”¨ä¸­æ–‡å›ç­”æœ€ç»ˆç»“æœ</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ç°åœ¨è½®åˆ°ä½ äº†ï¼š &quot;&quot;&quot;</span>.strip()</span><br></pre></td></tr></table></figure><h2 id="3-2-Agentå®šä¹‰"><a href="#3-2-Agentå®šä¹‰" class="headerlink" title="3.2 Agentå®šä¹‰"></a>3.2 Agentå®šä¹‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CustomerServiceAgent</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, client, config</span>):</span><br><span class="line">        <span class="variable language_">self</span>.client = client</span><br><span class="line">        <span class="variable language_">self</span>.config = config</span><br><span class="line">        <span class="variable language_">self</span>.messages = []</span><br><span class="line">        <span class="variable language_">self</span>.system_prompt = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        You are a Intelligent customer service assistant for e-commerce platform. It is necessary to answer the user&#x27;s consultation about the product in a timely manner. If it has nothing to do with the specific product, you can answer it directly.</span></span><br><span class="line"><span class="string">        output it as Answer: [Your answer here].</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">        Example :</span></span><br><span class="line"><span class="string">        Answer: Is there anything else I can help you with</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        If specific information about the product is involved, You run in a loop of Thought, Action, Observation.</span></span><br><span class="line"><span class="string">        Use Thought to describe your analysis process.</span></span><br><span class="line"><span class="string">        Use Action to run one of the available tools - then wait for an Observation.</span></span><br><span class="line"><span class="string">        When you have a final answer, output it as Answer: [Your answer here].</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Available tools:</span></span><br><span class="line"><span class="string">        1. query_by_product_name: Query the database to retrieve a list of products that match or contain the specified product name. This function can be used to assist customers in finding products by name via an online platform or customer support interface</span></span><br><span class="line"><span class="string">        2. read_store_promotions: Read the store&#x27;s promotion document to find specific promotions related to the provided product name. This function scans a text document for any promotional entries that include the product name.</span></span><br><span class="line"><span class="string">        3. calculate: Calculate the final transaction price by combining the selling price and preferential information of the product</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        When using an Action, always format it as:</span></span><br><span class="line"><span class="string">        Action: tool_name: argument1, argument2, ...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Example :</span></span><br><span class="line"><span class="string">        Human: Do you sell football in your shop? If you sell soccer balls, what are the preferential policies now? If I buy it now, how much will I get in the end?</span></span><br><span class="line"><span class="string">        Thought: To answer this question, I need to check the database of the background first.</span></span><br><span class="line"><span class="string">        Action: query_by_product_name: football</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Observation: At present, I have checked that the ball is in stock, and I know its price is 120 yuan.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Thought: I need to further inquire about the preferential policy of football</span></span><br><span class="line"><span class="string">        Action: read_store_promotions: football</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Observation: The current promotional policy for this ball is: 10% discount upon purchase</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Thought: Now I need to combine the selling price and preferential policies of the ball to calculate the final transaction price</span></span><br><span class="line"><span class="string">        Action: calculate: 120 * 0.9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Observation: The final price of the ball was 108.0 yuan</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Thought: I now have all the information needed to answer the question.</span></span><br><span class="line"><span class="string">        Answer:  According to your enquiry, we do sell soccer balls in our store, the current price is 120 yuan. At present, we offer a 10% discount on the purchase of football. Therefore, if you buy now, the final transaction price will be 108 yuan.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Note: You must reply to the final result in Chinese</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Now it&#x27;s your turn:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>.strip()</span><br><span class="line">        <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="variable language_">self</span>.system_prompt&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># __call__ æ–¹æ³•å¯ä»¥ä½¿å¾—ä¸€ä¸ªç±»çš„å®ä¾‹å¯ä»¥è¢«åƒå‡½æ•°é‚£æ ·è°ƒç”¨ï¼Œæä¾›äº†ç±»å®ä¾‹çš„â€œå¯è°ƒç”¨â€èƒ½åŠ›ã€‚</span></span><br><span class="line">    <span class="comment"># å½“ä½¿ç”¨ç±»å®ä¾‹åé¢è·Ÿç€æ‹¬å·å¹¶ä¼ é€’å‚æ•°æ—¶ï¼Œå°±ä¼šè§¦å‘ __call__ æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, message</span>):</span><br><span class="line">        <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: message&#125;)</span><br><span class="line">        response = <span class="variable language_">self</span>.execute()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(response, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">f&quot;Expected string response from execute, got <span class="subst">&#123;<span class="built_in">type</span>(response)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: response&#125;)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥ self.client æ˜¯å¦æ˜¯ OllamaClient ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚è¿™æ˜¯ç±»å‹å®‰å…¨çš„ä¸€ç§åšæ³•ï¼Œç¡®ä¿ self.client å…·æœ‰æ‰§è¡Œæ¥ä¸‹æ¥ä»£ç æ‰€éœ€çš„æ–¹æ³•å’Œå±æ€§ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(<span class="variable language_">self</span>.client, OllamaClient):</span><br><span class="line">            completion = <span class="variable language_">self</span>.client.chat_completions_create(</span><br><span class="line">                model=<span class="variable language_">self</span>.config[<span class="string">&quot;ollama&quot;</span>][<span class="string">&#x27;model_name&#x27;</span>],</span><br><span class="line">                messages=<span class="variable language_">self</span>.messages,</span><br><span class="line">                temperature=<span class="variable language_">self</span>.config[<span class="string">&quot;ollama&quot;</span>][<span class="string">&#x27;temperature&#x27;</span>]</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å¦‚æœ completion æ˜¯ä¸€ä¸ªå­—å…¸å¹¶ä¸”åŒ…å«ä¸€ä¸ªé”®ä¸º message çš„é¡¹ï¼Œåˆ™å°è¯•ä» message ä¸­æå– content é”®å¯¹åº”çš„å€¼ã€‚å¦‚æœæ²¡æœ‰ contentï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(completion, <span class="built_in">dict</span>) <span class="keyword">and</span> <span class="string">&#x27;message&#x27;</span> <span class="keyword">in</span> completion:</span><br><span class="line">                <span class="keyword">return</span> completion[<span class="string">&#x27;message&#x27;</span>].get(<span class="string">&#x27;content&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="comment"># å¦‚æœ completion ç›´æ¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥è¿”å›è¿™ä¸ªå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">isinstance</span>(completion, <span class="built_in">str</span>):</span><br><span class="line">                <span class="keyword">return</span> completion</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unexpected response structure from OllamaClient: <span class="subst">&#123;completion&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨ OpenAI çš„ GPT ç³»åˆ—æ¨¡å‹</span></span><br><span class="line">            completion = <span class="variable language_">self</span>.client.chat.completions.create(</span><br><span class="line">                model=<span class="variable language_">self</span>.config[<span class="string">&#x27;openai&#x27;</span>][<span class="string">&#x27;model_name&#x27;</span>],</span><br><span class="line">                messages=<span class="variable language_">self</span>.messages,</span><br><span class="line">            )</span><br><span class="line">            response = completion.choices[<span class="number">0</span>].message.content</span><br><span class="line">            <span class="keyword">if</span> response != <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> completion.choices[<span class="number">0</span>].message.content</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;å½“å‰æ²¡æœ‰æ­£å¸¸çš„ç”Ÿæˆå›å¤ï¼Œè¯·é‡æ–°æ€è€ƒå½“å‰çš„é—®é¢˜ï¼Œå¹¶å†æ¬¡è¿›è¡Œå°è¯•&quot;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-ä¸»ä»£ç è®¾è®¡"><a href="#3-3-ä¸»ä»£ç è®¾è®¡" class="headerlink" title="3.3 ä¸»ä»£ç è®¾è®¡"></a>3.3 ä¸»ä»£ç è®¾è®¡</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè·å–APIç›¸å…³é…ç½®</span></span><br><span class="line">    config = load_config()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è·å–æœåŠ¡ç«¯å®ä¾‹ï¼ˆæ”¯æŒ OpenAI API æˆ– Ollama Restful APIï¼‰</span></span><br><span class="line">        client = get_client(config)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ›å»ºå®¢æœä»£ç†å®ä¾‹</span></span><br><span class="line">        agent = CustomerServiceAgent(client, config)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="comment"># åˆå§‹åŒ–å¤±è´¥æ—¶çš„å¼‚å¸¸å¤„ç†</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error initializing the AI client: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Please check your configuration and ensure the AI service is running.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰å·¥å…·é›†ï¼Œæ¯ä¸ªå·¥å…·å¯¹åº”ä¸€ä¸ªå…·ä½“åŠŸèƒ½çš„å‡½æ•°</span></span><br><span class="line">    tools = &#123;</span><br><span class="line">        <span class="string">&quot;query_by_product_name&quot;</span>: query_by_product_name,  <span class="comment"># æŸ¥è¯¢å•†å“ä¿¡æ¯</span></span><br><span class="line">        <span class="string">&quot;read_store_promotions&quot;</span>: read_store_promotions,  <span class="comment"># æŸ¥è¯¢å•†åº—ä¿ƒé”€ä¿¡æ¯</span></span><br><span class="line">        <span class="string">&quot;calculate&quot;</span>: calculate,  <span class="comment"># è®¡ç®—æœ€ç»ˆä»·æ ¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸»å¾ªç¯ï¼šå…è®¸ç”¨æˆ·å¤šæ¬¡æé—®</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        query = <span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥æ‚¨çš„é—®é¢˜æˆ–è¾“å…¥ &#x27;é€€å‡º&#x27; æ¥ç»“æŸ: &quot;</span>)  <span class="comment"># è·å–ç”¨æˆ·è¾“å…¥</span></span><br><span class="line">        <span class="keyword">if</span> query.lower() == <span class="string">&#x27;é€€å‡º&#x27;</span>:  <span class="comment"># æ”¯æŒè¾“å…¥â€œé€€å‡ºâ€æ¥ç»“æŸç¨‹åº</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        iteration = <span class="number">0</span></span><br><span class="line">        max_iterations = get_max_iterations(config)  <span class="comment"># è·å–é…ç½®ä¸­å…è®¸çš„æœ€å¤§è¿­ä»£æ¬¡æ•°</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å†…éƒ¨å¾ªç¯å¤„ç†å•ä¸ªç”¨æˆ·é—®é¢˜ï¼Œæ”¯æŒå¤æ‚é—®é¢˜çš„å¤šè½®è§£æ</span></span><br><span class="line">        <span class="keyword">while</span> iteration &lt; max_iterations:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># é€šè¿‡Agentå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œç”Ÿæˆåˆæ­¥ç»“æœ</span></span><br><span class="line">                result = agent(query)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;result:<span class="subst">&#123;result&#125;</span>&quot;</span>)  <span class="comment"># æ‰“å°AIç”Ÿæˆçš„ç»“æœï¼Œæ–¹ä¾¿è°ƒè¯•</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># æ­£åˆ™è¡¨è¾¾å¼è¯†åˆ«â€œActionâ€æ“ä½œæŒ‡ä»¤</span></span><br><span class="line">                action_re = re.<span class="built_in">compile</span>(<span class="string">&#x27;^Action: (\w+): (.*)$&#x27;</span>)</span><br><span class="line">                actions = [action_re.<span class="keyword">match</span>(a) <span class="keyword">for</span> a <span class="keyword">in</span> result.split(<span class="string">&#x27;\n&#x27;</span>) <span class="keyword">if</span> action_re.<span class="keyword">match</span>(a)]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¦‚æœè¯†åˆ«åˆ°ActionæŒ‡ä»¤ï¼Œè§£æå·¥å…·åå’Œå‚æ•°</span></span><br><span class="line">                <span class="keyword">if</span> actions:</span><br><span class="line">                    action_parts = result.split(<span class="string">&quot;Action:&quot;</span>, <span class="number">1</span>)[<span class="number">1</span>].strip().split(<span class="string">&quot;: &quot;</span>, <span class="number">1</span>)</span><br><span class="line">                    tool_name = action_parts[<span class="number">0</span>]  <span class="comment"># æå–å·¥å…·åç§°</span></span><br><span class="line">                    tool_args = action_parts[<span class="number">1</span>] <span class="keyword">if</span> <span class="built_in">len</span>(action_parts) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">&quot;&quot;</span>  <span class="comment"># æå–å‚æ•°</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment"># å¦‚æœå·¥å…·åæœ‰æ•ˆï¼Œåˆ™è°ƒç”¨å¯¹åº”å·¥å…·</span></span><br><span class="line">                    <span class="keyword">if</span> tool_name <span class="keyword">in</span> tools:</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            <span class="comment"># æ‰§è¡Œå·¥å…·å‡½æ•°ï¼Œè·å–è§‚å¯Ÿç»“æœ</span></span><br><span class="line">                            observation = tools[tool_name](tool_args)</span><br><span class="line">                            query = <span class="string">f&quot;Observation: <span class="subst">&#123;observation&#125;</span>&quot;</span></span><br><span class="line">                            <span class="built_in">print</span>(query)  <span class="comment"># æ‰“å°è§‚å¯Ÿç»“æœ</span></span><br><span class="line">                        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                            <span class="comment"># å·¥å…·æ‰§è¡Œå¤±è´¥çš„å¼‚å¸¸å¤„ç†</span></span><br><span class="line">                            query = <span class="string">f&quot;Observation: Error occurred while executing the tool: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># å·¥å…·åæœªæ‰¾åˆ°çš„æƒ…å†µ</span></span><br><span class="line">                        query = <span class="string">f&quot;Observation: Tool &#x27;<span class="subst">&#123;tool_name&#125;</span>&#x27; not found&quot;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># å¦‚æœè¯†åˆ«åˆ°â€œAnswerâ€å­—æ®µï¼Œè¾“å‡ºæœ€ç»ˆç­”æ¡ˆå¹¶ç»“æŸå†…éƒ¨å¾ªç¯</span></span><br><span class="line">                <span class="keyword">elif</span> <span class="string">&quot;Answer:&quot;</span> <span class="keyword">in</span> result:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;å®¢æœå›å¤ï¼š<span class="subst">&#123;result.split(<span class="string">&#x27;Answer:&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].strip()&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># å¦‚æœæ²¡æœ‰è¯†åˆ«åˆ°æœ‰æ•ˆçš„Actionæˆ–Answerï¼Œè¿”å›æç¤º</span></span><br><span class="line">                    query = <span class="string">&quot;Observation: No valid action or answer found. Please provide a clear action or answer.&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="comment"># æ•è·ä¸»å¾ªç¯ä¸­çš„å¼‚å¸¸</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;An error occurred while processing the query: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Please check your configuration and ensure the AI service is running.&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># è¿­ä»£è®¡æ•°ï¼Œé˜²æ­¢æ— é™å¾ªç¯</span></span><br><span class="line">            iteration += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœè¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°ä»æœªç»™å‡ºç­”æ¡ˆï¼Œæç¤ºç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">if</span> iteration == max_iterations:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Reached maximum number of iterations without a final answer.&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6.Agentå®æˆ˜åŸºç¡€ä¹‹Agentæ¶æ„ä¸è½åœ°æ–¹æ¡ˆ</title>
      <link href="/2025/03/21/6.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BAgent%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%90%BD%E5%9C%B0%E6%96%B9%E6%A1%88/"/>
      <url>/2025/03/21/6.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BAgent%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%90%BD%E5%9C%B0%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¤§æ¨¡å‹äº§ä¸šè½åœ°è¶‹åŠ¿"><a href="#1-å¤§æ¨¡å‹äº§ä¸šè½åœ°è¶‹åŠ¿" class="headerlink" title="1. å¤§æ¨¡å‹äº§ä¸šè½åœ°è¶‹åŠ¿"></a>1. å¤§æ¨¡å‹äº§ä¸šè½åœ°è¶‹åŠ¿</h1><h2 id="1-1-ä¸šåŠ¡èåˆé˜¶æ®µ"><a href="#1-1-ä¸šåŠ¡èåˆé˜¶æ®µ" class="headerlink" title="1.1 ä¸šåŠ¡èåˆé˜¶æ®µ"></a>1.1 ä¸šåŠ¡èåˆé˜¶æ®µ</h2><p><strong>æŠ€æœ¯æ¶æ„</strong>ï¼šå„ç§åŠå…¬ç±»è½¯ä»¶<br><strong>æ¡ˆä¾‹</strong>ï¼š  </p><ol><li><strong>æ™ºèƒ½å®¢æœç³»ç»Ÿ</strong>ï¼šé›†æˆåˆ°ä¼ä¸šå®¢æœå¹³å°ï¼Œæä¾›è‡ªåŠ¨åŒ–é—®ç­”å’Œé—®é¢˜è§£å†³ã€‚  </li><li><strong>äººåŠ›èµ„æºç³»ç»Ÿ</strong>ï¼šç”¨äºå‘˜å·¥æ‹›è˜ã€åŸ¹è®­ã€ç»©æ•ˆç®¡ç†ç­‰åœºæ™¯ã€‚  </li><li><strong>å†…éƒ¨çŸ¥è¯†ç®¡ç†</strong>ï¼šå¸®åŠ©ä¼ä¸šæ•´ç†å’Œæ£€ç´¢å†…éƒ¨æ–‡æ¡£ã€æµç¨‹å’ŒçŸ¥è¯†åº“ã€‚</li></ol><p><strong>ç‰¹ç‚¹</strong>ï¼š<br>â€¢ å°†AIæŠ€æœ¯åµŒå…¥ç°æœ‰åŠå…¬è½¯ä»¶ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚<br>â€¢ ä¸»è¦ç”¨äºè¾…åŠ©ä¸šåŠ¡æµç¨‹ï¼Œè€Œéç‹¬ç«‹å†³ç­–ã€‚  </p><h2 id="1-2-è¾…åŠ©å†³ç­–é˜¶æ®µ"><a href="#1-2-è¾…åŠ©å†³ç­–é˜¶æ®µ" class="headerlink" title="1.2 è¾…åŠ©å†³ç­–é˜¶æ®µ"></a>1.2 è¾…åŠ©å†³ç­–é˜¶æ®µ</h2><p><strong>æŠ€æœ¯æ¶æ„</strong>ï¼šRAGï¼ˆRetrieval-Augmented Generationï¼‰æ¶æ„æ„å»ºçŸ¥è¯†åº“<br><strong>æ¡ˆä¾‹</strong>ï¼š  </p><ol><li><strong>åŒ»ç”ŸåŠ©æ‰‹ç³»ç»Ÿ</strong>ï¼šç»“åˆåŒ»å­¦çŸ¥è¯†åº“ï¼Œä¸ºåŒ»ç”Ÿæä¾›è¯Šæ–­å»ºè®®å’Œæ²»ç–—æ–¹æ¡ˆã€‚  </li><li><strong>æ³•å¾‹å’¨è¯¢æœåŠ¡</strong>ï¼šåŸºäºæ³•å¾‹æ¡æ–‡å’Œæ¡ˆä¾‹åº“ï¼Œæä¾›æ³•å¾‹å»ºè®®å’Œé£é™©è¯„ä¼°ã€‚  </li><li><strong>é‡‘èé£é™©ç®¡ç†</strong>ï¼šåˆ†æé‡‘èå¸‚åœºæ•°æ®ï¼Œæä¾›é£é™©é¢„è­¦å’ŒæŠ•èµ„å»ºè®®ã€‚  </li><li><strong>æ•™è‚²è¾…å¯¼</strong>ï¼šæ ¹æ®å­¦ç”Ÿéœ€æ±‚ï¼Œæä¾›ä¸ªæ€§åŒ–å­¦ä¹ è®¡åˆ’å’Œç­”ç–‘æœåŠ¡ã€‚  </li><li><strong>æ™ºèƒ½æ—…æ¸¸ç³»ç»Ÿ</strong>ï¼šç»“åˆæ—…æ¸¸æ•°æ®ï¼Œä¸ºç”¨æˆ·æ¨èè¡Œç¨‹å’Œæ™¯ç‚¹ã€‚</li></ol><p><strong>ç‰¹ç‚¹</strong>ï¼š<br>â€¢ é€šè¿‡çŸ¥è¯†åº“å¢å¼ºAIçš„å†³ç­–èƒ½åŠ›ï¼Œæä¾›æ›´ä¸“ä¸šçš„å»ºè®®ã€‚<br>â€¢ ä¸»è¦ç”¨äºè¾…åŠ©äººç±»å†³ç­–ï¼Œè€Œéå®Œå…¨è‡ªä¸»å†³ç­–ã€‚  </p><h2 id="1-3-è‡ªä¸»å†³ç­–é˜¶æ®µ"><a href="#1-3-è‡ªä¸»å†³ç­–é˜¶æ®µ" class="headerlink" title="1.3 è‡ªä¸»å†³ç­–é˜¶æ®µ"></a>1.3 è‡ªä¸»å†³ç­–é˜¶æ®µ</h2><p><strong>æŠ€æœ¯æ¶æ„</strong>ï¼šAgentï¼ˆæ™ºèƒ½ä»£ç†ï¼‰<br><strong>æ¡ˆä¾‹</strong>ï¼š<br>â€¢ <strong>è‡ªåŠ¨åŒ–ä»»åŠ¡æ‰§è¡Œ</strong>ï¼šå¦‚è‡ªåŠ¨è°ƒåº¦ã€èµ„æºåˆ†é…ã€æµç¨‹ä¼˜åŒ–ç­‰ã€‚<br>â€¢ <strong>æ™ºèƒ½æœºå™¨äºº</strong>ï¼šåœ¨æ— äººå¹²é¢„çš„æƒ…å†µä¸‹å®Œæˆå¤æ‚ä»»åŠ¡ï¼Œå¦‚ä»“å‚¨ç®¡ç†ã€è‡ªåŠ¨é©¾é©¶ç­‰ã€‚  </p><p><strong>ç‰¹ç‚¹</strong>ï¼š<br>â€¢ AIèƒ½å¤Ÿç‹¬ç«‹åˆ†æã€å†³ç­–å’Œæ‰§è¡Œä»»åŠ¡ï¼Œæ— éœ€äººç±»å¹²é¢„ã€‚<br>â€¢ é€‚ç”¨äºé«˜åº¦è‡ªåŠ¨åŒ–å’Œå¤æ‚å†³ç­–çš„åœºæ™¯ã€‚ </p><h1 id="2-AgentåŸç†å‰–æ"><a href="#2-AgentåŸç†å‰–æ" class="headerlink" title="2. AgentåŸç†å‰–æ"></a>2. AgentåŸç†å‰–æ</h1><h2 id="2-1-Agentè®¾è®¡ç†å¿µ"><a href="#2-1-Agentè®¾è®¡ç†å¿µ" class="headerlink" title="2.1 Agentè®¾è®¡ç†å¿µ"></a>2.1 Agentè®¾è®¡ç†å¿µ</h2><p><img src="/images/6.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BAgent%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%90%BD%E5%9C%B0%E6%96%B9%E6%A1%88/image-20250323003827083.png" alt="image-20250323003827083"></p><h2 id="2-2-Agentè®¾è®¡æ¨¡å¼"><a href="#2-2-Agentè®¾è®¡æ¨¡å¼" class="headerlink" title="2.2 Agentè®¾è®¡æ¨¡å¼"></a>2.2 Agentè®¾è®¡æ¨¡å¼</h2><h3 id="2-2-1-Reflectionï¼ˆåå°„æ¨¡å¼ï¼‰"><a href="#2-2-1-Reflectionï¼ˆåå°„æ¨¡å¼ï¼‰" class="headerlink" title="2.2.1 Reflectionï¼ˆåå°„æ¨¡å¼ï¼‰"></a>2.2.1 Reflectionï¼ˆåå°„æ¨¡å¼ï¼‰</h3><p><strong>å®šä¹‰</strong>ï¼šåå°„æ¨¡å¼å…è®¸AI Agentå®¡è§†è‡ªèº«ç”Ÿæˆçš„è¾“å‡ºï¼Œå¹¶è¿›è¡Œè‡ªæˆ‘ä¿®æ­£ã€‚è¿™ç§è‡ªæˆ‘ç›‘ç£çš„èƒ½åŠ›ä½¿å¾—AIèƒ½å¤Ÿåœ¨æ‰§è¡Œä»»åŠ¡æ—¶ä¸æ–­ä¼˜åŒ–ç­–ç•¥ï¼Œæé«˜å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šä¸€ä¸ªAI Agentå¯èƒ½ä¼šç”Ÿæˆä¸€æ®µä»£ç ï¼Œç„¶åè‡ªæˆ‘æ£€æŸ¥å¹¶ä¿®å¤æ½œåœ¨çš„é”™è¯¯ï¼Œä»è€Œæå‡ä»£ç è´¨é‡ã€‚</p><p><strong>å…³é”®ç‚¹</strong>ï¼š<br>â€¢ <strong>è‡ªæˆ‘ç›‘ç£</strong>ï¼šAIèƒ½å¤Ÿè‡ªæˆ‘æ£€æŸ¥å’Œä¿®æ­£ã€‚<br>â€¢ <strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼šé€šè¿‡åæ€ï¼ŒAIèƒ½å¤Ÿä¸æ–­æ”¹è¿›å…¶ç­–ç•¥ã€‚<br>â€¢ <strong>æé«˜æ•ˆç‡</strong>ï¼šé€šè¿‡å‡å°‘é”™è¯¯å’Œä¼˜åŒ–è¾“å‡ºï¼ŒAIèƒ½å¤Ÿæ›´é«˜æ•ˆåœ°å®Œæˆä»»åŠ¡ã€‚</p><h3 id="2-2-2-Tools-Useï¼ˆå·¥å…·ä½¿ç”¨æ¨¡å¼ï¼‰"><a href="#2-2-2-Tools-Useï¼ˆå·¥å…·ä½¿ç”¨æ¨¡å¼ï¼‰" class="headerlink" title="2.2.2 Tools Useï¼ˆå·¥å…·ä½¿ç”¨æ¨¡å¼ï¼‰"></a>2.2.2 Tools Useï¼ˆå·¥å…·ä½¿ç”¨æ¨¡å¼ï¼‰</h3><p><strong>å®šä¹‰</strong>ï¼šå·¥å…·ä½¿ç”¨æ¨¡å¼æ˜¯æŒ‡AI Agentèƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·å’ŒAPIæ¥å¢å¼ºè‡ªèº«çš„åŠŸèƒ½ã€‚è¿™ç§æ¨¡å¼ä½¿å¾—AIèƒ½å¤Ÿè¶…è¶Šè‡ªèº«çš„çŸ¥è¯†åº“ï¼Œé€šè¿‡ä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’æ¥è·å–ä¿¡æ¯ã€æ‰§è¡Œæ“ä½œæˆ–ç”Ÿæˆå†…å®¹ï¼Œæå¤§åœ°æ‰©å±•äº†AIçš„åº”ç”¨èŒƒå›´å’Œçµæ´»æ€§ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šAIå¯ä»¥é€šè¿‡è°ƒç”¨å¤©æ°”APIæ¥è·å–å®æ—¶å¤©æ°”ä¿¡æ¯ï¼Œæˆ–è€…é€šè¿‡è°ƒç”¨ç¿»è¯‘APIæ¥å®ç°å¤šè¯­è¨€ç¿»è¯‘ã€‚</p><p><strong>å…³é”®ç‚¹</strong>ï¼š<br>â€¢ <strong>å¤–éƒ¨å·¥å…·</strong>ï¼šAIèƒ½å¤Ÿä½¿ç”¨å¤–éƒ¨å·¥å…·å’ŒAPIã€‚<br>â€¢ <strong>å¢å¼ºåŠŸèƒ½</strong>ï¼šé€šè¿‡å·¥å…·ä½¿ç”¨ï¼ŒAIçš„åŠŸèƒ½å¾—åˆ°æ‰©å±•ã€‚<br>â€¢ <strong>çµæ´»æ€§</strong>ï¼šAIèƒ½å¤Ÿé€‚åº”å¤šç§ä»»åŠ¡å’Œåœºæ™¯ã€‚</p><h3 id="2-2-3-æ€ç»´é“¾æ–¹å¼ï¼ˆè§„åˆ’æ¨¡å¼ï¼‰"><a href="#2-2-3-æ€ç»´é“¾æ–¹å¼ï¼ˆè§„åˆ’æ¨¡å¼ï¼‰" class="headerlink" title="2.2.3 æ€ç»´é“¾æ–¹å¼ï¼ˆè§„åˆ’æ¨¡å¼ï¼‰"></a>2.2.3 æ€ç»´é“¾æ–¹å¼ï¼ˆè§„åˆ’æ¨¡å¼ï¼‰</h3><p><strong>å®šä¹‰</strong>ï¼šè§„åˆ’æ¨¡å¼èµ‹äºˆAI Agentå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤å¹¶æœ‰åºæ‰§è¡Œçš„èƒ½åŠ›ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒAIèƒ½å¤Ÿæ›´ç³»ç»Ÿåœ°å¤„ç†é—®é¢˜ï¼Œåˆ¶å®šå‡ºæœ‰æ•ˆçš„è¡ŒåŠ¨è®¡åˆ’ï¼Œå¹¶æŒ‰ç…§è®¡åˆ’é€æ­¥æ¨è¿›ä»»åŠ¡å®Œæˆã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šåœ¨å¸‚åœºåˆ†æä¸­ï¼ŒAIå¯ä»¥å°†ä»»åŠ¡åˆ†è§£ä¸ºæ•°æ®æ”¶é›†ã€æ•°æ®åˆ†æã€è¶‹åŠ¿é¢„æµ‹ç­‰æ­¥éª¤ï¼Œå¹¶é€æ­¥å®Œæˆã€‚</p><p><strong>å…³é”®ç‚¹</strong>ï¼š<br>â€¢ <strong>ä»»åŠ¡åˆ†è§£</strong>ï¼šAIèƒ½å¤Ÿå°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤ã€‚<br>â€¢ <strong>ç³»ç»Ÿå¤„ç†</strong>ï¼šAIèƒ½å¤Ÿæ›´ç³»ç»Ÿåœ°å¤„ç†é—®é¢˜ã€‚<br>â€¢ <strong>æœ‰æ•ˆè®¡åˆ’</strong>ï¼šAIèƒ½å¤Ÿåˆ¶å®šå¹¶æ‰§è¡Œæœ‰æ•ˆçš„è¡ŒåŠ¨è®¡åˆ’ã€‚</p><h3 id="2-2-4-å¤šAgentï¼ˆå¤šä»£ç†æ¨¡å¼ï¼‰"><a href="#2-2-4-å¤šAgentï¼ˆå¤šä»£ç†æ¨¡å¼ï¼‰" class="headerlink" title="2.2.4 å¤šAgentï¼ˆå¤šä»£ç†æ¨¡å¼ï¼‰"></a>2.2.4 å¤šAgentï¼ˆå¤šä»£ç†æ¨¡å¼ï¼‰</h3><p><strong>å®šä¹‰</strong>ï¼šå¤šAgentæ¨¡å¼æ¶‰åŠå¤šä¸ªAI Agentä¹‹é—´çš„åˆä½œã€‚é€šè¿‡è¿™ç§æ¨¡å¼ï¼Œä¸åŒçš„AI Agentå¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ï¼Œå…±åŒå®Œæˆä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡ã€‚è¿™ç§åä½œä¸ä»…èƒ½å¤Ÿæ¨¡æ‹ŸçœŸå®ä¸–ç•Œä¸­çš„å›¢é˜Ÿå·¥ä½œæµç¨‹ï¼Œè¿˜èƒ½å¤Ÿé€šè¿‡ä»£ç†é—´çš„äº’è¡¥å’ŒååŒä½œç”¨ï¼Œæé«˜æ•´ä½“çš„æ‰§è¡Œæ•ˆç‡å’Œåˆ›æ–°èƒ½åŠ›ã€‚</p><p><strong>ç¤ºä¾‹</strong>ï¼šåœ¨é¡¹ç›®ç®¡ç†ä¸­ï¼Œä¸åŒçš„AI Agentå¯ä»¥åˆ†åˆ«è´Ÿè´£ä»»åŠ¡åˆ†é…ã€è¿›åº¦è·Ÿè¸ªã€èµ„æºç®¡ç†ç­‰ï¼Œå…±åŒå®Œæˆé¡¹ç›®ã€‚</p><p><strong>å…³é”®ç‚¹</strong>ï¼š<br>â€¢ <strong>è§’è‰²åˆ†å·¥</strong>ï¼šä¸åŒçš„AI Agentæ‰®æ¼”ä¸åŒçš„è§’è‰²ã€‚<br>â€¢ <strong>å›¢é˜Ÿåä½œ</strong>ï¼šæ¨¡æ‹ŸçœŸå®ä¸–ç•Œä¸­çš„å›¢é˜Ÿå·¥ä½œæµç¨‹ã€‚<br>â€¢ <strong>ååŒä½œç”¨</strong>ï¼šé€šè¿‡ä»£ç†é—´çš„äº’è¡¥å’ŒååŒï¼Œæé«˜æ•ˆç‡å’Œåˆ›æ–°èƒ½åŠ›ã€‚</p><h1 id="3-Agentæ¶æ„è®¾è®¡è½åœ°æ–¹æ¡ˆ"><a href="#3-Agentæ¶æ„è®¾è®¡è½åœ°æ–¹æ¡ˆ" class="headerlink" title="3. Agentæ¶æ„è®¾è®¡è½åœ°æ–¹æ¡ˆ"></a>3. Agentæ¶æ„è®¾è®¡è½åœ°æ–¹æ¡ˆ</h1><table><thead><tr><th><strong>æ–¹æ¡ˆ</strong></th><th><strong>æŠ€æœ¯é€‰å‹</strong></th></tr></thead><tbody><tr><td><strong>æ–¹æ¡ˆ1</strong>ï¼šé€‚åˆå…¬å¸å†…éƒ¨å¿«é€Ÿå®ç°ä¸€äº›ç®€å•çš„éœ€æ±‚ï¼Œä½†ä¸å¼€æºã€‚</td><td>COZE (æ‰£å­)ï¼ŒDify ç­‰</td></tr><tr><td><strong>æ–¹æ¡ˆ2</strong>ï¼šé€‚åˆå…¬å¸å†…éƒ¨å¿«é€Ÿå®ç°ä¸€äº›éœ€æ±‚ï¼Œå¯åŸºäºå…¶è¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚</td><td>MetaGPT, AutoGen ç­‰</td></tr><tr><td><strong>æ–¹æ¡ˆ3</strong>ï¼šé€‚åˆä¸“èŒçš„åšå¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆã€‚</td><td>LangChain (Agents, LangGraph) ç­‰ï¼ŒSpring AI Alibabaï¼ŒSwarm</td></tr><tr><td><strong>æ–¹æ¡ˆ4</strong>ï¼šé€‚åˆä¸“èŒçš„åšå¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆã€‚</td><td>ä¸ç”¨</td></tr></tbody></table><h1 id="4-o1æ¨¡å‹çš„å‡ºç°å¯¹Agentå‘å±•çš„ä½œç”¨"><a href="#4-o1æ¨¡å‹çš„å‡ºç°å¯¹Agentå‘å±•çš„ä½œç”¨" class="headerlink" title="4. o1æ¨¡å‹çš„å‡ºç°å¯¹Agentå‘å±•çš„ä½œç”¨"></a>4. o1æ¨¡å‹çš„å‡ºç°å¯¹Agentå‘å±•çš„ä½œç”¨</h1><p><img src="/images/6.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BAgent%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%90%BD%E5%9C%B0%E6%96%B9%E6%A1%88/image-20250323005439172.png" alt="image-20250323005439172"></p><p><img src="/images/6.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8BAgent%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%90%BD%E5%9C%B0%E6%96%B9%E6%A1%88/image-20250323005451194.png" alt="image-20250323005451194"></p>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5.Agentå®æˆ˜åŸºç¡€ä¹‹å¤šæ¨¡æ€å¤§æ¨¡å‹å®æˆ˜</title>
      <link href="/2025/03/21/5.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%9A%E6%A8%A1%E6%80%81%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E6%88%98/"/>
      <url>/2025/03/21/5.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%9A%E6%A8%A1%E6%80%81%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>4.Agentå®æˆ˜åŸºç¡€ä¹‹æç¤ºè¯å·¥ç¨‹å’ŒFunctionè¿›é˜¶å®æˆ˜</title>
      <link href="/2025/03/17/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/"/>
      <url>/2025/03/17/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<h1 id="1-é¢å‘ç›®æ ‡æ¶æ„"><a href="#1-é¢å‘ç›®æ ‡æ¶æ„" class="headerlink" title="1. é¢å‘ç›®æ ‡æ¶æ„"></a>1. é¢å‘ç›®æ ‡æ¶æ„</h1><h2 id="1-1-é¢å‘ç›®æ ‡å¼€å‘æµç¨‹"><a href="#1-1-é¢å‘ç›®æ ‡å¼€å‘æµç¨‹" class="headerlink" title="1.1 é¢å‘ç›®æ ‡å¼€å‘æµç¨‹"></a>1.1 é¢å‘ç›®æ ‡å¼€å‘æµç¨‹</h2><p><img src="/images/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/image-20250318093723927.png" alt="image-20250318093723927"></p><p>å¤§æ¨¡å‹çš„æ ¸å¿ƒç›®æ ‡æ˜¯ è‡ªåŠ¨è§„åˆ’ã€è‡ªåŠ¨è°ƒç”¨å¤–éƒ¨å·¥å…·ã€è‡ªåŠ¨ç”Ÿæˆå¤–éƒ¨å‡½æ•°ï¼Œå®ç°æ™ºèƒ½åŒ–æ‰§è¡Œä»»åŠ¡ã€‚å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹é˜¶æ®µï¼š</p><ol><li>å¤§æ¨¡å‹è‡ªåŠ¨è§„åˆ’</li><li>å¤§æ¨¡å‹è‡ªåŠ¨è°ƒç”¨å¤–éƒ¨å·¥å…·æ‰§è¡Œ</li><li>å¤§æ¨¡å‹è‡ªåŠ¨ç”Ÿæˆå¤–éƒ¨å‡½æ•°</li></ol><h2 id="1-2-æŠ€æœ¯é€‰å‹"><a href="#1-2-æŠ€æœ¯é€‰å‹" class="headerlink" title="1.2 æŠ€æœ¯é€‰å‹"></a>1.2 æŠ€æœ¯é€‰å‹</h2><h3 id="1-2-1-æç¤ºè¯å·¥ç¨‹ä¸å¤–éƒ¨å‡½æ•°"><a href="#1-2-1-æç¤ºè¯å·¥ç¨‹ä¸å¤–éƒ¨å‡½æ•°" class="headerlink" title="1.2.1 æç¤ºè¯å·¥ç¨‹ä¸å¤–éƒ¨å‡½æ•°"></a>1.2.1 æç¤ºè¯å·¥ç¨‹ä¸å¤–éƒ¨å‡½æ•°</h3><ol><li><p>æç¤ºè¯å·¥ç¨‹</p><ul><li>è®¾è®¡æ¸…æ™°ã€é€»è¾‘ä¸¥è°¨çš„ Promptï¼Œå¼•å¯¼å¤§æ¨¡å‹æŒ‰ç›®æ ‡è¾“å‡ºã€‚</li></ul></li><li><p>Function Call</p><ul><li>è®©å¤§æ¨¡å‹åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œå®Œæˆå¤æ‚æ•°æ®å¤„ç†ã€æŸ¥è¯¢ã€è®¡ç®—ç­‰ä»»åŠ¡ã€‚</li></ul></li><li><p>GLM-4æ¨¡å‹</p><ul><li><p>ç‰¹ç‚¹ï¼šä¸­ä¸Šç­‰æ¨¡å‹ï¼Œæ€§èƒ½ä¼˜å¼‚ï¼Œä¸­æ–‡ç†è§£èƒ½åŠ›å¼ºã€‚</p></li><li><p>å®‰è£…æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install zhipuai</span><br></pre></td></tr></table></figure></li><li><p>æ¥å£è°ƒç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> zhipuai <span class="keyword">import</span> ZhipuAI</span><br><span class="line"></span><br><span class="line">client = ZhipuAI(api_key=<span class="string">&quot;your_api_key&quot;</span>)</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;glm-4&quot;</span>,</span><br><span class="line">    messages=[&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·å¸®æˆ‘åˆ†æè¿™ç»„æ•°æ®&quot;</span>&#125;]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>LangChainå¼€å‘æ¡†æ¶</p><ul><li><p>ç‰¹ç‚¹ï¼šæä¾›å¤šç§å¤§æ¨¡å‹åŠŸèƒ½å°è£…ï¼ŒåŒ…æ‹¬è®°å¿†ã€ä»£ç†ã€å·¥å…·è°ƒç”¨ã€RAGç­‰èƒ½åŠ›ã€‚</p></li><li><p>å®‰è£…æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install langchain</span><br></pre></td></tr></table></figure></li><li><p>ç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain.chat_models <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"></span><br><span class="line">llm = ChatOpenAI(temperature=<span class="number">0.7</span>)</span><br><span class="line">result = llm.predict(<span class="string">&quot;å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–æ•°æ®åˆ†æ?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="1-2-2-AGENT-è®¾è®¡"><a href="#1-2-2-AGENT-è®¾è®¡" class="headerlink" title="1.2.2 AGENT è®¾è®¡"></a>1.2.2 AGENT è®¾è®¡</h3><p>Agent æ˜¯è‡ªä¸»æ‰§è¡Œä»»åŠ¡çš„æ™ºèƒ½ä½“ï¼Œå…·å¤‡ä»¥ä¸‹èƒ½åŠ›ï¼š</p><ul><li>ç›®æ ‡è§„åˆ’ï¼šæ ¹æ®ç”¨æˆ·éœ€æ±‚æ‹†è§£ä»»åŠ¡ï¼Œè§„åˆ’æ‰§è¡Œè·¯å¾„ã€‚</li><li>ç¯å¢ƒæ„ŸçŸ¥ï¼šæ ¹æ®å¤–éƒ¨è¾“å…¥è°ƒæ•´è¡Œä¸ºã€‚</li><li>å·¥å…·è°ƒç”¨ï¼šåŠ¨æ€è°ƒç”¨å¤–éƒ¨å·¥å…·æˆ–å‡½æ•°ï¼Œå®Œæˆå­ä»»åŠ¡ã€‚</li><li>è‡ªä¸»å†³ç­–ï¼šæ ¹æ®ä¸Šä¸‹æ–‡å’Œæ‰§è¡Œç»“æœè°ƒæ•´è¡ŒåŠ¨ç­–ç•¥ã€‚</li></ul><h3 id="1-2-3-RAG-è®¾è®¡"><a href="#1-2-3-RAG-è®¾è®¡" class="headerlink" title="1.2.3 RAG è®¾è®¡"></a>1.2.3 RAG è®¾è®¡</h3><p>RAG (Retrieval-Augmented Generation)æ˜¯ä¸€ç§ç»“åˆæ£€ç´¢ä¸ç”Ÿæˆçš„æ–¹æ³•ï¼Œæå‡æ¨¡å‹å¯¹äº‹å®æ€§ã€çŸ¥è¯†æ€§çš„å›ç­”èƒ½åŠ›ã€‚</p><ul><li>æ£€ç´¢ (Retrieval)ï¼šä»å¤–éƒ¨æ•°æ®åº“ã€æ–‡æ¡£ã€APIç­‰æ¥æºæŸ¥æ‰¾ç›¸å…³ä¿¡æ¯ã€‚</li><li>ç”Ÿæˆ (Generation)ï¼šåœ¨æ£€ç´¢åˆ°çš„ä¿¡æ¯åŸºç¡€ä¸Šç”Ÿæˆé«˜è´¨é‡å›ç­”ã€‚</li></ul><h3 id="1-2-4-å¾®è°ƒ-Fine-tuning"><a href="#1-2-4-å¾®è°ƒ-Fine-tuning" class="headerlink" title="1.2.4 å¾®è°ƒ (Fine-tuning)"></a>1.2.4 å¾®è°ƒ (Fine-tuning)</h3><p>å¾®è°ƒæ˜¯é’ˆå¯¹ç‰¹å®šä»»åŠ¡ä¼˜åŒ–å¤§æ¨¡å‹ï¼Œè®©å®ƒåœ¨æŒ‡å®šåœºæ™¯è¡¨ç°æ›´ä¼˜ã€‚</p><ul><li>æ•°æ®å‡†å¤‡ï¼šæ”¶é›†é¢†åŸŸæ•°æ®ï¼Œæ ¼å¼åŒ–æˆè®­ç»ƒæ ·æœ¬ã€‚</li><li>è®­ç»ƒæ‰§è¡Œï¼šç”¨ç›®æ ‡ä»»åŠ¡æ•°æ®å¯¹æ¨¡å‹ç»§ç»­è®­ç»ƒã€‚</li><li>æ€§èƒ½è¯„ä¼°ï¼šæµ‹è¯•å¾®è°ƒåçš„æ¨¡å‹è¡¨ç°ï¼Œç¡®ä¿æå‡æ•ˆæœã€‚</li></ul><h3 id="1-2-5-é¢„è®­ç»ƒ-Pre-training"><a href="#1-2-5-é¢„è®­ç»ƒ-Pre-training" class="headerlink" title="1.2.5 é¢„è®­ç»ƒ (Pre-training)"></a>1.2.5 é¢„è®­ç»ƒ (Pre-training)</h3><p>é¢„è®­ç»ƒæ˜¯å¤§è§„æ¨¡æ•°æ®è®­ç»ƒé˜¶æ®µï¼Œè®©æ¨¡å‹å…·å¤‡åŸºç¡€è¯­è¨€ç†è§£ã€æ¨ç†ã€çŸ¥è¯†å­˜å‚¨èƒ½åŠ›ã€‚</p><ul><li>å¤§è§„æ¨¡æ–‡æœ¬è®­ç»ƒï¼ˆæ–°é—»ã€ç™¾ç§‘ã€è®ºæ–‡ã€å¯¹è¯æ•°æ®ç­‰ï¼‰</li><li>å¤šä»»åŠ¡è®­ç»ƒï¼ˆç¿»è¯‘ã€é—®ç­”ã€æ‘˜è¦ã€å¯¹è¯ã€ä»£ç ç†è§£ç­‰ï¼‰</li><li>è·¨æ¨¡æ€è®­ç»ƒï¼ˆå›¾æ–‡ç†è§£ã€å›¾ç”Ÿæ–‡ã€æ–‡ç”Ÿå›¾ç­‰ï¼‰</li></ul><h1 id="2-Function-Call-è¿›é˜¶"><a href="#2-Function-Call-è¿›é˜¶" class="headerlink" title="2. Function Call è¿›é˜¶"></a>2. Function Call è¿›é˜¶</h1><h2 id="2-1-å¤–éƒ¨å‡½æ•°è°ƒç”¨æµç¨‹å›é¡¾"><a href="#2-1-å¤–éƒ¨å‡½æ•°è°ƒç”¨æµç¨‹å›é¡¾" class="headerlink" title="2.1 å¤–éƒ¨å‡½æ•°è°ƒç”¨æµç¨‹å›é¡¾"></a>2.1 å¤–éƒ¨å‡½æ•°è°ƒç”¨æµç¨‹å›é¡¾</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> zhipuai <span class="keyword">import</span> ZhipuAI</span><br><span class="line"></span><br><span class="line">api_key = <span class="string">&quot;your_api_key&quot;</span></span><br><span class="line"></span><br><span class="line">client = ZhipuAI(api_key=api_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹å‡½æ•° - å­™æ‚Ÿç©ºç®—æ³•</span></span><br><span class="line"><span class="comment"># è¯¥å‡½æ•°ç”¨äºæ¥æ”¶ä¸€ä¸ªæ•°æ®è¡¨ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å¹¶è¿”å›JSONæ ¼å¼ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sunwukong_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å­™æ‚Ÿç©ºç®—æ³•å‡½æ•°ï¼Œè¯¥å‡½æ•°å®šä¹‰äº†æ•°æ®é›†è®¡ç®—è¿‡ç¨‹</span></span><br><span class="line"><span class="string">    :param data: å¿…è¦å‚æ•°ï¼Œè¡¨ç¤ºå¸¦å…¥è®¡ç®—çš„æ•°æ®è¡¨ï¼Œç”¨å­—ç¬¦ä¸²è¿›è¡Œè¡¨ç¤º</span></span><br><span class="line"><span class="string">    :return: sunwukong_functionå‡½æ•°è®¡ç®—åçš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºJSONæ ¼å¼çš„Dataframeç±»å‹å¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new[<span class="string">&#x27;x1&#x27;</span>] * <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line">df_str = pd.DataFrame(&#123;<span class="string">&#x27;x1&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">&#x27;x2&#x27;</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;).to_string</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„å¯¹è¯æµç¨‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_conversation</span>():</span><br><span class="line">    <span class="comment"># Step 1: åˆå§‹åŒ–å¯¹è¯ï¼Œå‘é€æ•°æ®é›†å’Œå‡½æ•°ä¿¡æ¯</span></span><br><span class="line">    messages = [</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æ•°æ®é›†dataï¼š%sï¼Œæ•°æ®é›†ä»¥å­—ç¬¦ä¸²å½¢å¼å‘ˆç°&quot;</span> % df_str&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·åœ¨æ•°æ®é›†dataä¸Šæ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰å·¥å…·ï¼ˆå‡½æ•°ï¼‰</span></span><br><span class="line">    tools = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">            <span class="string">&quot;function&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;sunwukong_function&quot;</span>,</span><br><span class="line">                <span class="string">&quot;description&quot;</span>: <span class="string">&quot;ç”¨äºæ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•å‡½æ•°ï¼Œå®šä¹‰äº†ä¸€ç§ç‰¹æ®Šçš„æ•°æ®é›†è®¡ç®—è¿‡ç¨‹&quot;</span>,</span><br><span class="line">                <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;data&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;æ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•çš„æ•°æ®é›†&quot;</span>&#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;data&quot;</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 2: å‘é€åˆæ¬¡è¯·æ±‚</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=<span class="string">&quot;glm-4&quot;</span>,</span><br><span class="line">        messages=messages,</span><br><span class="line">        tools=tools,</span><br><span class="line">        tool_choice=<span class="string">&quot;auto&quot;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–æ¨¡å‹è¿”å›çš„æ¶ˆæ¯</span></span><br><span class="line">    response_message = response.choices[<span class="number">0</span>].message</span><br><span class="line">    tool_calls = response_message.tool_calls</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 3: åˆ¤æ–­æ¨¡å‹æ˜¯å¦è¦è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> tool_calls:</span><br><span class="line">        available_functions = &#123;<span class="string">&quot;sunwukong_function&quot;</span>: sunwukong_function&#125;  <span class="comment"># è¿™é‡Œå¯ä»¥æ‰©å±•å¤šç§å‡½æ•°</span></span><br><span class="line">        messages.append(response_message.model_dump())  <span class="comment"># å°†æ¨¡å‹è¿”å›ç»“æœåŠ å…¥æ¶ˆæ¯åˆ—è¡¨</span></span><br><span class="line">        <span class="built_in">print</span>(messages)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Step 4: æ‰§è¡Œå‡½æ•°ï¼Œå¹¶å°†è¿”å›ç»“æœä¼ å›æ¨¡å‹</span></span><br><span class="line">        <span class="keyword">for</span> tool_call <span class="keyword">in</span> tool_calls:</span><br><span class="line">            function_name = tool_call.function.name</span><br><span class="line">            function_to_call = available_functions[function_name]</span><br><span class="line">            function_args = json.loads(tool_call.function.arguments)</span><br><span class="line">            function_response = function_to_call(**function_args)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°†å‡½æ•°ç»“æœä¼ å›å¯¹è¯ä¸Šä¸‹æ–‡</span></span><br><span class="line">            messages.append(&#123;</span><br><span class="line">                <span class="string">&quot;tool_call_id&quot;</span>: tool_call.<span class="built_in">id</span>,</span><br><span class="line">                <span class="string">&quot;role&quot;</span>: <span class="string">&quot;tool&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: function_name,</span><br><span class="line">                <span class="string">&quot;content&quot;</span>: function_response,</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Step 5: å‘é€æœ€ç»ˆè¯·æ±‚ï¼Œè·å–å®Œæ•´å›ç­”</span></span><br><span class="line">        second_response = client.chat.completions.create(</span><br><span class="line">            model=<span class="string">&quot;glm-4&quot;</span>,</span><br><span class="line">            messages=messages,</span><br><span class="line">            tools=tools,</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> second_response</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå¯¹è¯æµç¨‹å¹¶è¾“å‡ºæœ€ç»ˆç»“æœ</span></span><br><span class="line">result = run_conversation()</span><br><span class="line"><span class="built_in">print</span>(result.choices[<span class="number">0</span>].message.content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨StringIOå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ–‡ä»¶å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">df_str = <span class="string">&#x27;\n    x1\n0  10\n1  20\n.&#x27;</span></span><br><span class="line">data = io.StringIO(df_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨read_csv()å‡½æ•°è¯»å–æ•°æ®ï¼Œå¹¶è®¾ç½®ç¬¬ä¸€åˆ—ä¸ºç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(df_new)</span><br></pre></td></tr></table></figure><blockquote><p>OpenAI ä¸ZhipuAI çš„åŒºåˆ«</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>OpenAI ç‰ˆæœ¬</th><th>ZhipuAI ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>ç¬¬ä¸€è½®è¯·æ±‚</td><td>âœ… éœ€è¦ <code>tools</code></td><td>âœ… éœ€è¦ <code>tools</code></td></tr><tr><td>ç¬¬äºŒè½®è¯·æ±‚</td><td>âŒ ä¸å¸¦ <code>tools</code></td><td>âœ… ç»§ç»­å¸¦ <code>tools</code></td></tr><tr><td>æ¶ˆæ¯è¿½åŠ æ–¹å¼</td><td>ç›´æ¥è¿½åŠ </td><td><code>model_dump()</code> è½¬å­—å…¸</td></tr></tbody></table></blockquote><h2 id="2-2-å››å¤§æŒ‘æˆ˜"><a href="#2-2-å››å¤§æŒ‘æˆ˜" class="headerlink" title="2.2 å››å¤§æŒ‘æˆ˜"></a>2.2 å››å¤§æŒ‘æˆ˜</h2><h3 id="2-2-1-æ„å›¾è¯†åˆ«"><a href="#2-2-1-æ„å›¾è¯†åˆ«" class="headerlink" title="2.2.1 æ„å›¾è¯†åˆ«"></a>2.2.1 æ„å›¾è¯†åˆ«</h3><h4 id="2-2-1-1-è¯¯åˆ¤ï¼šæ˜¯å¦éœ€è¦å¤–éƒ¨å‡½æ•°"><a href="#2-2-1-1-è¯¯åˆ¤ï¼šæ˜¯å¦éœ€è¦å¤–éƒ¨å‡½æ•°" class="headerlink" title="2.2.1.1 è¯¯åˆ¤ï¼šæ˜¯å¦éœ€è¦å¤–éƒ¨å‡½æ•°"></a>2.2.1.1 è¯¯åˆ¤ï¼šæ˜¯å¦éœ€è¦å¤–éƒ¨å‡½æ•°</h4><p>ç­–ç•¥1ï¼šæä¾›é«˜è´¨é‡çš„ JSON Schema</p><ol><li>å…³é”®è¯å¼•å¯¼<br> å¤§æ¨¡å‹ï¼ˆå¦‚ GLM-4ï¼‰å¯èƒ½ä¾èµ– embedding ç›¸ä¼¼åº¦é€‰æ‹©å‡½æ•°ï¼Œå› æ­¤ï¼š<ul><li>åœ¨ prompt ä¸­åµŒå…¥ä¸å‡½æ•°åç§°é«˜åº¦ä¸€è‡´çš„å…³é”®è¯ï¼Œæé«˜å‘½ä¸­ç‡ã€‚</li><li>è®¾ç½®ç‹¬ç‰¹çš„å…³é”®è¯ï¼ˆç¼–å·ã€ä¸“æœ‰åè¯ç­‰ï¼‰ï¼Œé¿å…ä¸å…¶ä»–å‡½æ•°æ··æ·†ã€‚</li></ul></li><li>å‡½æ•°åˆ†ç±»æ ‡è®°<br> åœ¨å‡½æ•°åç§°æˆ–æè¿°ä¸­å¢åŠ åˆ†ç±»å‰ç¼€ï¼Œå¦‚ user_ã€admin_ã€data_ ç­‰ï¼Œå¸®åŠ©æ¨¡å‹å¿«é€Ÿå®šä½ç±»åˆ«ã€‚</li><li>æƒé‡æç¤º<br> å¯¹å¸¸ç”¨å‡½æ•°å¢åŠ æƒé‡æç¤ºè¯ï¼Œå¦‚ primaryã€coreã€é‡è¦ã€æ ¸å¿ƒä¸šåŠ¡ ç­‰ã€‚</li><li>å¦å®šå¥ç­›é€‰<br> åœ¨å‡½æ•°æè¿°ä¸­å¢åŠ å¦å®šæç¤ºï¼Œä¾‹å¦‚â€œå½“å‡ºç° XXX è¯­è¨€æ—¶ï¼Œæ­¤å‡½æ•°æ— æ•ˆâ€ï¼Œå¸®åŠ©æ¨¡å‹é¿å¼€ä¸åˆé€‚çš„å‡½æ•°ã€‚</li></ol><h4 id="2-2-1-2-è¯¯é€‰ï¼šç›¸ä¼¼å‡½æ•°åç§°æ··æ·†"><a href="#2-2-1-2-è¯¯é€‰ï¼šç›¸ä¼¼å‡½æ•°åç§°æ··æ·†" class="headerlink" title="2.2.1.2 è¯¯é€‰ï¼šç›¸ä¼¼å‡½æ•°åç§°æ··æ·†"></a>2.2.1.2 è¯¯é€‰ï¼šç›¸ä¼¼å‡½æ•°åç§°æ··æ·†</h4><p>ç­–ç•¥2ï¼šå¹²é¢„æ¨¡å‹é€‰æ‹©</p><ol><li>è‡ªæŸ¥ Prompt<br> åœ¨ç”¨æˆ·æé—®å‰ï¼Œå¢åŠ â€œXXX æ˜¯å¦åœ¨ä½ çš„èµ„æ–™åº“å†…â€çš„é¢„æ£€ promptï¼Œç¡®è®¤æ¨¡å‹æ˜¯å¦æŒæ¡è¯¥çŸ¥è¯†ã€‚</li><li>å…³é”®è¯åŒ¹é…ä¼˜å…ˆ<ul><li>å»ºç«‹ä¸šåŠ¡å…³é”®è¯åº“ï¼Œæ£€æµ‹åˆ°å…³é”®è¯æ—¶å¼ºåˆ¶æŒ‡å®š tool_choice è°ƒç”¨ç‰¹å®šå‡½æ•°ã€‚</li><li>ç¤ºä¾‹åœºæ™¯ï¼šç”¨æˆ·è¯´â€œæˆ‘è¦ç‚¹é¤â€ã€â€œæˆ‘è¦åƒé¥­â€ã€â€œæœåŠ¡å‘˜è¿‡æ¥ä¸€ä¸‹â€ï¼Œå‡æŒ‡å‘ ç‚¹é¤ å‡½æ•°ã€‚</li></ul></li></ol><h4 id="2-2-1-3-ç»“æœæ•´åˆå¤±è´¥ï¼ˆå³ä½¿è°ƒç”¨æˆåŠŸï¼Œç»“æœä»ç„¶æœ‰è¯¯ï¼‰"><a href="#2-2-1-3-ç»“æœæ•´åˆå¤±è´¥ï¼ˆå³ä½¿è°ƒç”¨æˆåŠŸï¼Œç»“æœä»ç„¶æœ‰è¯¯ï¼‰" class="headerlink" title="2.2.1.3 ç»“æœæ•´åˆå¤±è´¥ï¼ˆå³ä½¿è°ƒç”¨æˆåŠŸï¼Œç»“æœä»ç„¶æœ‰è¯¯ï¼‰"></a>2.2.1.3 ç»“æœæ•´åˆå¤±è´¥ï¼ˆå³ä½¿è°ƒç”¨æˆåŠŸï¼Œç»“æœä»ç„¶æœ‰è¯¯ï¼‰</h4><p>ç­–ç•¥3ï¼šä¼˜åŒ–æ¶ˆæ¯ä¼ é€’æ ¼å¼</p><ol><li><p>æ—§ç‰ˆæ–¹æ³•ç¼ºé™·<br> ä½¿ç”¨ tool è§’è‰²ä¼ é€’å‡½æ•°åä¸ç»“æœï¼Œä½†å®éªŒæ˜¾ç¤ºæ¨¡å‹æ— æ³•æœ‰æ•ˆè¯†åˆ«ä¸Šä¸‹æ–‡ã€‚</p></li><li><p>æ–°ç‰ˆä¼˜åŒ–æ–¹æ¡ˆ</p><ul><li><p>æ”¹ç”¨ assistant è§’è‰²ä¼ é€’å‡½æ•°ç»“æœï¼Œé…åˆé¢å¤–æç¤ºç¡®ä¿æ¨¡å‹ç†è§£è¿”å›ç»“æœçš„æ¥æºã€‚</p></li><li><p>ç¤ºä¾‹ä»£ç è°ƒæ•´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message.append(&#123;</span><br><span class="line">    <span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ ä½¿ç”¨äº† tools å·¥å…·ï¼Œæœ€ç»ˆè·å¾—çš„ç­”æ¡ˆæ˜¯&quot;</span> + <span class="built_in">str</span>(function_response),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li></ul></li><li><p>è°ƒç”¨æ ¡éªŒ</p><ul><li><p>å¢åŠ â€œæ˜¯å¦æˆåŠŸè°ƒç”¨äº†å‡½æ•°â€çš„æ£€æµ‹é€»è¾‘ï¼Œé˜²æ­¢æ¨¡å‹è¯¯åˆ¤ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    response_f.choices[<span class="number">0</span>].message.tool_calls[<span class="number">0</span>].function.name</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nè¢«è°ƒç”¨çš„å‡½æ•°æ˜¯&#123;&#125;&quot;</span>.<span class="built_in">format</span>(response_f.choices[<span class="number">0</span>].message.tool_calls[<span class="number">0</span>].function.name))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\næ²¡æœ‰å‡½æ•°è¢«æˆåŠŸè°ƒç”¨ï¼&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul></li></ol><h3 id="2-2-2-æµ·é‡å‡½æ•°"><a href="#2-2-2-æµ·é‡å‡½æ•°" class="headerlink" title="2.2.2 æµ·é‡å‡½æ•°"></a>2.2.2 æµ·é‡å‡½æ•°</h3><ol><li>Token é™åˆ¶é—®é¢˜</li><li>è®¡ç®—å»¶è¿Ÿé—®é¢˜</li><li>æ„å›¾è¯†åˆ«å›°éš¾</li></ol><h4 id="2-2-2-1-ä¼˜åŒ–ç­–ç•¥"><a href="#2-2-2-1-ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="2.2.2.1 ä¼˜åŒ–ç­–ç•¥"></a>2.2.2.1 ä¼˜åŒ–ç­–ç•¥</h4><ol><li><p>åˆ†å±‚æ¶æ„æŒ‡å¯¼å‡½æ•°åˆ†å‰²<br> åœ¨å¤æ‚åœºæ™¯ä¸‹æŒ‰å±‚æ¬¡åˆ’åˆ†å‡½æ•°åº“ï¼š</p><ul><li>è¡¨ç¤ºå±‚ï¼ˆç”¨æˆ·äº¤äº’é€»è¾‘ï¼‰ï¼šæ³¨å†Œã€ç™»å½•ã€æ›´æ–°ä¿¡æ¯ç­‰ã€‚</li><li>ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰ï¼šè®¢å•ç®¡ç†ã€å•†å“ç®¡ç†ç­‰ã€‚</li><li>æ•°æ®è®¿é—®å±‚ï¼ˆæ•°æ®åº“äº¤äº’ï¼‰ï¼šæ•°æ®å­˜å–ã€æŸ¥è¯¢ç­‰ã€‚</li><li>æœåŠ¡å±‚ï¼ˆå†…éƒ¨&#x2F;å¤–éƒ¨æ¥å£ï¼‰ï¼šAPI æœåŠ¡ã€ç¬¬ä¸‰æ–¹é›†æˆç­‰ã€‚</li></ul><p>å±‚çº§ç­›é€‰æµç¨‹ï¼šå…ˆé€šè¿‡é«˜å±‚æ¬¡æ„å›¾è¯†åˆ«é€‰æ‹©å±‚çº§ â†’ å†åœ¨å±‚å†…ç²¾ç»†ç­›é€‰å‡½æ•°ã€‚</p></li><li><p>å…³é”®è¯åˆ†å‰²<br> åœ¨ JSON Schema ä¸­å¼•å…¥å…³é”®è¯ï¼Œå¦‚â€œç« èŠ‚â€ã€â€œå¹´çº§â€ç­‰ï¼Œå…ˆç²—ç•¥åˆ’åˆ†å‡½æ•°é›†åˆã€‚</p></li><li><p>ç»“åˆå‘é‡æ•°æ®åº“ + RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯</p><ul><li>é¢„å¤„ç†ï¼šå°†å‡½æ•°æè¿°å‘é‡åŒ–ï¼Œå­˜å‚¨åˆ°å‘é‡æ•°æ®åº“ã€‚</li><li>ç”¨æˆ·æ„å›¾å‘é‡åŒ–ï¼šç”¨æˆ·è¾“å…¥ä¹Ÿè¿›è¡Œå‘é‡åŒ–ï¼Œè¿›è¡Œè¯­ä¹‰åŒ¹é…ã€‚</li><li>åŠ¨æ€åŠ è½½ç›¸å…³å‡½æ•°ï¼šä»æœç´¢ç»“æœä¸­åŠ¨æ€ç­›é€‰å¯èƒ½ç›¸å…³çš„å‡½æ•°ï¼Œå†è¿›ä¸€æ­¥è°ƒç”¨ã€‚</li></ul></li></ol><h3 id="2-2-3-å¹¶å‘è°ƒç”¨"><a href="#2-2-3-å¹¶å‘è°ƒç”¨" class="headerlink" title="2.2.3 å¹¶å‘è°ƒç”¨"></a>2.2.3 å¹¶å‘è°ƒç”¨</h3><h4 id="2-2-3-1-ä¸²è¡Œè°ƒç”¨"><a href="#2-2-3-1-ä¸²è¡Œè°ƒç”¨" class="headerlink" title="2.2.3.1 ä¸²è¡Œè°ƒç”¨"></a>2.2.3.1 ä¸²è¡Œè°ƒç”¨</h4><ul><li>æŒ‰ç…§ç‰¹å®šé¡ºåºæ‰§è¡Œå¤šä¸ªå‡½æ•°ï¼Œä¿æŒä¸Šä¸‹æ–‡è¿è´¯æ€§ã€‚</li></ul><h4 id="2-2-3-2-å¹¶è¡Œè°ƒç”¨"><a href="#2-2-3-2-å¹¶è¡Œè°ƒç”¨" class="headerlink" title="2.2.3.2 å¹¶è¡Œè°ƒç”¨"></a>2.2.3.2 å¹¶è¡Œè°ƒç”¨</h4><ul><li>æ”¯æŒåŒæ—¶è°ƒç”¨å¤šä¸ªå‡½æ•°ï¼Œæ±‡æ€»ç»“æœåç»Ÿä¸€è¿”å›ã€‚</li></ul><h3 id="2-2-4-å“åº”å¤ªæ…¢"><a href="#2-2-4-å“åº”å¤ªæ…¢" class="headerlink" title="2.2.4 å“åº”å¤ªæ…¢"></a>2.2.4 å“åº”å¤ªæ…¢</h3><h4 id="2-2-4-1-ç¼“å­˜è®¾è®¡"><a href="#2-2-4-1-ç¼“å­˜è®¾è®¡" class="headerlink" title="2.2.4.1 ç¼“å­˜è®¾è®¡"></a>2.2.4.1 ç¼“å­˜è®¾è®¡</h4><ul><li>é’ˆå¯¹ç‰¹å®šåœºæ™¯ï¼ˆå¦‚é«˜é¢‘æŸ¥è¯¢ã€é™æ€æ•°æ®ï¼‰è®¾è®¡ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘é‡å¤è°ƒç”¨ã€‚</li></ul><h4 id="2-2-4-2-åŠ¨æ€è°ƒæ•´è°ƒç”¨é€»è¾‘"><a href="#2-2-4-2-åŠ¨æ€è°ƒæ•´è°ƒç”¨é€»è¾‘" class="headerlink" title="2.2.4.2 åŠ¨æ€è°ƒæ•´è°ƒç”¨é€»è¾‘"></a>2.2.4.2 åŠ¨æ€è°ƒæ•´è°ƒç”¨é€»è¾‘</h4><ul><li>æŒ‰éœ€è°ƒæ•´ä¸²è¡Œ&#x2F;å¹¶è¡Œç­–ç•¥ï¼Œç¡®ä¿å…³é”®å‡½æ•°ä¼˜å…ˆæ‰§è¡Œã€‚</li></ul><h4 id="2-2-4-3-å»¶è¿Ÿåé¦ˆ"><a href="#2-2-4-3-å»¶è¿Ÿåé¦ˆ" class="headerlink" title="2.2.4.3 å»¶è¿Ÿåé¦ˆ"></a>2.2.4.3 å»¶è¿Ÿåé¦ˆ</h4><ul><li>å¯¹æ—¶é—´æ•æ„Ÿåœºæ™¯ï¼Œå…ˆè¿”å›éƒ¨åˆ†ç»“æœï¼Œå†è¡¥å……å®Œæ•´ä¿¡æ¯ã€‚</li></ul><h1 id="3-é¢å‘ç›®æ ‡æ¶æ„é˜¶æ®µ"><a href="#3-é¢å‘ç›®æ ‡æ¶æ„é˜¶æ®µ" class="headerlink" title="3. é¢å‘ç›®æ ‡æ¶æ„é˜¶æ®µ"></a>3. é¢å‘ç›®æ ‡æ¶æ„é˜¶æ®µ</h1><h2 id="3-1-ä»¥äººä¸ºä¸»ï¼ŒAIä¸ºè¾…"><a href="#3-1-ä»¥äººä¸ºä¸»ï¼ŒAIä¸ºè¾…" class="headerlink" title="3.1 ä»¥äººä¸ºä¸»ï¼ŒAIä¸ºè¾…"></a>3.1 ä»¥äººä¸ºä¸»ï¼ŒAIä¸ºè¾…</h2><p><img src="/images/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/image-20250319112047791.png" alt="image-20250319112047791"></p><ol><li><p>äººæ¢³ç†éœ€æ±‚</p></li><li><p>å¤§æ¨¡å‹å¸®å¿™å†™ä»£ç </p></li><li><p>äººå®¡æ ¸ä»£ç </p></li></ol><h3 id="3-1-1-æç¤ºè¯æ¡ˆä¾‹ï¼š"><a href="#3-1-1-æç¤ºè¯æ¡ˆä¾‹ï¼š" class="headerlink" title="3.1.1 æç¤ºè¯æ¡ˆä¾‹ï¼š"></a>3.1.1 æç¤ºè¯æ¡ˆä¾‹ï¼š</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/root/autodl-tmp/é¢å‘ç›®æ ‡æ¶æ„è½åœ°/data/my_mailæ•°æ®å­—å…¸.md&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    md_content = f.read()</span><br><span class="line">    </span><br><span class="line">user_example_content = <span class="string">&quot;è¯·å¸®æˆ‘ç¼–å†™ä¸€ä¸ªpythonå‡½æ•°ï¼Œç”¨äºæŸ¥çœ‹æˆ‘çš„mailboxé‚®ç®±ä¸­æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯ï¼Œå‡½æ•°è¦æ±‚å¦‚ä¸‹ï¼š\</span></span><br><span class="line"><span class="string">                        1.å‡½æ•°å‚æ•°userIdï¼ŒuserIdæ˜¯å­—ç¬¦ä¸²å‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å–å€¼ä¸º&#x27;me&#x27;ï¼Œè¡¨ç¤ºæŸ¥çœ‹æˆ‘çš„é‚®ä»¶ï¼›\</span></span><br><span class="line"><span class="string">                        2.å‡½æ•°è¿”å›ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯çš„å¯¹è±¡ï¼Œè¿”å›ç»“æœæœ¬èº«å¿…é¡»æ˜¯ä¸€ä¸ªjsonæ ¼å¼å¯¹è±¡ï¼›\</span></span><br><span class="line"><span class="string">                        3.è¯·å°†å…¨éƒ¨åŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼›\</span></span><br><span class="line"><span class="string">                        4.è¯·åœ¨å‡½æ•°ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œåœ¨å‡½æ•°å†…éƒ¨åŠ å…¥ä¸­æ–‡ç¼–å†™çš„è¯¦ç»†çš„å‡½æ•°è¯´æ˜æ–‡æ¡£ï¼Œç”¨äºè¯´æ˜å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;%s.py&#x27;</span> % <span class="string">&#x27;code/get_latest_email&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    assistant_example_content = f.read()</span><br><span class="line"></span><br><span class="line">user_content = <span class="string">&quot;è¯·å¸®æˆ‘ç¼–å†™ä¸€ä¸ªpythonå‡½æ•°ï¼Œç”¨äºæŸ¥çœ‹æˆ‘çš„mailboxé‚®ç®±ä¸­æ€»å…±æœ‰å¤šå°‘å°é‚®ä»¶ï¼Œå‡½æ•°è¦æ±‚å¦‚ä¸‹ï¼š\</span></span><br><span class="line"><span class="string">                1.å‡½æ•°å‚æ•°userIdï¼ŒuserIdæ˜¯å­—ç¬¦ä¸²å‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å–å€¼ä¸º&#x27;me&#x27;ï¼Œè¡¨ç¤ºæŸ¥çœ‹æˆ‘çš„é‚®ä»¶ï¼›\</span></span><br><span class="line"><span class="string">                2.å‡½æ•°è¿”å›ç»“æœæ˜¯å½“å‰é‚®ä»¶æ€»æ•°ï¼Œè¿”å›ç»“æœæœ¬èº«å¿…é¡»æ˜¯ä¸€ä¸ªjsonæ ¼å¼å¯¹è±¡ï¼›\</span></span><br><span class="line"><span class="string">                3.è¯·å°†å…¨éƒ¨åŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼›\</span></span><br><span class="line"><span class="string">                4.è¯·åœ¨å‡½æ•°ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œåœ¨å‡½æ•°å†…éƒ¨åŠ å…¥ä¸­æ–‡ç¼–å†™çš„è¯¦ç»†çš„å‡½æ•°è¯´æ˜æ–‡æ¡£ï¼Œç”¨äºè¯´æ˜å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›&quot;</span></span><br><span class="line"></span><br><span class="line">messages=[&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: md_content&#125;,</span><br><span class="line">          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example_user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_example_content&#125;,</span><br><span class="line">          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example_assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: assistant_example_content&#125;,</span><br><span class="line">          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example_user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_content&#125;]</span><br></pre></td></tr></table></figure><h2 id="3-2-Alå’Œäººç›¸äº’é…åˆ"><a href="#3-2-Alå’Œäººç›¸äº’é…åˆ" class="headerlink" title="3.2 Alå’Œäººç›¸äº’é…åˆ"></a>3.2 Alå’Œäººç›¸äº’é…åˆ</h2><p><img src="/images/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/image-20250319112109227.png" alt="image-20250319112109227"></p><ol><li><p>å¤§æ¨¡å‹æ¢³ç†éœ€æ±‚</p></li><li><p>å¤§æ¨¡å‹å¸®å¿™å†™ä»£ç </p></li><li><p>äººå®¡æ ¸ä»£ç </p></li></ol><h3 id="3-2-1-å€ŸåŠ©Few-Shot"><a href="#3-2-1-å€ŸåŠ©Few-Shot" class="headerlink" title="3.2.1 å€ŸåŠ©Few-Shot"></a>3.2.1 å€ŸåŠ©Few-Shot</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">get_email_input = <span class="string">&quot;è¯·å¸®æˆ‘æŸ¥ä¸‹é‚®ç®±é‡Œæœ€åä¸€å°é‚®ä»¶å†…å®¹ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">get_email_out = <span class="string">&quot;è¯·å¸®æˆ‘ç¼–å†™ä¸€ä¸ªpythonå‡½æ•°ï¼Œç”¨äºæŸ¥çœ‹æˆ‘çš„mailboxé‚®ç®±ä¸­æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯ï¼Œå‡½æ•°è¦æ±‚å¦‚ä¸‹ï¼š\</span></span><br><span class="line"><span class="string">                 1.å‡½æ•°å‚æ•°userIdï¼ŒuserIdæ˜¯å­—ç¬¦ä¸²å‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å–å€¼ä¸º&#x27;me&#x27;ï¼Œè¡¨ç¤ºæŸ¥çœ‹æˆ‘çš„é‚®ä»¶ï¼›\</span></span><br><span class="line"><span class="string">                 2.å‡½æ•°è¿”å›ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯çš„å¯¹è±¡ï¼Œè¿”å›ç»“æœæœ¬èº«å¿…é¡»æ˜¯ä¸€ä¸ªjsonæ ¼å¼å¯¹è±¡ï¼›\</span></span><br><span class="line"><span class="string">                 3.è¯·å°†å…¨éƒ¨åŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼›\</span></span><br><span class="line"><span class="string">                 4.è¯·åœ¨å‡½æ•°ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œåœ¨å‡½æ•°å†…éƒ¨åŠ å…¥ä¸­æ–‡ç¼–å†™çš„è¯¦ç»†çš„å‡½æ•°è¯´æ˜æ–‡æ¡£ï¼Œç”¨äºè¯´æ˜å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›&quot;</span></span><br><span class="line"></span><br><span class="line">email_counts_input = <span class="string">&quot;è¯·å¸®æˆ‘æŸ¥ä¸‹é‚®ç®±é‡Œç°åœ¨æ€»å…±æœ‰å¤šå°‘å°é‚®ä»¶ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">email_counts_out = <span class="string">&quot;è¯·å¸®æˆ‘ç¼–å†™ä¸€ä¸ªpythonå‡½æ•°ï¼Œç”¨äºæŸ¥çœ‹æˆ‘çš„mailboxé‚®ç®±ä¸­æ€»å…±æœ‰å¤šå°‘å°é‚®ä»¶ï¼Œå‡½æ•°è¦æ±‚å¦‚ä¸‹ï¼š\</span></span><br><span class="line"><span class="string">                    1.å‡½æ•°å‚æ•°userIdï¼ŒuserIdæ˜¯å­—ç¬¦ä¸²å‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å–å€¼ä¸º&#x27;me&#x27;ï¼Œè¡¨ç¤ºæŸ¥çœ‹æˆ‘çš„é‚®ä»¶ï¼›\</span></span><br><span class="line"><span class="string">                    2.å‡½æ•°è¿”å›ç»“æœæ˜¯å½“å‰é‚®ä»¶æ€»æ•°ï¼Œè¿”å›ç»“æœæœ¬èº«å¿…é¡»æ˜¯ä¸€ä¸ªjsonæ ¼å¼å¯¹è±¡ï¼›\</span></span><br><span class="line"><span class="string">                    3.è¯·å°†å…¨éƒ¨åŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼›\</span></span><br><span class="line"><span class="string">                    4.è¯·åœ¨å‡½æ•°ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œåœ¨å‡½æ•°å†…éƒ¨åŠ å…¥ä¸­æ–‡ç¼–å†™çš„è¯¦ç»†çš„å‡½æ•°è¯´æ˜æ–‡æ¡£ï¼Œç”¨äºè¯´æ˜å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›&quot;</span></span><br><span class="line"></span><br><span class="line">user_content = <span class="string">&quot;è¯·æŸ¥ä¸‹æˆ‘çš„é‚®ç®±é‡Œæ˜¯å¦æœ‰æ¥é™†å°å‡¤çš„æœªè¯»é‚®ä»¶ï¼Œå¹¶è§£è¯»æœ€è¿‘ä¸€å°æœªè¯»é‚®ä»¶çš„å†…å®¹&quot;</span></span><br><span class="line"><span class="comment"># &#123;&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: md_content&#125;,</span></span><br><span class="line"><span class="comment"># one-shot  few-shot</span></span><br><span class="line"></span><br><span class="line">messages_fewShot_stage1 = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;æœ€åè¾“å‡ºçš„æ˜¯ä¸€ä¸ªè¯´æ˜ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š<span class="subst">&#123;email_counts_out&#125;</span>&quot;</span>&#125;,</span><br><span class="line">                           &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·æ¨¡ä»¿ä¸‹åˆ—å¯¹è¯ç»™å‡ºçš„é£æ ¼ï¼ŒåŸºäºæˆ‘çš„é—®é¢˜ï¼ŒæŠŠæˆ‘çš„é—®é¢˜è½¬æ¢æˆä¸€ä¸ªè¯´æ˜ã€‚æ³¨æ„ï¼šä¸éœ€è¦æœ‰é¢å¤–è¾“å‡º&quot;</span>&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example1_user&quot;</span>, <span class="string">&quot;content&quot;</span>: get_email_input&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example1_assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: get_email_out&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example2_user&quot;</span>, <span class="string">&quot;content&quot;</span>: email_counts_input&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example2_assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: email_counts_out&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example_user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_content&#125;]</span><br></pre></td></tr></table></figure><h3 id="3-2-2-å€ŸåŠ©LtM"><a href="#3-2-2-å€ŸåŠ©LtM" class="headerlink" title="3.2.2 å€ŸåŠ©LtM"></a>3.2.2 å€ŸåŠ©LtM</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">system_content1 = <span class="string">&quot;ä¸ºäº†æ›´å¥½ç¼–å†™æ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„pythonå‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè¯†åˆ«ç”¨æˆ·éœ€æ±‚ä¸­çš„å˜é‡ï¼Œä»¥ä½œä¸ºpythonå‡½æ•°çš„å‚æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“å‰ç¼–å†™çš„å‡½æ•°ä¸­æ¶‰åŠåˆ°çš„é‚®ä»¶æ”¶å‘æŸ¥é˜…ç­‰åŠŸèƒ½ï¼Œéƒ½æ˜¯é€šè¿‡Pythonæ¥å®Œæˆã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">input1 = <span class="string">&quot;è¯·å¸®æˆ‘æŸ¥ä¸‹mailboxé‚®ç®±é‡Œæœ€åä¸€å°é‚®ä»¶å†…å®¹ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">pi1 = <span class="string">&quot;å½“å‰éœ€æ±‚ä¸­å¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°çš„æ˜¯ï¼š1.æŸ¥çœ‹è°çš„é‚®ç®±ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">input2 = <span class="string">&quot;è¯·å¸®æˆ‘ç»™è¥¿é—¨å¹é›ªå‘é€ä¸€å°é‚®ä»¶ï¼Œè¯·ä»–æ˜å¤©æ—©ä¸Š9ç‚¹åŠæ¥æˆ‘åŠå…¬å®¤å¼€ä¼šï¼Œå•†é‡ä¸‹åŠå¹´æŠ€æœ¯å¼€å‘è®¡åˆ’ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">pi2 = <span class="string">&quot;å½“å‰éœ€æ±‚ä¸­å¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°çš„æ˜¯ï¼š1.å‘é€é‚®ä»¶çš„å¯¹è±¡ï¼›2.å‘é€é‚®ä»¶çš„ä¸»é¢˜ï¼›3.é‚®ä»¶å…·ä½“å†…å®¹&quot;</span></span><br><span class="line"></span><br><span class="line">input3 = <span class="string">&quot;è¯·æŸ¥ä¸‹æˆ‘çš„é‚®ç®±é‡Œæ˜¯å¦æœ‰æ¥è‡ªé™†å°å‡¤çš„æœªè¯»é‚®ä»¶ï¼Œå¹¶è§£è¯»æœ€è¿‘ä¸€å°æœªè¯»é‚®ä»¶çš„å†…å®¹ã€‚&quot;</span></span><br><span class="line"></span><br><span class="line">messages_CD = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: system_content1&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example1_user&quot;</span>, <span class="string">&quot;content&quot;</span>: input1&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example1_assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: pi1&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example2_user&quot;</span>, <span class="string">&quot;content&quot;</span>: input2&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example2_assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: pi2&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;example_user&quot;</span>, <span class="string">&quot;content&quot;</span>: input3&#125;]</span><br></pre></td></tr></table></figure><blockquote><p>â€‹å¦‚æœåœ¨Few-shotçš„æç¤ºä¸‹ï¼Œç¬¬ä¸€é˜¶æ®µçš„æŒ‡ä»¤ç¿»è¯‘ä¸æ˜¯æ¯ä¸€æ¬¡éƒ½èƒ½ç»™å‡ºä»¤äººæ»¡æ„çš„ç»“æœï¼Œé¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„è§£å†³é—®é¢˜çš„åŠæ³•å°±æ˜¯æä¾›ä¸€äº›æ›´åŠ å¼ºæœ‰åŠ›çš„æç¤ºæ–¹æ³•ï¼šä¾‹å¦‚LtMæç¤ºæ³•ã€‚</p><p>â€‹æ ¹æ®LtMå¤šæ®µæç¤ºçš„ç­–ç•¥ï¼Œå¤–åŠ ç»“åˆå½“å‰æŒ‡ä»¤ç¿»è¯‘ä»»åŠ¡è€ƒè™‘ï¼Œä¸€ç§æ›´æœ‰å¸Œæœ›èƒ½å¤Ÿå¼•å¯¼æ¨¡å‹èƒ½å¤Ÿé¡ºåˆ©å®ŒæˆæŒ‡ä»¤ç¿»è¯‘æµç¨‹çš„æç¤ºæ–¹æ³•æ˜¯ï¼šå…ˆå¼•å¯¼æ¨¡å‹æ‹†è§£å½“å‰éœ€æ±‚ä¸­çš„â€œå˜é‡â€ä½œä¸ºåç»­å‡½æ•°çš„å‚æ•°ï¼Œç„¶åå†åŸºäºå·²ç»ç¡®å®šçš„å˜é‡ï¼Œå¼•å¯¼æ¨¡å‹å®Œæˆç¿»è¯‘å·¥ä½œã€‚ </p><p>â€‹å…¶å®å°±æ•´ä¸ªæŒ‡ä»¤ç¿»è¯‘ä»»åŠ¡æ¥è¯´ï¼Œæœ€éš¾çš„åœ°æ–¹ä¹Ÿå°±åœ¨äºå‡½æ•°å‚æ•°çš„ç†è§£è¿‡ç¨‹ï¼Œè€Œä¸€æ—¦æ¨¡å‹èƒ½å¤Ÿå‡†ç¡®çš„ç¿»è¯‘å‡ºå¤–éƒ¨å‡½æ•°éœ€è¦å“ªäº›å‚æ•°ï¼Œå…¶ä»–éƒ¨åˆ†çš„ç¿»è¯‘ä»»åŠ¡è‡ªç„¶è¿åˆƒè€Œè§£ã€‚</p></blockquote><h3 id="3-2-3å…¨è‡ªåŠ¨åŠŸèƒ½å‡½æ•°ç¼–ç¨‹"><a href="#3-2-3å…¨è‡ªåŠ¨åŠŸèƒ½å‡½æ•°ç¼–ç¨‹" class="headerlink" title="3.2.3å…¨è‡ªåŠ¨åŠŸèƒ½å‡½æ•°ç¼–ç¨‹"></a>3.2.3å…¨è‡ªåŠ¨åŠŸèƒ½å‡½æ•°ç¼–ç¨‹</h3><h4 id="3-2-3-1-æç¤ºè¯ç®¡ç†"><a href="#3-2-3-1-æç¤ºè¯ç®¡ç†" class="headerlink" title="3.2.3.1 æç¤ºè¯ç®¡ç†"></a>3.2.3.1 æç¤ºè¯ç®¡ç†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€é˜¶æ®µLtM_CDé˜¶æ®µæç¤ºè¯åŠè¾“å‡ºç»“æœ</span></span><br><span class="line">get_latest_email_CD_input = <span class="string">&quot;è¯·å¸®æˆ‘æŸ¥ä¸‹mailboxé‚®ç®±é‡Œæœ€æ–°ä¸€å°é‚®ä»¶å†…å®¹ã€‚&quot;</span></span><br><span class="line">get_latest_email_pi = <span class="string">&quot;å½“å‰éœ€æ±‚ä¸­å¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°çš„æ˜¯ï¼š1.æŸ¥çœ‹è°çš„é‚®ç®±ã€‚&quot;</span></span><br><span class="line">get_latest_email_messages_CD = [</span><br><span class="line">                                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: get_latest_email_CD_input&#125;,</span><br><span class="line">                                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: get_latest_email_pi&#125;</span><br><span class="line">                                ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸€é˜¶æ®µLtM_CMé˜¶æ®µæç¤ºè¯åŠè¾“å‡ºç»“æœ</span></span><br><span class="line">get_latest_email_CM_input = get_latest_email_CD_input + get_latest_email_pi</span><br><span class="line">get_latest_email_description = <span class="string">&quot;è¯·å¸®æˆ‘ç¼–å†™ä¸€ä¸ªpythonå‡½æ•°ï¼Œç”¨äºæŸ¥çœ‹æˆ‘çš„mailboxé‚®ç®±ä¸­æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯ï¼Œå‡½æ•°è¦æ±‚å¦‚ä¸‹ï¼š\</span></span><br><span class="line"><span class="string">                 1.å‡½æ•°å‚æ•°userIdï¼ŒuserIdæ˜¯å­—ç¬¦ä¸²å‚æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å–å€¼ä¸º&#x27;me&#x27;ï¼Œè¡¨ç¤ºæŸ¥çœ‹æˆ‘çš„é‚®ä»¶ï¼›\</span></span><br><span class="line"><span class="string">                 2.å‡½æ•°è¿”å›ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æœ€åä¸€å°é‚®ä»¶ä¿¡æ¯çš„å¯¹è±¡ï¼Œè¿”å›ç»“æœæœ¬èº«å¿…é¡»æ˜¯ä¸€ä¸ªjsonæ ¼å¼å¯¹è±¡ï¼›\</span></span><br><span class="line"><span class="string">                 3.è¯·å°†å…¨éƒ¨åŠŸèƒ½å°è£…åœ¨ä¸€ä¸ªå‡½æ•°å†…ï¼›\</span></span><br><span class="line"><span class="string">                 4.è¯·åœ¨å‡½æ•°ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œåœ¨å‡½æ•°å†…éƒ¨åŠ å…¥ä¸­æ–‡ç¼–å†™çš„è¯¦ç»†çš„å‡½æ•°è¯´æ˜æ–‡æ¡£ï¼Œç”¨äºè¯´æ˜å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›&quot;</span></span><br><span class="line">get_latest_email_messages_CM = [</span><br><span class="line">                                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: get_latest_email_CM_input&#125;,</span><br><span class="line">                                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>:get_latest_email_description&#125;</span><br><span class="line">                                ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒé˜¶æ®µæç¤ºè¯åŠè¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_module.py&#x27;</span> % (<span class="string">&#x27;get_latest_email&#x27;</span>, <span class="string">&#x27;get_latest_email&#x27;</span>), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    get_latest_email_function = f.read()</span><br><span class="line">get_latest_email_messages = [</span><br><span class="line">                             &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: get_latest_email_description&#125;,</span><br><span class="line">                             &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>:get_latest_email_function&#125;</span><br><span class="line">                             ]  </span><br><span class="line"></span><br><span class="line">get_latest_email_prompt = &#123;</span><br><span class="line">                            <span class="string">&quot;stage1_CD&quot;</span>: get_latest_email_messages_CD,</span><br><span class="line">                            <span class="string">&quot;stage1_CM&quot;</span>: get_latest_email_messages_CM,</span><br><span class="line">                            <span class="string">&quot;stage2&quot;</span>: get_latest_email_messages</span><br><span class="line">                          &#125;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_prompt.json&#x27;</span> % (<span class="string">&#x27;get_latest_email&#x27;</span>,<span class="string">&#x27;get_latest_email&#x27;</span>), <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(get_latest_email_prompt, f)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æˆ‘ä»¬å½“å‰æç¤ºæµç¨‹ä¸­å„é˜¶æ®µçš„ç³»ç»Ÿæç¤ºæ¶ˆæ¯ï¼Œä¹Ÿéœ€è¦å¯¹å…¶è¿›è¡Œæ•´ç†å’Œæœ¬åœ°ä¿å­˜ï¼š</span></span><br><span class="line"></span><br><span class="line">system_messages = &#123;<span class="string">&quot;system_message_CD&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: md_content&#125;], </span><br><span class="line">                   <span class="string">&quot;system_message_CM&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>:md_content &#125;], </span><br><span class="line">                   <span class="string">&quot;system_message&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>:md_content&#125;]&#125;</span><br><span class="line">               </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s.json&#x27;</span> % <span class="string">&#x27;system_messages&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(system_messages, f)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰æç¤ºè¯ç®¡ç†çš„è¾…åŠ©å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_to_tested</span>(<span class="params">function_name</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å°†å‡½æ•°åŒåæ–‡ä»¶å¤¹ç”±untestedæ–‡ä»¶å¤¹è½¬ç§»è‡³testedæ–‡ä»¶å¤¹å†…ã€‚\</span></span><br><span class="line"><span class="string">    å®Œæˆè½¬ç§»åˆ™è¯´æ˜å‡½æ•°é€šè¿‡æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨ã€‚</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å‡½æ•°ä»£ç å†™å…¥glmLesson.pyæ–‡ä»¶ä¸­</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        function_code = f.read()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æºæ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">    src_dir = <span class="string">&#x27;./functions/untested functions/%s&#x27;</span> % function_name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç›®æ ‡æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">    dst_dir = <span class="string">&#x27;./functions/tested functions/%s&#x27;</span> % function_name</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç§»åŠ¨æ–‡ä»¶å¤¹</span></span><br><span class="line">    shutil.move(src_dir, dst_dir)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_function_code</span>(<span class="params">s, detail=<span class="number">0</span>, tested=<span class="literal">False</span>, g=<span class="built_in">globals</span>(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å‡½æ•°æå–å‡½æ•°ï¼ŒåŒæ—¶æ‰§è¡Œå‡½æ•°å†…å®¹ï¼Œå¯ä»¥é€‰æ‹©æ‰“å°å‡½æ•°ä¿¡æ¯ï¼Œå¹¶é€‰æ‹©ä»£ç ä¿å­˜çš„åœ°å€</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_code</span>(<span class="params">s</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸²sæ˜¯ä¸€ä¸ªåŒ…å«Pythonä»£ç çš„Markdownæ ¼å¼å­—ç¬¦ä¸²ï¼Œæå–å‡ºä»£ç éƒ¨åˆ†ã€‚</span></span><br><span class="line"><span class="string">        å¦åˆ™ï¼Œè¿”å›åŸå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        å‚æ•°:</span></span><br><span class="line"><span class="string">        s: è¾“å…¥çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        è¿”å›:</span></span><br><span class="line"><span class="string">        æå–å‡ºçš„ä»£ç éƒ¨åˆ†ï¼Œæˆ–åŸå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ˜¯Markdownæ ¼å¼</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;```python&#x27;</span> <span class="keyword">in</span> s <span class="keyword">or</span> <span class="string">&#x27;Python&#x27;</span> <span class="keyword">in</span> s <span class="keyword">or</span><span class="string">&#x27;PYTHON&#x27;</span> <span class="keyword">in</span> s:</span><br><span class="line">            <span class="comment"># æ‰¾åˆ°ä»£ç å—çš„å¼€å§‹å’Œç»“æŸä½ç½®</span></span><br><span class="line">            code_start = s.find(<span class="string">&#x27;def&#x27;</span>)</span><br><span class="line">            code_end = s.find(<span class="string">&#x27;```\n&#x27;</span>, code_start)</span><br><span class="line">            <span class="comment"># æå–ä»£ç éƒ¨åˆ†</span></span><br><span class="line">            code = s[code_start:code_end]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœå­—ç¬¦ä¸²ä¸æ˜¯Markdownæ ¼å¼ï¼Œè¿”å›åŸå­—ç¬¦ä¸²</span></span><br><span class="line">            code = s</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> code</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–ä»£ç å­—ç¬¦ä¸²</span></span><br><span class="line">    code = extract_code(s)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–å‡½æ•°åç§°</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r&#x27;def (\w+)&#x27;</span>, code)</span><br><span class="line">    function_name = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨untestedæ–‡ä»¶å¤¹å†…åˆ›å»ºå‡½æ•°åŒåæ–‡ä»¶å¤¹</span></span><br><span class="line">    directory = <span class="string">&#x27;./functions/untested functions/%s&#x27;</span> % function_name</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        os.makedirs(directory)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å‡½æ•°å†™å…¥æœ¬åœ°</span></span><br><span class="line">    <span class="keyword">if</span> tested == <span class="literal">False</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(code)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># è°ƒç”¨remove_to_testå‡½æ•°å°†å‡½æ•°æ–‡ä»¶å¤¹è½¬ç§»è‡³testedæ–‡ä»¶å¤¹å†…</span></span><br><span class="line">        remove_to_tested(function_name)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(code)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰§è¡Œè¯¥å‡½æ•°</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">exec</span>(code, g)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;An error occurred while executing the code:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ‰“å°å‡½æ•°åç§°</span></span><br><span class="line">    <span class="keyword">if</span> detail == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;The function name is:%s&quot;</span> % function_name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> detail == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> tested == <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:   </span><br><span class="line">                content = f.read()</span><br><span class="line">                </span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> function_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_functions</span>(<span class="params">tested=<span class="literal">False</span>, if_print=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ‰“å°testedæˆ–untestedæ–‡ä»¶å¤¹å†…å…¨éƒ¨å‡½æ•°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    current_directory = os.getcwd()</span><br><span class="line">    <span class="keyword">if</span> tested == <span class="literal">False</span>:</span><br><span class="line">        directory = current_directory + <span class="string">&#x27;/functions/untested functions&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        directory = current_directory + <span class="string">&#x27;/functions/tested functions&#x27;</span></span><br><span class="line">    files_and_directories = os.listdir(directory)</span><br><span class="line">    <span class="comment"># è¿‡æ»¤ç»“æœï¼Œåªä¿ç•™.pyæ–‡ä»¶å’Œé__pycache__æ–‡ä»¶å¤¹</span></span><br><span class="line">    files_and_directories = files_and_directories = [name <span class="keyword">for</span> name <span class="keyword">in</span> files_and_directories <span class="keyword">if</span> (os.path.splitext(name)[<span class="number">1</span>] == <span class="string">&#x27;.py&#x27;</span> <span class="keyword">or</span> os.path.isdir(os.path.join(directory, name))) <span class="keyword">and</span> name != <span class="string">&quot;.ipynb_checkpoints&quot;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> if_print != <span class="literal">False</span>:</span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> files_and_directories:</span><br><span class="line">            <span class="built_in">print</span>(name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> files_and_directories</span><br></pre></td></tr></table></figure><h4 id="3-2-3-2-code-generateå…¨è‡ªåŠ¨ç¼–ç¨‹å‡½æ•°åˆ›å»ºæ–¹æ³•"><a href="#3-2-3-2-code-generateå…¨è‡ªåŠ¨ç¼–ç¨‹å‡½æ•°åˆ›å»ºæ–¹æ³•" class="headerlink" title="3.2.3.2 code_generateå…¨è‡ªåŠ¨ç¼–ç¨‹å‡½æ•°åˆ›å»ºæ–¹æ³•"></a>3.2.3.2 code_generateå…¨è‡ªåŠ¨ç¼–ç¨‹å‡½æ•°åˆ›å»ºæ–¹æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">code_generate</span>(<span class="params">req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=<span class="string">&#x27;glm-4&#x27;</span>, g=<span class="built_in">globals</span>(<span class="params"></span>), detail=<span class="number">0</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Function callingå¤–éƒ¨å‡½æ•°è‡ªåŠ¨åˆ›å»ºå‡½æ•°ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚ï¼Œç›´æ¥å°†å…¶ç¿»è¯‘ä¸ºChatæ¨¡å‹å¯ä»¥ç›´æ¥è°ƒç”¨çš„å¤–éƒ¨å‡½æ•°ä»£ç ã€‚</span></span><br><span class="line"><span class="string">    :param req: å¿…è¦å‚æ•°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œè¡¨ç¤ºè¾“å…¥çš„ç”¨æˆ·éœ€æ±‚ï¼›</span></span><br><span class="line"><span class="string">    :param few_shot: å¯é€‰å‚æ•°ï¼Œé»˜è®¤å–å€¼ä¸ºå­—ç¬¦ä¸²allï¼Œç”¨äºæè¿°Few-shotæç¤ºç¤ºä¾‹çš„é€‰å–æ–¹æ¡ˆï¼Œå½“è¾“å…¥å­—ç¬¦ä¸²allæ—¶ï¼Œåˆ™ä»£è¡¨æå–å½“å‰å¤–éƒ¨å‡½æ•°åº“ä¸­å…¨éƒ¨æµ‹è¯•è¿‡çš„å‡½æ•°ä½œä¸ºFew-shotï¼›\</span></span><br><span class="line"><span class="string">    è€Œå¦‚æœè¾“å…¥çš„æ˜¯ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªå‡½æ•°åç§°çš„listï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨è¿™äº›å‡½æ•°ä½œä¸ºFew-shotã€‚</span></span><br><span class="line"><span class="string">    :param model: å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè°ƒç”¨çš„Chatæ¨¡å‹ï¼Œé»˜è®¤é€‰å–glm-4ï¼›</span></span><br><span class="line"><span class="string">    :param g: å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºextract_function_codeå‡½æ•°ä½œç”¨åŸŸï¼Œé»˜è®¤ä¸ºglobals()ï¼Œå³åœ¨å½“å‰æ“ä½œç©ºé—´å…¨åŸŸå†…ç”Ÿæ•ˆï¼›</span></span><br><span class="line"><span class="string">    :param detail: å¯é€‰å‚æ•°ï¼Œé»˜è®¤å–å€¼ä¸º0ï¼Œè¿˜å¯ä»¥å–å€¼ä¸º1ï¼Œè¡¨ç¤ºextract_function_codeå‡½æ•°æ‰“å°æ–°åˆ›å»ºçš„å¤–éƒ¨å‡½æ•°ç»†èŠ‚ï¼›</span></span><br><span class="line"><span class="string">    :returnï¼šæ–°åˆ›å»ºçš„å‡½æ•°åç§°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‡½æ•°åˆ›å»ºæ—¶ï¼Œè¯¥å‡½æ•°ä¹Ÿä¼šåœ¨å½“å‰æ“ä½œç©ºé—´è¢«å®šä¹‰ï¼Œåç»­å¯ä»¥ç›´æ¥è°ƒç”¨ï¼›</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–æç¤ºç¤ºä¾‹çš„å‡½æ•°åç§°</span></span><br><span class="line">    <span class="keyword">if</span> few_shot == <span class="string">&#x27;all&#x27;</span>:</span><br><span class="line">        few_shot_functions_name = show_functions(tested=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span>(few_shot) == <span class="built_in">list</span>:</span><br><span class="line">        few_shot_functions_name = few_shot</span><br><span class="line">    <span class="comment"># few_shot_functions = [globals()[name] for name in few_shot_functions_name]</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¯»å–å„é˜¶æ®µç³»ç»Ÿæç¤º</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/system_messages.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        system_messages = json.load(f)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># å„é˜¶æ®µæç¤ºmessageå¯¹è±¡</span></span><br><span class="line">    few_shot_messages_CM = []</span><br><span class="line">    few_shot_messages_CD = []</span><br><span class="line">    </span><br><span class="line">    few_shot_messages = []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å…ˆä¿å­˜ç¬¬ä¸€æ¡æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯system message</span></span><br><span class="line">    few_shot_messages_CD += system_messages[<span class="string">&quot;system_message_CD&quot;</span>]</span><br><span class="line">    few_shot_messages_CM += system_messages[<span class="string">&quot;system_message_CM&quot;</span>]</span><br><span class="line">    few_shot_messages += system_messages[<span class="string">&quot;system_message&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºä¸åŒé˜¶æ®µæç¤ºmessage</span></span><br><span class="line">    <span class="keyword">for</span> function_name <span class="keyword">in</span> few_shot_functions_name:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            msg = json.load(f)</span><br><span class="line">        few_shot_messages_CD += msg[<span class="string">&quot;stage1_CD&quot;</span>]</span><br><span class="line">        few_shot_messages_CM += msg[<span class="string">&quot;stage1_CM&quot;</span>]</span><br><span class="line">        few_shot_messages += msg[<span class="string">&#x27;stage2&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># è¯»å–ç”¨æˆ·éœ€æ±‚ï¼Œä½œä¸ºç¬¬ä¸€é˜¶æ®µCDç¯èŠ‚User content</span></span><br><span class="line">    new_req_CD_input = req</span><br><span class="line">    few_shot_messages_CD.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_CD_input&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬ä¸€é˜¶æ®µCDç¯èŠ‚æç¤ºåˆ›å»ºå®Œæ¯•ï¼Œæ­£åœ¨è¿›è¡ŒCDæç¤º...&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¬¬ä¸€é˜¶æ®µCDç¯èŠ‚Chatæ¨¡å‹è°ƒç”¨è¿‡ç¨‹</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">                        model=model,</span><br><span class="line">                        messages=few_shot_messages_CD)</span><br><span class="line">    new_req_pi = response.choices[<span class="number">0</span>].message.content</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬ä¸€é˜¶æ®µCDç¯èŠ‚æç¤ºå®Œæ¯•&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¬¬ä¸€é˜¶æ®µCMç¯èŠ‚Messagesåˆ›å»º</span></span><br><span class="line">    new_req_CM_input = new_req_CD_input + new_req_pi</span><br><span class="line">    few_shot_messages_CM.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_CM_input&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬ä¸€é˜¶æ®µCMç¯èŠ‚æç¤ºåˆ›å»ºå®Œæ¯•ï¼Œæ­£åœ¨è¿›è¡Œç¬¬ä¸€é˜¶æ®µCMæç¤º...&#x27;</span>)</span><br><span class="line">    <span class="comment"># ç¬¬ä¸€é˜¶æ®µCMç¯èŠ‚Chatæ¨¡å‹è°ƒç”¨è¿‡ç¨‹</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">                        model=model,</span><br><span class="line">                        messages=few_shot_messages_CM)</span><br><span class="line">    new_req_description = response.choices[<span class="number">0</span>].message.content</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬ä¸€é˜¶æ®µCMç¯èŠ‚æç¤ºå®Œæ¯•&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¬¬äºŒé˜¶æ®µMessagesåˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line">    few_shot_messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_description&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬äºŒé˜¶æ®µæç¤ºåˆ›å»ºå®Œæ¯•ï¼Œæ­£åœ¨è¿›è¡Œç¬¬äºŒé˜¶æ®µæç¤º...&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ç¬¬äºŒé˜¶æ®µChatæ¨¡å‹è°ƒç”¨è¿‡ç¨‹</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">                        model=model,</span><br><span class="line">                        messages=few_shot_messages)</span><br><span class="line">    new_req_function = response.choices[<span class="number">0</span>].message.content</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬äºŒé˜¶æ®µæç¤ºå®Œæ¯•ï¼Œå‡†å¤‡è¿è¡Œå‡½æ•°å¹¶ç¼–å†™æç¤ºç¤ºä¾‹&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–å‡½æ•°å¹¶è¿è¡Œï¼Œåˆ›å»ºå‡½æ•°åç§°å¯¹è±¡ï¼Œç»Ÿä¸€éƒ½å†™å…¥untestedæ–‡ä»¶å¤¹å†…</span></span><br><span class="line">    function_name = extract_function_code(s=new_req_function, detail=detail, g=g)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ–°å‡½æ•°ä¿å­˜åœ¨./functions/untested functions/%s/%s_module.pyæ–‡ä»¶ä¸­&#x27;</span> % (function_name, function_name))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºè¯¥å‡½æ•°æç¤ºç¤ºä¾‹</span></span><br><span class="line">    new_req_messages_CD = [</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_CD_input&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_pi&#125;</span><br><span class="line">                         ]</span><br><span class="line">    new_req_messages_CM = [</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_CM_input&#125;,</span><br><span class="line">                          &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>:new_req_description&#125;</span><br><span class="line">                         ]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        new_req_function = f.read()</span><br><span class="line">    </span><br><span class="line">    new_req_messages = [</span><br><span class="line">                       &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: new_req_description&#125;,</span><br><span class="line">                       &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>:new_req_function&#125;</span><br><span class="line">                      ] </span><br><span class="line">    </span><br><span class="line">    new_req_prompt = &#123;</span><br><span class="line">                     <span class="string">&quot;stage1_CD&quot;</span>: new_req_messages_CD,</span><br><span class="line">                     <span class="string">&quot;stage1_CM&quot;</span>: new_req_messages_CM,</span><br><span class="line">                     <span class="string">&quot;stage2&quot;</span>: new_req_messages</span><br><span class="line">                    &#125;   </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(new_req_prompt, f)</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ–°å‡½æ•°æç¤ºç¤ºä¾‹ä¿å­˜åœ¨./functions/untested functions/%s/%s_prompt.jsonæ–‡ä»¶ä¸­&#x27;</span> % (function_name, function_name))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;done&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> function_name</span><br></pre></td></tr></table></figure><h4 id="3-2-3-3-é¢å¤–éœ€æ±‚æµ‹è¯•"><a href="#3-2-3-3-é¢å¤–éœ€æ±‚æµ‹è¯•" class="headerlink" title="3.2.3.3 é¢å¤–éœ€æ±‚æµ‹è¯•"></a>3.2.3.3 é¢å¤–éœ€æ±‚æµ‹è¯•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">few_shot_functions = [<span class="string">&#x27;get_latest_email&#x27;</span>, <span class="string">&#x27;get_email_count&#x27;</span>]</span><br><span class="line">req = <span class="string">&quot;è¯·æŸ¥ä¸‹é‚®ç®±é‡Œï¼Œmeè¿™ä¸ªé‚®ç®±ç»™é™†å°å‡¤å‘è¿‡å¤šå°‘å°é‚®ä»¶ï¼Ÿ&quot;</span></span><br><span class="line">function_name = code_generate(req=req, few_shot=few_shot_functions)</span><br><span class="line">functions_list = [function_name]</span><br><span class="line">messages = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘çš„é‚®ç®±å·å«me,é™†å°å‡¤çš„é‚®ç®±å·å°±å«é™†å°å‡¤&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: req&#125;]</span><br><span class="line">final_response = run_conversation(messages=messages, functions_list=functions_list, model=<span class="string">&quot;glm-4&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(final_response)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-3-Alä¸ºä¸»ï¼Œä»¥äººä¸ºè¾…"><a href="#3-3-Alä¸ºä¸»ï¼Œä»¥äººä¸ºè¾…" class="headerlink" title="3.3 Alä¸ºä¸»ï¼Œä»¥äººä¸ºè¾…"></a>3.3 Alä¸ºä¸»ï¼Œä»¥äººä¸ºè¾…</h2><p><img src="/images/4.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B%E5%92%8CFunction%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/image-20250319112123288.png" alt="image-20250319112123288"></p><ol><li><p>å¤§æ¨¡å‹æ¢³ç†éœ€æ±‚</p></li><li><p>å¤§æ¨¡å‹å¸®å¿™å†™ä»£ç </p></li><li><p>å¤§æ¨¡å‹å®¡æ ¸ä»£ç </p></li></ol><h3 id="3-3-1-å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆå‰–æ"><a href="#3-3-1-å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆå‰–æ" class="headerlink" title="3.3.1 å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆå‰–æ"></a>3.3.1 å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆå‰–æ</h3><ol><li>é¢„è®­ç»ƒï¼Œå¾®è°ƒï¼šè¿™äº›æ–¹æ¡ˆéœ€è¦çš„æ•°æ®é‡å¾ˆå¤§ï¼Œæˆ‘ä»¬å‹æ ¹ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šçš„æ ·æœ¬çš„æ•°æ®ï¼Œè€Œä¸”è¿™ç§æ–¹æ¡ˆé—¨æ§›å¾ˆé«˜ï¼Œæˆæœ¬ä¹Ÿå¾ˆé«˜ã€‚æ‰€ä»¥ä¸ç°å®ã€‚</li><li>One-Shotï¼ŒFew-Shotï¼šè¿™äº›æ–¹æ¡ˆåœ¨ç®€å•åœºæ™¯ä¸‹æœ‰ç”¨ï¼Œå¤æ‚åœºæ™¯å°±ä¸ç®¡ç”¨äº†ï¼Œè€Œä¸”å¦‚æœæˆ‘ä»¬Few-shotçš„é‡å¤§çš„è¯ï¼Œæˆ‘ä»¬çš„ä¸Šæ–‡çš„Tokenå°±ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ¡ˆä¹Ÿè¡Œä¸é€šã€‚</li><li>å¤–æŒ‚æœ¬åœ°çŸ¥è¯†åº“ï¼šå¤§æ¨¡å‹æœ¬èº«èƒ½åŠ›å°±å¾ˆå¼ºï¼Œè€Œä¸”æ‡‚çš„ä¹Ÿå¾ˆå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬æä¸€ä¸ªæœ¬åœ°çŸ¥è¯†åº“ï¼Œåœ¨æœ¬åœ°çŸ¥è¯†åº“é‡Œæ¿€å‘è¿™ä¸ªå¤§æ¨¡å‹çš„èƒ½åŠ›ï¼Œä»è€Œå¼•å¯¼è¿™ä¸ªå¤§æ¨¡å‹å®Œæˆå®¡æŸ¥ä»»åŠ¡ã€‚</li><li>å¦‚ä½•å¼•å¯¼å’Œå¯å‘ä¸€ä¸ªå¤§è¯­è¨€æ¨¡å‹å»ç†è§£ä¸€äº›é™Œç”Ÿçš„äº‹ç‰©ï¼Ÿå°±åƒè€å¸ˆæ•™å­¦ä¸€æ ·ï¼Œæœ‰ä¸¤ä¸ªç®€å•é«˜æ•ˆçš„æ–¹æ³•ï¼Œå…¶ä¸€æ˜¯æ˜¯ç”¨å…¶å·²çŸ¥çš„çŸ¥è¯†å»ç±»æ¯”æœªçŸ¥çš„çŸ¥è¯†ï¼Œå…¶äºŒåˆ™æ˜¯å°†é™Œç”Ÿäº‹ç‰©è§†ä¸ºæŸäº›ä¸€èˆ¬æ¦‚å¿µçš„ç‰¹ä¾‹ã€‚ä¾‹å¦‚ï¼Œå½“å‰çš„å¤–éƒ¨æŒ‚è½½æ–‡æ¡£éå¸¸é‡è¦çš„ä¸€ä¸ªä½œç”¨å°±æ˜¯è¦è®©å¤§è¯­è¨€æ¨¡å‹ç†è§£ç°åœ¨è¦å®¡æŸ¥çš„å¤šæ®µæç¤ºï¼Œå³è¦å¼•å¯¼å¤§è¯­è¨€æ¨¡å‹ç†è§£ä»€ä¹ˆæ˜¯å¤šæ®µæç¤ºï¼Œä½†å¦‚æœä»å¤´å¼€å§‹è¿›è¡Œç›¸å…³æ¦‚å¿µä»‹ç»ï¼ˆä¾‹å¦‚ä»å¤´ä»‹ç»ä¸¤ä¸ªé˜¶æ®µçš„æç¤ºåˆ†åˆ«æ˜¯ä»€ä¹ˆã€ä»€ä¹ˆæ˜¯LtMã€ä»€ä¹ˆæ˜¯é—®é¢˜æ‹†è§£ç­‰ï¼‰ä¼šéå¸¸çš„ç¹çä¸”æ•ˆç‡å¾ˆä½ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬å¯ä»¥å°†å¤šæ®µæç¤ºæ¯”å–»æˆæ¨ç†é“¾ï¼Œå€ŸåŠ©å¤§è¯­è¨€æ¨¡å‹æœ¬èº«å¯¹æ¨ç†é“¾çš„ç†è§£æ¥ç†è§£ä»€ä¹ˆæ˜¯å¤šæ®µæç¤ºã€‚</li></ol><p>æ¡ˆä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function_name = <span class="string">&#x27;get_latest_email&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    msg = json.load(f)</span><br><span class="line">chain_of_prompt = <span class="string">&quot;ä»¥ä¸‹æ˜¯ä¸ªä¸€ä¸ªæˆåŠŸè¿è¡Œçš„æ¨ç†é“¾æ¡ï¼Œæ¨ç†åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼Œå„é˜¶æ®µæ¨ç†å†…å®¹å¦‚ä¸‹ï¼š%sã€‚&quot;</span> % msg</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">                        model=<span class="string">&quot;glm-4&quot;</span>,</span><br><span class="line">                        messages=[&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,  <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ¨ç†é“¾ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ»¡è¶³æŸä¸ªåŠŸèƒ½çš„å‡½æ•°ï¼Œæ¨ç†é“¾å¦‚ä¸‹ï¼š%sã€‚è¯·å¸®æˆ‘ä»‹ç»ä¸‹è¿™ä¸ªæ¨ç†é“¾&quot;</span> % chain_of_prompt&#125;]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="3-3-2-å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆè½åœ°"><a href="#3-3-2-å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆè½åœ°" class="headerlink" title="3.3.2 å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆè½åœ°"></a>3.3.2 å®¡æŸ¥æ¨¡å‹æ„å»ºæ–¹æ¡ˆè½åœ°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;å¤æ‚éœ€æ±‚æ¨ç†é“¾.md&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    md_content = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(md_content)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä»€ä¹ˆæ˜¯é‚®ç®±é¡¹ç›®ï¼Ÿé‚®ä»¶é¡¹ç›®æœ¬èº«ç”±ä¸€ç³»åˆ—çš„ç¨‹åºç»„æˆï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·è‡ªç„¶è¯­è¨€æè¿°è¿›è¡Œç›¸åº”çš„é‚®ç®±æ“ä½œï¼Œå¦‚æŸ¥é˜…é‚®ä»¶ã€æ”¶å‘é‚®ä»¶ç­‰ã€‚è¯¥åœºæ™¯æ˜¯æˆ‘ä»¬è‡ªå·±æ„å»ºçš„ä¸€ä¸ªåœºæ™¯ã€‚ä¸»è¦å®ç°çš„æ˜¯å¯¹æˆ‘ä»¬my_mailæ•°æ®åº“é‡Œçš„æ•°æ®è¿›è¡Œå¢åˆ æŸ¥æ”¹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>ä»€ä¹ˆæ˜¯æ¨ç†é“¾ï¼Ÿåœ¨æ™ºèƒ½é‚®ä»¶é¡¹ç›®ä¸­ï¼Œæ¨ç†é“¾ç‰¹æŒ‡å°†ç”¨æˆ·çš„éœ€æ±‚é€æ­¥æ¨å¯¼ä¸ºpythonå‡½æ•°çš„è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ¨ç†é“¾çš„è¾“å…¥éƒ½æ˜¯ç”¨æˆ·éœ€æ±‚ï¼Œè€Œæ¨ç†çš„ç»“æœåˆ™æ˜¯ä¸€ä¸ªå¯ä»¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„å‡½æ•°ã€‚æ¯ä¸ªæ¨ç†é“¾éƒ½æœ‰ä¸‰ä¸ªæ¨ç†ç¯èŠ‚ï¼Œä¸”éƒ½ä»¥jsonæ ¼å¼è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªæ­£ç¡®çš„æ¨ç†é“¾Aï¼š</span><br><span class="line"></span><br><span class="line">```json</span><br><span class="line">&#123;<span class="string">&quot;stage1_CD&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\u8bf7\u67e5\u9605\u6211\u90ae\u7bb1\u91cc\u9762\u672a\u8bfb\u90ae\u4ef6\uff0c\u4ece\u6311\u9009\u6709\u5173\u4f1a\u8bae\u9080\u8bf7\u7684\u90ae\u4ef6\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u4e00\u4e2a\u540d\u79f0\u4e3a\u4f1a\u8bae\u9884\u5b9a\u7684\u6807\u7b7e&quot;</span>&#125;, &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\u5f53\u524d\u9700\u6c42\u4e2d\u53ef\u4ee5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u7684\u662f\uff1a1.\u67e5\u8be2\u6761\u4ef6\uff1b2.\u6dfb\u52a0\u7684\u6807\u7b7e\u540d\uff1b3.\u67e5\u8be2\u8c01\u7684\u90ae\u7bb1&quot;</span>&#125;], <span class="string">&quot;stage1_CM&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\u8bf7\u67e5\u9605\u6211\u90ae\u7bb1\u91cc\u9762\u672a\u8bfb\u90ae\u4ef6\uff0c\u4ece\u6311\u9009\u6709\u5173\u4f1a\u8bae\u9080\u8bf7\u7684\u90ae\u4ef6\uff0c\u5e76\u5c06\u5176\u6dfb\u52a0\u4e00\u4e2a\u540d\u79f0\u4e3a\u4f1a\u8bae\u9884\u5b9a\u7684\u6807\u7b7e\u5f53\u524d\u9700\u6c42\u4e2d\u53ef\u4ee5\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u7684\u662f\uff1a1.\u67e5\u8be2\u6761\u4ef6\uff1b2.\u6dfb\u52a0\u7684\u6807\u7b7e\u540d\uff1b3.\u67e5\u8be2\u8c01\u7684\u90ae\u7bb1&quot;</span>&#125;, &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\u8bf7\u5e2e\u6211\u7f16\u5199\u4e00\u4e2apython\u51fd\u6570\uff0c\u67e5\u8be2\u6211\u6536\u5230\u7684\u6240\u6709\u672a\u8bfb\u90ae\u4ef6\uff0c\u5e76\u5728\u4e0e\u4f1a\u8bae\u9080\u8bf7\u76f8\u5173\u7684\u90ae\u4ef6\u4e0a\u6dfb\u52a0\u4e00\u79cd\u540d\u4e3a\u201c\u4f1a\u8bae\u9884\u5b9a\u201d\u7684\u6807\u7b7e\uff0c\u51fd\u6570\u8981\u6c42\u5982\u4e0b\uff1a                  1.\u51fd\u6570\u53c2\u6570query\u3001tag\u548cuser_id\uff0c\u4e09\u4e2a\u53c2\u6570\u90fd\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5176\u4e2dquery\u8868\u793a\u8981\u67e5\u8be2\u7684\u6761\u4ef6\uff0ctag\u8868\u793a\u8981\u6dfb\u52a0\u7684\u6807\u7b7e\u540d\uff0cuser_id\u8868\u793a\u8981\u68c0\u7d22\u90ae\u4ef6\u7684\u7528\u6237\u7684ID\u3002\u9ed8\u8ba4\u503c\u662f&#x27;me&#x27;\uff0c\u8868\u793a\u5f53\u524d\u6388\u6743\u7684\u7528\u6237\uff1b                  2.\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\u662f\u6dfb\u52a0\u6807\u7b7e\u540e\u7684\u90ae\u4ef6\u5217\u8868\uff0c\u8fd4\u56de\u7ed3\u679c\u672c\u8eab\u5fc5\u987b\u662f\u4e00\u4e2ajson\u683c\u5f0f\u5bf9\u8c61\uff1b                  3.\u8bf7\u5c06\u5168\u90e8\u529f\u80fd\u5c01\u88c5\u5728\u4e00\u4e2a\u51fd\u6570\u5185\uff1b                  4.\u8bf7\u5728\u51fd\u6570\u7f16\u5199\u8fc7\u7a0b\u4e2d\uff0c\u5728\u51fd\u6570\u5185\u90e8\u52a0\u5165\u4e2d\u6587\u7f16\u5199\u7684\u8be6\u7ec6\u7684\u51fd\u6570\u8bf4\u660e\u6587\u6863\uff0c\u7528\u4e8e\u8bf4\u660e\u51fd\u6570\u529f\u80fd\u3001\u51fd\u6570\u53c2\u6570\u60c5\u51b5\u4ee5\u53ca\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\u7b49\u4fe1\u606f\uff1b&quot;</span>&#125;], <span class="string">&quot;stage2&quot;</span>: [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;\u8bf7\u5e2e\u6211\u7f16\u5199\u4e00\u4e2apython\u51fd\u6570\uff0c\u67e5\u8be2\u6211\u6536\u5230\u7684\u6240\u6709\u672a\u8bfb\u90ae\u4ef6\uff0c\u5e76\u5728\u4e0e\u4f1a\u8bae\u9080\u8bf7\u76f8\u5173\u7684\u90ae\u4ef6\u4e0a\u6dfb\u52a0\u4e00\u79cd\u540d\u4e3a\u201c\u4f1a\u8bae\u9884\u5b9a\u201d\u7684\u6807\u7b7e\uff0c\u51fd\u6570\u8981\u6c42\u5982\u4e0b\uff1a                  1.\u51fd\u6570\u53c2\u6570query\u3001tag\u548cuser_id\uff0c\u4e09\u4e2a\u53c2\u6570\u90fd\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u5176\u4e2dquery\u8868\u793a\u8981\u67e5\u8be2\u7684\u6761\u4ef6\uff0ctag\u8868\u793a\u8981\u6dfb\u52a0\u7684\u6807\u7b7e\u540d\uff0cuser_id\u8868\u793a\u8981\u68c0\u7d22\u90ae\u4ef6\u7684\u7528\u6237\u7684ID\u3002\u9ed8\u8ba4\u503c\u662f&#x27;me&#x27;\uff0c\u8868\u793a\u5f53\u524d\u6388\u6743\u7684\u7528\u6237\uff1b                  2.\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\u662f\u6dfb\u52a0\u6807\u7b7e\u540e\u7684\u90ae\u4ef6\u5217\u8868\uff0c\u8fd4\u56de\u7ed3\u679c\u672c\u8eab\u5fc5\u987b\u662f\u4e00\u4e2ajson\u683c\u5f0f\u5bf9\u8c61\uff1b                  3.\u8bf7\u5c06\u5168\u90e8\u529f\u80fd\u5c01\u88c5\u5728\u4e00\u4e2a\u51fd\u6570\u5185\uff1b                  4.\u8bf7\u5728\u51fd\u6570\u7f16\u5199\u8fc7\u7a0b\u4e2d\uff0c\u5728\u51fd\u6570\u5185\u90e8\u52a0\u5165\u4e2d\u6587\u7f16\u5199\u7684\u8be6\u7ec6\u7684\u51fd\u6570\u8bf4\u660e\u6587\u6863\uff0c\u7528\u4e8e\u8bf4\u660e\u51fd\u6570\u529f\u80fd\u3001\u51fd\u6570\u53c2\u6570\u60c5\u51b5\u4ee5\u53ca\u51fd\u6570\u8fd4\u56de\u7ed3\u679c\u7b49\u4fe1\u606f\uff1b&quot;</span>&#125;, &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;def label_meeting_emails(query, tag, user_id=&#x27;me&#x27;):\n    \&quot;\&quot;\&quot;\n    \u67e5\u8be2\u672a\u8bfb\u90ae\u4ef6\uff0c\u5e76\u7ed9\u4e0e\u4f1a\u8bae\u9080\u8bf7\u76f8\u5173\u7684\u90ae\u4ef6\u6dfb\u52a0\u6807\u7b7e\u3002\n\n    \u53c2\u6570:\n    query: \u8981\u67e5\u8be2\u7684\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u5bfb\u627e\u5305\u542b\u201c\u4f1a\u8bae\u201d\u6216\u201c\u9080\u8bf7\u201d\u7b49\u5173\u952e\u5b57\u7684\u90ae\u4ef6\u3002\n    tag: \u8981\u6dfb\u52a0\u7684\u6807\u7b7e\u7684\u540d\u5b57\u3002\n    user_id: \u8981\u68c0\u67e5\u7684\u7528\u6237\u7684ID\uff0c\u9ed8\u8ba4\u503c\u4e3a&#x27;me&#x27;\uff0c\u8868\u793a\u5f53\u524d\u6388\u6743\u7684\u7528\u6237\u3002\n\n    \u8fd4\u56de:\n    \u5982\u679c\u6210\u529f\uff0c\u5219\u8fd4\u56de\u4e00\u4e2a\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a\u5b57\u5178\uff0c\u5305\u542b\u5df2\u6dfb\u52a0\u6807\u7b7e\u7684\u90ae\u4ef6\u7684ID\u548c\u4e3b\u9898\u3002\u5426\u5219\uff0c\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\u3002\n    \&quot;\&quot;\&quot;\n    # \u4ece\u672c\u5730\u6587\u4ef6\u4e2d\u52a0\u8f7d\u51ed\u636e\n    creds = Credentials.from_authorized_user_file(&#x27;token.json&#x27;)\n\n    # \u521b\u5efa Gmail API \u5ba2\u6237\u5bf9\u8c61\n    service = build(&#x27;gmail&#x27;, &#x27;v1&#x27;, credentials=creds)\n\n    # \u83b7\u53d6\u6ee1\u8db3\u67e5\u8be2\u6761\u4ef6\u7684\u90ae\u4ef6\u5217\u8868\n    results = service.users().messages().list(userId=user_id, q=f&#x27;is:unread &#123;query&#125;&#x27;).execute()\n    messages = results.get(&#x27;messages&#x27;, [])\n\n    if not messages:\n        print(f\&quot;No results for query: &#123;query&#125;\&quot;)\n        return json.dumps(&#123;\&quot;error\&quot;:\&quot;No emails found.\&quot;&#125;)\n\n    # \u4e3a\u6ee1\u8db3\u6761\u4ef6\u7684\u90ae\u4ef6\u6dfb\u52a0\u6807\u7b7e\n    emails = []\n    for msg in messages:\n        # \u83b7\u53d6\u90ae\u4ef6\u8be6\u60c5\n        msg = service.users().messages().get(userId=user_id, id=msg[&#x27;id&#x27;]).execute()\n\n        # \u6807\u7b7e\u5904\u7406\n        add_label = &#123;\n            &#x27;addLabelIds&#x27;: [tag],\n            &#x27;removeLabelIds&#x27;: []\n        &#125;\n        msg[&#x27;payload&#x27;][&#x27;headers&#x27;][-1].get(&#x27;value&#x27;)\n        res = service.users().messages().modify(userId=user_id, id=msg[&#x27;id&#x27;], body=add_label).execute()\n\n        # \u6dfb\u52a0\u90ae\u4ef6\u4fe1\u606f\n        for d in msg[&#x27;payload&#x27;][&#x27;headers&#x27;]:\n            if d[&#x27;name&#x27;] == &#x27;Subject&#x27;:\n                sub = d[&#x27;value&#x27;]\n        emails.append(&#123;\&quot;id\&quot;: res[&#x27;id&#x27;], \&quot;subject\&quot;: sub&#125;)\n\n    return json.dumps(emails, indent=2)\n&quot;</span>&#125;]&#125;</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>å¯¹äºæ¨ç†é“¾æœ€åç”Ÿæˆçš„å‡½æ•°ï¼Œä¸€å®šè¦æ˜¯å¯ä»¥è¿è¡Œçš„ã€èƒ½å¤Ÿæ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„pythonå‡½æ•°ï¼Œä¸”éœ€è¦æœ‰è¯¦ç»†çš„è¯´æ˜æ–‡æ¡£ï¼Œè¯´æ˜æ–‡æ¡£å†…å®¹åŒ…æ‹¬å‡½æ•°åŠŸèƒ½ã€å‡½æ•°å‚æ•°æƒ…å†µä»¥åŠå‡½æ•°è¿”å›ç»“æœç­‰ä¿¡æ¯ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>ä½ æ˜¯ä¸€ä¸ªæ¨ç†é“¾å®¡æŸ¥åŠ©æ‰‹ï¼Œå–„äºæ£€æµ‹æ¨ç†é“¾ä¸­æ˜¯å¦å­˜åœ¨é”™è¯¯ã€‚æ¥ä¸‹æ¥æˆ‘ä¼šç»™ä½ ä¸€ä¸ªé”™è¯¯çš„æ¨ç†é“¾ï¼Œè¯·ä½ å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>å½“ä½ å¯¹æ¨ç†é“¾è¿›è¡Œä¿®æ”¹ä¹‹åï¼Œè¯·ä»¿é€ æ¨ç†é“¾Açš„æ ¼å¼ï¼Œä»¥jsonæ ¼å¼è¾“å‡ºä¿®æ”¹ä¹‹åçš„æ¨ç†é“¾ã€‚æ³¨æ„ï¼Œè¯·å‹¿è¿”å›å…¶ä»–è§£é‡Šè¯´æ˜çš„æ–‡å­—ï¼Œåªè¿”å›ä¸€ä¸ªjsonæ ¼å¼çš„ä¿®æ”¹ä¹‹åçš„æ¨ç†é“¾å³å¯ã€‚</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç®€å•æ€»ç»“å¤–éƒ¨æŒ‚è½½æ–‡æ¡£çš„5æ–¹é¢ä¿¡æ¯ï¼š</p><ol><li><p>è¯´æ˜å½“å‰é¡¹ç›®èƒŒæ™¯ï¼ˆåŒ…æ‹¬ç¼–ç¨‹è¦æ±‚ç­‰ï¼‰ï¼›</p></li><li><p>è¯´æ˜å®¡æŸ¥å¯¹è±¡ï¼ŒåŒ…æ‹¬å®¡æŸ¥å¯¹è±¡çš„æ€§è´¨å’Œå½¢å¼ç­‰ï¼›</p></li><li><p>è¯´æ˜å®¡æŸ¥çš„ç›®æ ‡ï¼›</p></li><li><p>è¿›è¡Œèº«ä»½è®¾ç½®ï¼›</p></li><li><p>è¯´æ˜å®¡æŸ¥ä¹‹åçš„è¾“å‡ºç»“æœã€‚</p></li></ol></blockquote><h3 id="3-3-3-å®¡æŸ¥æ¨¡å‹æ•ˆæœéªŒè¯"><a href="#3-3-3-å®¡æŸ¥æ¨¡å‹æ•ˆæœéªŒè¯" class="headerlink" title="3.3.3 å®¡æŸ¥æ¨¡å‹æ•ˆæœéªŒè¯"></a>3.3.3 å®¡æŸ¥æ¨¡å‹æ•ˆæœéªŒè¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;å¤æ‚éœ€æ±‚æ¨ç†é“¾.md&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    md_content = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./error_function_test/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    msg = json.load(f)</span><br><span class="line"></span><br><span class="line">msg_str = json.dumps(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./data/my_mailæ•°æ®å­—å…¸.md&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data_content = f.read()</span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">                        model=<span class="string">&quot;glm-4&quot;</span>,</span><br><span class="line">                        messages=[</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: data_content&#125;,</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: md_content&#125;,</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;ä»¥ä¸‹æ˜¯ä¸€ä¸ªé”™è¯¯çš„é‚®ç®±é¡¹ç›®çš„æ¨ç†é“¾ï¼Œè¯·ä½ æŒ‰ç…§è¦æ±‚å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼š%s&#x27;</span> % msg_str&#125;</span><br><span class="line">                          ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="3-3-4-åŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨Debugçš„å‡½æ•°"><a href="#3-3-4-åŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨Debugçš„å‡½æ•°" class="headerlink" title="3.3.4 åŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨Debugçš„å‡½æ•°"></a>3.3.4 åŸºäºå¤§æ¨¡å‹çš„è‡ªåŠ¨Debugçš„å‡½æ•°</h3><h4 id="3-3-4-1-å®šä¹‰ä¸€ä¸ªå®¡æŸ¥å‡½æ•°"><a href="#3-3-4-1-å®šä¹‰ä¸€ä¸ªå®¡æŸ¥å‡½æ•°" class="headerlink" title="3.3.4.1 å®šä¹‰ä¸€ä¸ªå®¡æŸ¥å‡½æ•°"></a>3.3.4.1 å®šä¹‰ä¸€ä¸ªå®¡æŸ¥å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">prompt_modified</span>(<span class="params">function_name, system_content=<span class="string">&#x27;./data/æ¨ç†é“¾.md&#x27;</span>, model=<span class="string">&quot;glm-4&quot;</span>, g=<span class="built_in">globals</span>(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    é‚®ç®±é¡¹ç›®çš„å¤–éƒ¨å‡½æ•°å®¡æŸ¥å‡½æ•°ï¼Œç”¨äºå®¡æŸ¥å¤–éƒ¨å‡½æ•°åˆ›å»ºæµç¨‹æç¤ºæ˜¯å¦æ­£ç¡®ä»¥åŠæœ€ç»ˆåˆ›å»ºçš„ä»£ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="string">    :param function_name: å¿…è¦å‚æ•°ï¼Œå­—ç¬¦ä¸²ç±»å‹ï¼Œè¡¨ç¤ºå®¡æŸ¥å¯¹è±¡åç§°ï¼›</span></span><br><span class="line"><span class="string">    :param system_content: å¯é€‰å‚æ•°ï¼Œé»˜è®¤å–å€¼ä¸ºå­—ç¬¦ä¸²æ¨ç†é“¾ä¿®æ”¹.mdï¼Œè¡¨ç¤ºæ­¤æ—¶å®¡æŸ¥å‡½æ•°å¤–éƒ¨æŒ‚è½½æ–‡æ¡£åç§°ï¼Œéœ€è¦æ˜¯markdwonæ ¼å¼æ–‡æ¡£ï¼›</span></span><br><span class="line"><span class="string">    :param model: å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºè°ƒç”¨çš„Chatæ¨¡å‹ï¼Œé»˜è®¤é€‰glm-4ï¼›</span></span><br><span class="line"><span class="string">    :param g: å¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºextract_function_codeå‡½æ•°ä½œç”¨åŸŸï¼Œé»˜è®¤ä¸ºglobals()ï¼Œå³åœ¨å½“å‰æ“ä½œç©ºé—´å…¨åŸŸå†…ç”Ÿæ•ˆï¼›</span></span><br><span class="line"><span class="string">    :returnï¼šå®¡æŸ¥ç»“æŸåæ–°åˆ›å»ºçš„å‡½æ•°åç§°</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨æ‰§è¡Œå®¡æŸ¥å‡½æ•°ï¼Œå®¡æŸ¥å¯¹è±¡ï¼š%s&quot;</span> % function_name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./data/my_mailæ•°æ®å­—å…¸.md&quot;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data_content = f.read()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(system_content, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        md_content = f.read()</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># è¯»å–åŸå‡½æ•°å…¨éƒ¨æç¤ºå†…å®¹</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        msg = json.load(f)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å…¶ä¿å­˜ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    msg_str = json.dumps(msg)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿›è¡Œå®¡æŸ¥</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">                        model=model,</span><br><span class="line">                        messages=[</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: data_content&#125;,</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: md_content&#125;,</span><br><span class="line">                            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;ä»¥ä¸‹æ˜¯ä¸€ä¸ªé”™è¯¯çš„é‚®ç®±é¡¹ç›®çš„æ¨ç†é“¾ï¼Œè¯·ä½ æŒ‰ç…§è¦æ±‚å¯¹å…¶è¿›è¡Œä¿®æ”¹ï¼š%s&#x27;</span> % msg_str&#125;</span><br><span class="line">                          ]</span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    modified_result = response.choices[<span class="number">0</span>].message.content</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_json</span>(<span class="params">s</span>):</span><br><span class="line">        pattern = <span class="string">r&#x27;```[jJ][sS][oO][nN]\s*(&#123;.*?&#125;)\s*```&#x27;</span></span><br><span class="line">        <span class="keyword">match</span> = re.search(pattern, s, re.DOTALL)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">    </span><br><span class="line">    modified_json = extract_json(modified_result)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–å‡½æ•°æºç </span></span><br><span class="line">    code = json.loads(modified_json)[<span class="string">&#x27;stage2&#x27;</span>][<span class="number">1</span>][<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æå–å‡½æ•°å</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r&#x27;def (\w+)&#x27;</span>, code)</span><br><span class="line">    function_name = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å®¡æŸ¥ç»“æŸï¼Œæ–°çš„å‡½æ•°åç§°ä¸ºï¼š%sã€‚\næ­£åœ¨è¿è¡Œè¯¥å‡½æ•°å®šä¹‰è¿‡ç¨‹ï¼Œå¹¶ä¿å­˜å‡½æ•°æºç ä¸prompt&quot;</span> % function_name)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">exec</span>(code, g)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨untestedæ–‡ä»¶å¤¹å†…åˆ›å»ºå‡½æ•°åŒåæ–‡ä»¶å¤¹</span></span><br><span class="line">    directory = <span class="string">&#x27;./functions/untested functions/%s&#x27;</span> % function_name</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        os.makedirs(directory)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># å†™å…¥å‡½æ•°</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (function_name, function_name), <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(code)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># å†™å…¥æç¤º</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_prompt.json&#x27;</span> % (function_name, function_name), <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        json.dump(json.loads(modified_json), f)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ–°å‡½æ•°æç¤ºç¤ºä¾‹ä¿å­˜åœ¨./functions/untested functions/%s/%s_prompt.jsonæ–‡ä»¶ä¸­&#x27;</span> % (function_name, function_name))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%så‡½æ•°å·²åœ¨å½“å‰æ“ä½œç©ºé—´å®šä¹‰ï¼Œå¯ä»¥è¿›è¡Œæ•ˆæœæµ‹è¯•&quot;</span> % function_name)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> function_name</span><br></pre></td></tr></table></figure><h4 id="3-3-4-2-æ„å»ºè‡ªåŠ¨Debugçš„å‡½æ•°"><a href="#3-3-4-2-æ„å»ºè‡ªåŠ¨Debugçš„å‡½æ•°" class="headerlink" title="3.3.4.2 æ„å»ºè‡ªåŠ¨Debugçš„å‡½æ•°"></a>3.3.4.2 æ„å»ºè‡ªåŠ¨Debugçš„å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">function_test</span>(<span class="params">function_name, req, few_shot, model=<span class="string">&quot;glm-4&quot;</span>, g=<span class="built_in">globals</span>(<span class="params"></span>)</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_messages</span>(<span class="params">ueser_content</span>):</span><br><span class="line">        messages = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: data_content&#125;,</span><br><span class="line">                     &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æˆ‘çš„é‚®ç®±å·å«me&quot;</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: ueser_content&#125;]</span><br><span class="line">        <span class="keyword">return</span> messages</span><br><span class="line">            </span><br><span class="line">    messages = test_messages(req)</span><br><span class="line">    </span><br><span class="line">    new_function = <span class="built_in">globals</span>()[function_name]</span><br><span class="line">    functions_list = [new_function]</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ ¹æ®æ—¢å®šç”¨æˆ·éœ€æ±‚reqè¿›è¡Œ%så‡½æ•°åŠŸèƒ½æµ‹è¯•ï¼Œè¯·ç¡®ä¿å½“è¯¥å‡½æ•°å·²ç»åœ¨å½“å‰æ“ä½œç©ºé—´å®šä¹‰...&quot;</span> % function_name)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æœ‰å¯èƒ½åœ¨run_conversationç¯èŠ‚æŠ¥é”™</span></span><br><span class="line">    <span class="comment"># è‹¥æ²¡æŠ¥é”™ï¼Œåˆ™è¿è¡Œï¼š</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">## ç›´æ¥è°ƒç”¨çœ‹å½“å‰å‡½æ•°ç»™å‡ºæ¥çš„ç»“æœæ˜¯å¦æ­£ç¡®</span></span><br><span class="line">        <span class="comment">## æœ‰ä¸¤ç§å¯èƒ½ï¼š1ï¼Œä»£ç èƒ½è¿è¡Œ 2. ä»£ç ä¸èƒ½è¿è¡Œ</span></span><br><span class="line">        final_response = run_conversation(messages=messages, functions_list=functions_list, model=model)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å½“å‰å‡½æ•°è¿è¡Œç»“æœï¼š&#x27;%s&#x27;&quot;</span> % final_response)</span><br><span class="line">        <span class="comment">## å¦‚æœä»£ç èƒ½è¿è¡Œçœ‹ä¸€ä¸‹æ˜¯å¦èƒ½æ»¡è¶³éœ€æ±‚</span></span><br><span class="line">        feedback = <span class="built_in">input</span>(<span class="string">&quot;å‡½æ•°åŠŸèƒ½æ˜¯å¦æ»¡è¶³è¦æ±‚ (yes/no)? &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> feedback.lower() == <span class="string">&#x27;yes&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å‡½æ•°åŠŸèƒ½é€šè¿‡æµ‹è¯•ï¼Œæ­£åœ¨å°†å‡½æ•°å†™å…¥testedæ–‡ä»¶å¤¹&quot;</span>)</span><br><span class="line">            <span class="comment">## å¦‚æœæ»¡è¶³å°±é€šè¿‡æµ‹è¯•</span></span><br><span class="line">            remove_to_tested(function_name)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;done&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment">## å¦‚æœä¸æ»¡è¶³éœ€æ±‚</span></span><br><span class="line">            next_step = <span class="built_in">input</span>(<span class="string">&quot;å‡½æ•°åŠŸèƒ½æœªé€šè¿‡æµ‹è¯•ï¼Œæ˜¯1.éœ€è¦å†æ¬¡è¿›è¡Œæµ‹è¯•ï¼Œè¿˜æ˜¯2.è¿›å…¥debugæµç¨‹ï¼Ÿ&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> next_step == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å‡†å¤‡å†æ¬¡æµ‹è¯•...&quot;</span>)</span><br><span class="line">                <span class="comment">## å†æ¬¡è¿è¡Œ</span></span><br><span class="line">                function_test(function_name, req, few_shot)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment">## è¿›è¡ŒDebugï¼Œé€‰æ‹©æ–¹æ¡ˆ</span></span><br><span class="line">                solution = <span class="built_in">input</span>(<span class="string">&quot;è¯·é€‰æ‹©debugæ–¹æ¡ˆï¼š\n1.å†æ¬¡æ‰§è¡Œå‡½æ•°åˆ›å»ºæµç¨‹ï¼Œå¹¶æµ‹è¯•ç»“æœï¼›\n2.æ‰§è¡Œå®¡æŸ¥å‡½æ•°\</span></span><br><span class="line"><span class="string">                \n3.é‡æ–°è¾“å…¥ç”¨æˆ·éœ€æ±‚ï¼›\n4.é€€å‡ºç¨‹åºï¼Œè¿›è¡Œæ‰‹åŠ¨å°è¯•&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> solution == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    <span class="comment"># å†æ¬¡è¿è¡Œå‡½æ•°åˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;å¥½çš„ï¼Œæ­£åœ¨å°è¯•å†æ¬¡åˆ›å»ºå‡½æ•°ï¼Œè¯·ç¨ç­‰...&quot;</span>)</span><br><span class="line">                    few_shot_str = <span class="built_in">input</span>(<span class="string">&quot;å‡†å¤‡å†æ¬¡æµ‹è¯•ï¼Œè¯·é—®æ˜¯1.é‡‡ç”¨æ­¤å‰Few-shotæ–¹æ¡ˆï¼Œè¿˜æ˜¯2.å¸¦å…¥å…¨éƒ¨å‡½æ•°ç¤ºä¾‹è¿›è¡ŒFew-shotï¼Ÿ&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> few_shot_str == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                        function_name = code_generate(req=req, few_shot=few_shot, model=model, g=g)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        function_name = code_generate(req=req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=model, g=g)</span><br><span class="line">                    <span class="comment">## æ„å»ºå®Œäº†ä»¥åç»§ç»­è¿è¡Œ</span></span><br><span class="line">                    function_test(function_name=function_name, req=req, few_shot=few_shot, g=g)</span><br><span class="line">                <span class="keyword">elif</span> solution == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                    <span class="comment"># æ‰§è¡Œå®¡æŸ¥å‡½æ•°</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;å¥½çš„ï¼Œæ‰§è¡Œå®¡æŸ¥å‡½æ•°ï¼Œè¯·ç¨ç­‰...&quot;</span>)</span><br><span class="line">                    function_name = prompt_modified(function_name=function_name, model=<span class="string">&quot;gpt-3.5-turbo-16k-0613&quot;</span>, g=g)</span><br><span class="line">                    <span class="comment"># æ¥ä¸‹æ¥å¸¦å…¥è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;æ–°å‡½æ•°å·²åˆ›å»ºï¼Œæ¥ä¸‹æ¥å¸¦å…¥è¿›è¡Œæµ‹è¯•...&quot;</span>)</span><br><span class="line">                    function_test(function_name=function_name, req=req, few_shot=few_shot, g=g)</span><br><span class="line">                <span class="keyword">elif</span> solution == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                    <span class="comment">## ç”¨æˆ·é‡æ–°è¾“å…¥éœ€æ±‚ï¼Œä¹Ÿå°±æ„å‘³ç€é‡æ–°</span></span><br><span class="line">                    new_req = <span class="built_in">input</span>(<span class="string">&quot;å¥½çš„ï¼Œè¯·å†æ¬¡è¾“å…¥ç”¨æˆ·éœ€æ±‚ï¼Œè¯·æ³¨æ„ï¼Œç”¨æˆ·éœ€æ±‚æè¿°æ–¹æ³•å°†æå¤§ç¨‹åº¦å½±å“æœ€ç»ˆå‡½æ•°åˆ›å»ºç»“æœã€‚&quot;</span>)</span><br><span class="line">                    few_shot_str = <span class="built_in">input</span>(<span class="string">&quot;æ¥ä¸‹æ¥å¦‚ä½•è¿è¡Œä»£ç åˆ›å»ºå‡½æ•°ï¼Ÿ1.é‡‡ç”¨æ­¤å‰Few-shotæ–¹æ¡ˆï¼›\n2.ä½¿ç”¨å…¨éƒ¨å¤–éƒ¨å‡½æ•°ä½œä¸ºFew-shot&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> few_shot_str == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                        function_name = code_generate(req=new_req, few_shot=few_shot, model=model, g=g)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        function_name = code_generate(req=new_req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=model, g=g)</span><br><span class="line">                    function_test(function_name=function_name, req=new_req, few_shot=few_shot, g=g)</span><br><span class="line">                <span class="keyword">elif</span> solution == <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;åŠ æ²¹~&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># run_conversationæŠ¥é”™æ—¶åˆ™è¿è¡Œï¼š</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        next_step = <span class="built_in">input</span>(<span class="string">&quot;run_conversationæ— æ³•æ­£å¸¸è¿è¡Œï¼Œæ¥ä¸‹æ¥æ˜¯1.å†æ¬¡è¿è¡Œè¿è¡Œrun_conversationï¼Œè¿˜æ˜¯2.è¿›å…¥debugæµç¨‹ï¼Ÿ&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> next_step == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            function_test(function_name, req, few_shot)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            solution = <span class="built_in">input</span>(<span class="string">&quot;è¯·é€‰æ‹©debugæ–¹æ¡ˆï¼š\n1.å†æ¬¡æ‰§è¡Œå‡½æ•°åˆ›å»ºæµç¨‹ï¼Œå¹¶æµ‹è¯•ç»“æœï¼›\n2.æ‰§è¡Œå®¡æŸ¥å‡½æ•°\</span></span><br><span class="line"><span class="string">            \n3.é‡æ–°è¾“å…¥ç”¨æˆ·éœ€æ±‚ï¼›\n4.é€€å‡ºç¨‹åºï¼Œè¿›è¡Œæ‰‹åŠ¨å°è¯•&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> solution == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                <span class="comment"># å†æ¬¡è¿è¡Œå‡½æ•°åˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å¥½çš„ï¼Œæ­£åœ¨å°è¯•å†æ¬¡åˆ›å»ºå‡½æ•°ï¼Œè¯·ç¨ç­‰...&quot;</span>)</span><br><span class="line">                few_shot_str = <span class="built_in">input</span>(<span class="string">&quot;å‡†å¤‡å†æ¬¡æµ‹è¯•ï¼Œè¯·é—®æ˜¯1.é‡‡ç”¨æ­¤å‰Few-shotæ–¹æ¡ˆï¼Œè¿˜æ˜¯2.å¸¦å…¥å…¨éƒ¨å‡½æ•°ç¤ºä¾‹è¿›è¡ŒFew-shotï¼Ÿ&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> few_shot_str == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    function_name = code_generate(req=req, few_shot=few_shot, model=model, g=g)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    function_name = code_generate(req=req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=model, g=g)</span><br><span class="line">                function_test(function_name=function_name, req=req, few_shot=few_shot, g=g)</span><br><span class="line">            <span class="keyword">elif</span> solution == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                <span class="comment"># æ‰§è¡Œå®¡æŸ¥å‡½æ•°</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å¥½çš„ï¼Œæ‰§è¡Œå®¡æŸ¥å‡½æ•°ï¼Œè¯·ç¨ç­‰...&quot;</span>)</span><br><span class="line">                max_attempts = <span class="number">3</span></span><br><span class="line">                attempts = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> attempts &lt; max_attempts:</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        function_name = prompt_modified(function_name=function_name, model=<span class="string">&quot;gpt-3.5-turbo-16k-0613&quot;</span>, g=g)</span><br><span class="line">                        <span class="keyword">break</span>  <span class="comment"># å¦‚æœä»£ç æˆåŠŸæ‰§è¡Œï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">                    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                        attempts += <span class="number">1</span>  <span class="comment"># å¢åŠ å°è¯•æ¬¡æ•°</span></span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;å‘ç”Ÿé”™è¯¯ï¼š&quot;</span>, e)</span><br><span class="line">                        <span class="keyword">if</span> attempts == max_attempts:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;å·²è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œç¨‹åºç»ˆæ­¢ã€‚&quot;</span>)</span><br><span class="line">                            <span class="keyword">raise</span>  <span class="comment"># é‡æ–°å¼•å‘æœ€åä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨é‡æ–°è¿è¡Œå®¡æŸ¥ç¨‹åº...&quot;</span>)</span><br><span class="line">                <span class="comment"># æ¥ä¸‹æ¥å¸¦å…¥è¿›è¡Œæµ‹è¯•</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ–°å‡½æ•°å·²åˆ›å»ºï¼Œæ¥ä¸‹æ¥å¸¦å…¥è¿›è¡Œæµ‹è¯•...&quot;</span>)</span><br><span class="line">                function_test(function_name=function_name, req=req, few_shot=few_shot, g=g)</span><br><span class="line">            <span class="keyword">elif</span> solution == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">                new_req = <span class="built_in">input</span>(<span class="string">&quot;å¥½çš„ï¼Œè¯·å†æ¬¡è¾“å…¥ç”¨æˆ·éœ€æ±‚ï¼Œè¯·æ³¨æ„ï¼Œç”¨æˆ·éœ€æ±‚æè¿°æ–¹æ³•å°†æå¤§ç¨‹åº¦å½±å“æœ€ç»ˆå‡½æ•°åˆ›å»ºç»“æœã€‚&quot;</span>)</span><br><span class="line">                few_shot_str = <span class="built_in">input</span>(<span class="string">&quot;æ¥ä¸‹æ¥å¦‚ä½•è¿è¡Œä»£ç åˆ›å»ºå‡½æ•°ï¼Ÿ1.é‡‡ç”¨æ­¤å‰Few-shotæ–¹æ¡ˆï¼›\n2.ä½¿ç”¨å…¨éƒ¨å¤–éƒ¨å‡½æ•°ä½œä¸ºFew-shot&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> few_shot_str == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    function_name = code_generate(req=new_req, few_shot=few_shot, model=model, g=g)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    function_name = code_generate(req=new_req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=model, g=g)</span><br><span class="line">                function_test(function_name=function_name, req=new_req, few_shot=few_shot, g=g)</span><br><span class="line">            <span class="keyword">elif</span> solution == <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;åŠ æ²¹~&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="3-2-4-3-å…¨è‡ªåŠ¨æµç¨‹ä»£ç ç¼–å†™"><a href="#3-2-4-3-å…¨è‡ªåŠ¨æµç¨‹ä»£ç ç¼–å†™" class="headerlink" title="3.2.4.3 å…¨è‡ªåŠ¨æµç¨‹ä»£ç ç¼–å†™"></a>3.2.4.3 å…¨è‡ªåŠ¨æµç¨‹ä»£ç ç¼–å†™</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">req_auto_func</span>(<span class="params">req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=<span class="string">&#x27;glm-4&#x27;</span>, g=<span class="built_in">globals</span>(<span class="params"></span>), detail=<span class="number">0</span></span>):</span><br><span class="line">    function_name = code_generate(req, few_shot=few_shot, model=model, g=g, detail=detail)</span><br><span class="line">    function_test(function_name=function_name, req=req, few_shot=few_shot, model=model, g=g)</span><br></pre></td></tr></table></figure><h3 id="3-2-5-å¤§æ¨¡å‹ç¼–ç¨‹çš„ç“¶é¢ˆ"><a href="#3-2-5-å¤§æ¨¡å‹ç¼–ç¨‹çš„ç“¶é¢ˆ" class="headerlink" title="3.2.5 å¤§æ¨¡å‹ç¼–ç¨‹çš„ç“¶é¢ˆ"></a>3.2.5 å¤§æ¨¡å‹ç¼–ç¨‹çš„ç“¶é¢ˆ</h3><h4 id="3-2-5-1-ç¼–ç¨‹æ€§èƒ½ç“¶é¢ˆçš„æ ¹æº"><a href="#3-2-5-1-ç¼–ç¨‹æ€§èƒ½ç“¶é¢ˆçš„æ ¹æº" class="headerlink" title="3.2.5.1 ç¼–ç¨‹æ€§èƒ½ç“¶é¢ˆçš„æ ¹æº"></a>3.2.5.1 ç¼–ç¨‹æ€§èƒ½ç“¶é¢ˆçš„æ ¹æº</h4><p>å¤§æ¨¡å‹åœ¨å¤æ‚é—®é¢˜ä¸Šçš„ç¼–ç¨‹èƒ½åŠ›ä¸è¶³ï¼Œä¸»è¦æºäºç¼ºä¹â€œé•¿æœŸè®°å¿†â€ï¼Œæ— æ³•æŒç»­å›´ç»•ç›®æ ‡ç”Ÿæˆé•¿ä»£ç å—ã€‚ä»£ç ç¼–å†™æœ¬è´¨ä¸Šæ˜¯æŒ‰ç‰¹å®šæ ¼å¼åˆ›ä½œæ–‡æœ¬ï¼Œå› æ­¤å¤§æ¨¡å‹åœ¨é•¿æ–‡æœ¬åˆ›ä½œèƒ½åŠ›ä¸è¶³æ—¶ï¼Œé•¿ä»£ç ç¼–å†™ä¹Ÿä¼šå—åˆ°é™åˆ¶ï¼Œå¯¼è‡´å¤æ‚éœ€æ±‚å®ç°çš„å‡†ç¡®æ€§ä¸‹é™ã€‚</p><h4 id="3-2-5-2-æå‡é•¿ä»£ç ç¼–å†™ç¨³å®šæ€§çš„ç­–ç•¥"><a href="#3-2-5-2-æå‡é•¿ä»£ç ç¼–å†™ç¨³å®šæ€§çš„ç­–ç•¥" class="headerlink" title="3.2.5.2 æå‡é•¿ä»£ç ç¼–å†™ç¨³å®šæ€§çš„ç­–ç•¥"></a>3.2.5.2 æå‡é•¿ä»£ç ç¼–å†™ç¨³å®šæ€§çš„ç­–ç•¥</h4><p>æ ¸å¿ƒé—®é¢˜åœ¨äºå¤§æ¨¡å‹ç¼–å†™é•¿ä»£ç èƒ½åŠ›ä¸è¶³ï¼Œè€Œéç†è§£éœ€æ±‚èƒ½åŠ›ä¸è¶³ã€‚å› æ­¤ï¼Œå…³é”®åœ¨äºæé«˜æ¨¡å‹çš„ç¼–ç¨‹èƒ½åŠ›ï¼Œè€Œä¸æ˜¯è¿›ä¸€æ­¥ä¼˜åŒ–æç¤ºå·¥ç¨‹ã€‚æœ€ç›´æ¥æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ â€œåˆ—æçº²-åˆ†æ®µç¼–å†™-åˆå¹¶â€ï¼Œé€šè¿‡åˆ†æ®µå®Œæˆæå‡ä»£ç ç¨³å®šæ€§ã€‚éœ€è¦æ³¨æ„ä»£ç è¡”æ¥ã€å˜é‡ä¸€è‡´æ€§ä»¥åŠå……åˆ†åˆ©ç”¨å·²æœ‰è¾…åŠ©å‡½æ•°æé«˜å¼€å‘æ•ˆç‡ã€‚</p><ol><li>ç¬¬ä¸€é˜¶æ®µï¼šå¤æ‚éœ€æ±‚æ‹†è§£</li></ol><p>å°†å¤æ‚éœ€æ±‚æ‹†è§£ä¸ºç®€å•ã€ç¡®å®šæ€§çš„å­ä»»åŠ¡ï¼Œç±»ä¼¼CoTï¼ˆæ€ç»´é“¾ï¼‰æ–¹å¼é€æ­¥å®Œæˆã€‚æ‹†åˆ†åçš„å­ä»»åŠ¡éœ€å…·å¤‡æ˜ç¡®åŠŸèƒ½ï¼Œå¦‚â€œæŸ¥æ‰¾é‚®ä»¶â€â€œç»™é‚®ä»¶æ‰“æ ‡ç­¾â€ç­‰æœ€å°åŠŸèƒ½å•ä½ã€‚ä¸ºç¡®ä¿æ‹†åˆ†å‡†ç¡®æ€§ï¼Œå¯æä¾›é¡¹ç›®èƒŒæ™¯ä¿¡æ¯åŠç¤ºä¾‹ä½œä¸ºFew-shotæç¤ºï¼Œä¹Ÿå¯è®©å¤§æ¨¡å‹è‡ªè¡Œç”Ÿæˆæ‹†è§£ç¤ºä¾‹ã€‚å­ä»»åŠ¡éœ€ç®€å•æ˜“å®ç°ï¼Œç¡®ä¿ä»£ç ç¼–å†™å‡†ç¡®æ€§ã€‚</p><ol start="2"><li>ç¬¬äºŒé˜¶æ®µï¼šä»£ç ç¼–å†™ä¸æ•´åˆ</li></ol><p>å®Œæˆå­ä»»åŠ¡æ‹†è§£åï¼Œè¿›å…¥ä»£ç ç¼–å†™ä¸æ•´åˆé˜¶æ®µã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§æ–¹æ¡ˆï¼š</p><p>æ–¹æ¡ˆä¸€ï¼šé«˜å±‚å‡½æ•°ç»„åˆ</p><ul><li>æ€è·¯ï¼šåˆ›å»ºåŸºç¡€åŠŸèƒ½å‡½æ•°ï¼Œç¼–å†™é«˜å±‚å‡½æ•°æ•´åˆåŸºç¡€å‡½æ•°è¾“å‡ºï¼Œå®Œæˆå¤æ‚éœ€æ±‚ã€‚</li><li>ä¼˜åŠ¿ï¼šä¾¿äºç®¡ç†ã€ä»£ç åˆ©ç”¨ç‡é«˜ï¼Œå¯é‡å¤ä½¿ç”¨å·²æœ‰å‡½æ•°ã€‚</li><li>åŠ£åŠ¿ï¼šå¤§æ¨¡å‹éš¾ä»¥å‡†ç¡®è¡”æ¥å‡½æ•°è¾“å‡ºè¾“å…¥æ ¼å¼ï¼Œå®¹æ˜“å¯¼è‡´è¿è¡Œå¤±è´¥ã€‚</li></ul><p>æ–¹æ¡ˆäºŒï¼šåµŒå¥—å‡½æ•°</p><ul><li>æ€è·¯ï¼šåˆ›å»ºåµŒå¥—å‡½æ•°ï¼Œå°†å­ä»»åŠ¡å‡½æ•°åµŒå…¥ä¸»å‡½æ•°å†…ï¼Œç¡®ä¿è¾“å‡ºè¾“å…¥ä¸€è‡´ã€‚</li><li>ä¼˜åŠ¿ï¼šå‡å°‘å‡½æ•°è¡”æ¥é—®é¢˜ï¼Œæé«˜ä»£ç å‡†ç¡®æ€§ã€‚</li><li>åŠ£åŠ¿ï¼šéœ€å¤šæ¬¡æç¤ºå¤§æ¨¡å‹è°ƒæ•´ä»£ç é€»è¾‘ï¼Œæµç¨‹å¤æ‚ï¼Œæ•ˆç‡è¾ƒä½ã€‚</li></ul><p>æ–¹æ¡ˆä¸‰ï¼šåˆ†åˆ«åˆ›å»ºå‡½æ•°å†ç»Ÿä¸€ä»£ç ï¼ˆæ¨èæ–¹æ¡ˆï¼‰</p><ul><li>æ€è·¯ï¼š<ol><li>æ‹†åˆ†å­ä»»åŠ¡ï¼Œåˆ†åˆ«åˆ›å»ºå‡½æ•°1ã€å‡½æ•°2ï¼Œç¡®ä¿å•ç‹¬è¿è¡Œæ— è¯¯ã€‚</li><li>æä¾›å‡½æ•°1ã€2æºç ä½œä¸ºå¤§æ¨¡å‹æç¤ºï¼Œé‡æ–°ç¼–å†™æ»¡è¶³åŸå§‹éœ€æ±‚çš„å®Œæ•´å‡½æ•°ã€‚</li></ol></li><li>ä¼˜åŠ¿ï¼š<ul><li>åˆ©ç”¨å¤§æ¨¡å‹ä»£ç ç”Ÿæˆä¸è‡ªæˆ‘å®¡æŸ¥èƒ½åŠ›ï¼Œæé«˜å¤æ‚éœ€æ±‚ä»£ç å‡†ç¡®æ€§ã€‚</li><li>å‡½æ•°1ã€2æ— éœ€å®Œç¾è¡”æ¥ï¼Œæœ€ç»ˆå‡½æ•°å‚è€ƒå…¶ä»£ç é€»è¾‘é‡æ–°ç”Ÿæˆå®Œæ•´å®ç°ã€‚</li><li>é«˜åº¦å¤ç”¨å·²æœ‰å‡½æ•°ç”Ÿæˆä¸æµ‹è¯•æµç¨‹ï¼Œå¼€å‘æ•ˆç‡æ˜¾è‘—æå‡ã€‚</li></ul></li></ul><h3 id="3-2-6å¤æ‚ä»»åŠ¡çš„ç¼–ç¨‹è½åœ°"><a href="#3-2-6å¤æ‚ä»»åŠ¡çš„ç¼–ç¨‹è½åœ°" class="headerlink" title="3.2.6å¤æ‚ä»»åŠ¡çš„ç¼–ç¨‹è½åœ°"></a>3.2.6å¤æ‚ä»»åŠ¡çš„ç¼–ç¨‹è½åœ°</h3><h4 id="3-2-6-1-å¤æ‚éœ€æ±‚æ‹†è§£"><a href="#3-2-6-1-å¤æ‚éœ€æ±‚æ‹†è§£" class="headerlink" title="3.2.6.1 å¤æ‚éœ€æ±‚æ‹†è§£"></a>3.2.6.1 å¤æ‚éœ€æ±‚æ‹†è§£</h4><p>&emsp;&emsp;é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªä¸“é—¨ç”¨äºå¤æ‚é—®é¢˜æ‹†è§£çš„æ¨¡å‹ã€‚æ ¹æ®æ­¤å‰çš„åˆ†æï¼Œè¯¥æ¨¡å‹åŒæ—¶éœ€è¦å¤–éƒ¨æŒ‚è½½æ–‡æ¡£ä»¥è¯´æ˜é¡¹ç›®èƒŒæ™¯å’Œå¤æ‚ä»»åŠ¡æ‹†è§£çš„ç›®çš„ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸€äº›å¤æ‚ä»»åŠ¡æ‹†è§£çš„ç¤ºä¾‹ä½œä¸ºFew-shotã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./data/å¤æ‚ä»»åŠ¡æ‹†è§£.md&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    md_content_plus = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(md_content_plus)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ä»€ä¹ˆæ˜¯é‚®ç®±é¡¹ç›®ï¼Ÿé‚®ä»¶é¡¹ç›®æœ¬èº«ç”±ä¸€ç³»åˆ—çš„ç¨‹åºç»„æˆï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯æ ¹æ®ç”¨æˆ·è‡ªç„¶è¯­è¨€æè¿°è¿›è¡Œç›¸åº”çš„é‚®ç®±æ“ä½œï¼Œå¦‚æŸ¥é˜…é‚®ä»¶ã€æ”¶å‘é‚®ä»¶ç­‰ã€‚è¯¥åœºæ™¯æ˜¯æˆ‘ä»¬è‡ªå·±æ„å»ºçš„ä¸€ä¸ªåœºæ™¯ã€‚</span><br><span class="line">ä¸»è¦å®ç°çš„æ˜¯å¯¹æˆ‘ä»¬my_mailæ•°æ®åº“é‡Œçš„æ•°æ®è¿›è¡Œå¢åˆ æŸ¥æ”¹ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>ä»€ä¹ˆæ˜¯ä»»åŠ¡æ‹†è§£ï¼Ÿåœ¨é‚®ç®±é¡¹ç›®ä¸­ï¼Œä»»åŠ¡æ‹†è§£æŒ‡çš„æ˜¯å°†ç”¨æˆ·éœ€æ±‚æ‹†è§£ä¸ºè‹¥å¹²ä¸ªæœ€å°å­ä»»åŠ¡çš„è¿‡ç¨‹ï¼Œä»»åŠ¡æ‹†è§£çš„ç›®æ ‡æ˜¯ä¸ºäº†é™ä½å®Œæˆå¤æ‚ä»»åŠ¡çš„éš¾åº¦ã€‚ä¾‹å¦‚ä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªå¤æ‚ä»»åŠ¡æ‹†è§£è¿‡ç¨‹ï¼ŒåŸå§‹ç”¨æˆ·éœ€æ±‚ä¸ºQï¼šâ€œè¯·å¸®æˆ‘æŸ¥ä¸‹è¥¿é—¨å¹é›ªç»™æˆ‘å‘é€äº†å“ªäº›é‚®ä»¶ï¼Œå¹¶å¯¹è¿™äº›é‚®ä»¶å†…å®¹è¿›è¡Œæ€»ç»“â€ï¼Œè¯¥éœ€æ±‚å¯ä»¥æ‹†åˆ†ä¸ºä¸¤ä¸ªæœ€å°å­ä»»åŠ¡ï¼Œåˆ†åˆ«æ˜¯A:â€œ<span class="number">1.</span>æŸ¥æ‰¾æˆ‘å’Œè¥¿é—¨å¹é›ªä¹‹é—´é€šä¿¡çš„é‚®ä»¶åˆ—è¡¨â€ï¼Œâ€œ<span class="number">2.</span>æ ¹æ®æŸä»½é‚®ä»¶åˆ—è¡¨ï¼Œå¯¹è¿™äº›é‚®ä»¶çš„ä¸»è¦å†…å®¹è¿›è¡Œæ€»ç»“â€ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>ä»€ä¹ˆæ˜¯æœ€å°å­ä»»åŠ¡ï¼Ÿæœ€å°å­ä»»åŠ¡æŒ‡çš„æ˜¯åœ¨åœ¨é‚®ç®±é¡¹ç›®ä¸­ï¼Œåœ¨è¿›è¡Œå¤æ‚ä»»åŠ¡æ‹†è§£æ—¶æ‹†è§£å¾—åˆ°çš„æœ€å°ä»»åŠ¡å•å…ƒã€‚ä¾‹å¦‚è·å–æˆ‘å’Œè¥¿é—¨å¹é›ªä¹‹é—´çš„é€šä¿¡åˆ—è¡¨ã€å›´ç»•æŸäº›é‚®ä»¶è¿›è¡Œå†…å®¹æ€»ç»“ï¼Œå°±å±äºæœ€å°å­ä»»åŠ¡ã€‚æœ€å°å­ä»»åŠ¡ä¸å¯å†è¿›è¡Œä»»åŠ¡æ‹†è§£ï¼Œå¹¶ä¸”æœ€å°å­ä»»åŠ¡å¾€å¾€éƒ½æ˜¯è¾ƒä¸ºç®€å•çš„ä»»åŠ¡ï¼Œæ˜¯ä¸€äº›å¯ä»¥å¿«é€Ÿçš„å®ç°çš„åŠŸèƒ½ï¼›</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>è‹¥ä¸€ä¸ªä»»åŠ¡æ‹†è§£æˆäº†å¤šä¸ªæœ€å°å­ä»»åŠ¡ï¼Œé‚£ä¹ˆè¯·æ³¨æ„è¿™å¤šä¸ªæœ€å°å­ä»»åŠ¡çš„ä»»åŠ¡é¡ºåºï¼Œä¾‹å¦‚æ­¤å‰çš„ä¾‹å­ä¸­ï¼ŒæŸ¥æ‰¾é‚®ä»¶åˆ—è¡¨å°±åº”è¯¥å‘ç”Ÿåœ¨å¯¹é‚®ä»¶å†…å®¹è¿›è¡Œæ€»ç»“ä¹‹å‰ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>ä½ æ˜¯ä¸€åä»»åŠ¡æ‹†è§£åŠ©æ‰‹ï¼Œè´Ÿè´£é‚®ä»¶é¡¹ç›®ä¸­ç”¨æˆ·éœ€æ±‚æ‹†è§£ã€‚å½“ä¸€ä¸ªç”¨æˆ·éœ€æ±‚å¯ä»¥æ‹†è§£ä¸ºå¤šä¸ªæœ€å°å­ä»»åŠ¡æ—¶ï¼Œè¯·å¯¹å…¶è¿›è¡Œæœ€å°å­ä»»åŠ¡çš„æ‹†è§£ï¼›è€Œå½“ä¸€ä¸ªç”¨æˆ·éœ€æ±‚æœ¬èº«å°±æ˜¯ä¸€ä¸ªæœ€å°å­ä»»åŠ¡æ—¶ï¼Œåˆ™æ— éœ€å¯¹å…¶è¿›è¡Œæ‹†è§£ã€‚</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;æ¥ä¸‹æ¥ç»§ç»­åˆ›å»ºFew-shotçš„æç¤ºç¤ºä¾‹ã€‚è¿™é‡Œæ€»å…±ç¼–å†™äº†å››ç»„éš¾åº¦å’Œå¤æ‚åº¦å„ä¸ç›¸åŒçš„å››ä¸ªéœ€æ±‚è¿›è¡Œæ‹†è§£ï¼Œå…·ä½“æç¤ºç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example1_user = <span class="string">&#x27;Q:è¯·å¸®æˆ‘æŸ¥ä¸‹è¥¿é—¨å¹é›ªç»™æˆ‘å‘é€äº†å“ªäº›é‚®ä»¶ï¼Œå¹¶å¯¹è¿™äº›é‚®ä»¶å†…å®¹è¿›è¡Œæ€»ç»“ã€‚&#x27;</span></span><br><span class="line">example1_assistent = <span class="string">&#x27;A:1.è¯·å¸®æˆ‘æ•´ç†è¥¿é—¨å¹é›ªå‘ç»™æˆ‘çš„é‚®ä»¶åˆ—è¡¨ã€‚2.å¯¹æŸäº›ç»™å®šçš„é‚®ä»¶è¿›è¡Œé‚®ä»¶å†…å®¹æ€»ç»“ã€‚&#x27;</span></span><br><span class="line"></span><br><span class="line">example2_user = <span class="string">&#x27;Q:è¯·å¸®æˆ‘æŸ¥ä¸‹æœ€è¿‘ä¸€å°æœªè¯»é‚®ä»¶çš„å‘ä»¶äººã€‚&#x27;</span></span><br><span class="line">example2_assistent = <span class="string">&#x27;A:1.è¯·å¸®æˆ‘æŸ¥ä¸‹æœ€è¿‘ä¸€å°æœªè¯»é‚®ä»¶çš„å‘ä»¶äººã€‚&#x27;</span></span><br><span class="line"></span><br><span class="line">example3_user = <span class="string">&#x27;Q:è¯·åˆ†ææˆ‘é‚®ç®±é‡Œå…¨éƒ¨å·²æ”¶åˆ°çš„é‚®ä»¶ï¼Œå‘Šè¯‰æˆ‘æœ€å¸¸è”ç³»çš„äººã€‚&#x27;</span></span><br><span class="line">example3_assistent = <span class="string">&#x27;A:1.è¯·å¸®æˆ‘æ•´ç†é‚®ç®±é‡Œå…¨éƒ¨å·²æ”¶åˆ°é‚®ä»¶çš„é‚®ä»¶åˆ—è¡¨ã€‚2.æ ¹æ®æŸä»½é‚®ä»¶åˆ—è¡¨ï¼Œåˆ†æå¹¶æ‰¾å‡ºæœ€å¸¸è”ç³»çš„äººã€‚&#x27;</span></span><br><span class="line"></span><br><span class="line">example4_user = <span class="string">&#x27;Q:è¯·åœ¨æˆ‘é‚®ç®±é‡ŒæŸ¥æ‰¾6æœˆ5å·åˆ°6å·çš„æœªè¯»é‚®ä»¶ï¼Œå¹¶æ‰¾å‡ºå·¥ä½œç›¸å…³çš„æœªè¯»é‚®ä»¶ï¼Œè¯·ä¾æ¬¡ç»™è¿™äº›æœªè¯»é‚®ä»¶å›å¤è¯´æˆ‘æ­£åœ¨ä¼‘å‡ï¼ŒåŒæ—¶è¯·å°†è¿™äº›é‚®ä»¶è½¬å‘ç»™æˆ‘çš„åŠ©ç†è¥¿é—¨å¹é›ªã€‚&#x27;</span></span><br><span class="line">example4_assistent = <span class="string">&#x27;A:1.è¯·æŸ¥æ‰¾å¹¶æ•´ç†æˆ‘é‚®ç®±é‡Œ6æœˆ5å·åˆ°6å·çš„æœªè¯»é‚®ä»¶åˆ—è¡¨ã€‚2.æ ¹æ®æŸä»½é‚®ä»¶åˆ—è¡¨ï¼ŒæŸ¥æ‰¾å¹¶æ±‡æ€»å…¶ä¸­å’Œå·¥ä½œæœ‰å…³çš„åˆ—è¡¨ã€‚3.æ ¹æ®æŸä»½é‚®ä»¶åˆ—è¡¨ï¼Œå¯¹å…¶é€ä¸€è¿›è¡Œå›å¤ï¼Œå‘Šè¯‰ä»–ä»¬æˆ‘æ­£åœ¨ä¼‘å‡ã€‚4.æ ¹æ®æŸä»½é‚®ä»¶åˆ—è¡¨ï¼Œå°†å…¶é€ä¸€è½¬å‘ç»™æˆ‘çš„åŠ©ç†è¥¿é—¨å¹é›ªã€‚&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬ç»Ÿä¸€é€šè¿‡Q&amp;Açš„æ–¹å¼æ¥æç¤ºæ¨¡å‹ä¸åŒå†…å®¹çš„ç±»å‹ï¼ŒåŒæ—¶æ‹†è§£ä¹‹åçš„æ¯æ®µæ–‡å­—ä¹Ÿéƒ½ä»¥å¥å·ç»“å°¾ï¼Œæ–¹ä¾¿åç»­è¿›è¡Œç»“æ„åŒ–å­—ç¬¦ä¸²æå–ã€‚åœ¨åˆ›å»ºçš„å››ä¸ªæç¤ºå®åŠ›ä¸­ï¼Œ1ã€3ç¤ºä¾‹å±äºä¸€èˆ¬ç¤ºä¾‹ï¼Œå¯¹äºå¤§å¤šæ•°å¤æ‚éœ€æ±‚æ¥è¯´ï¼Œæ‹†è§£ä¸ºä¸¤ä¸ªå­ä»»åŠ¡åŸºæœ¬å°±åŸºæœ¬èƒ½å¤Ÿæ„æˆè¾ƒå¥½çš„è‡ªç„¶è¯­è¨€ç¼–ç¨‹å¼•å¯¼ï¼Œè€Œç¬¬äºŒä¸ªæç¤ºç¤ºä¾‹åˆ™æ˜¯æé†’æ¨¡å‹ï¼Œå½“éœ€æ±‚è¾ƒä¸ºç®€å•æ—¶ï¼Œä¸ç”¨è¿›è¡Œéœ€æ±‚æ‹†è§£ï¼›è€Œæœ€åä¸€ä¸ªæç¤ºçš„ç¤ºä¾‹ï¼Œåˆ™æ˜¯ä¸€ä¸ªç›¸å¯¹æ¥è¯´éå¸¸å¤æ‚çš„éœ€æ±‚ï¼Œæ€»å…±æ‹†è§£å¾—åˆ°äº†4ä¸ªå­ä»»åŠ¡ï¼Œæ˜¯ä¸ºäº†æé†’æ¨¡å‹åœ¨å¿…è¦æ—¶ï¼Œå¯ä»¥å¤šæ‹†åˆ†ä¸€äº›å­ä»»åŠ¡ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">req = <span class="string">&#x27;è¯·æŸ¥é˜…æˆ‘é‚®ç®±é‡Œé¢æœªè¯»é‚®ä»¶ï¼Œä»æŒ‘é€‰æœ‰å…¬å¸çš„é‚®ä»¶ï¼Œå¹¶å°†å…¶æ ‡ç­¾æ”¹ä¸ºç´§æ€¥&#x27;</span></span><br><span class="line">system_message = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: md_content_plus&#125;]</span><br><span class="line">decomp_few_shot = [&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: example1_user&#125;,</span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: example1_assistent&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: example2_user&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: example2_assistent&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: example3_user&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: example3_assistent&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: example4_user&#125;, </span><br><span class="line">                   &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: example4_assistent&#125;]</span><br><span class="line">messages = system_message + decomp_few_shot</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/%s.json&#x27;</span> % <span class="string">&#x27;decompose_messages&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(messages, f)</span><br><span class="line">    </span><br><span class="line">messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: req&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sub_req1 = <span class="string">&#x27;æŸ¥é˜…é‚®ç®±ä¸­çš„æœªè¯»é‚®ä»¶ï¼Œå¹¶æ•´ç†å‡ºæœªè¯»é‚®ä»¶åˆ—è¡¨ã€‚&#x27;</span></span><br><span class="line">sub_req2 = <span class="string">&#x27;ä»æœªè¯»é‚®ä»¶åˆ—è¡¨ä¸­ç­›é€‰å‡ºåŒ…å«å…¬å¸ä¿¡æ¯çš„é‚®ä»¶ã€‚&#x27;</span></span><br><span class="line">sub_req3 = <span class="string">&#x27;å¯¹äºç­›é€‰å‡ºçš„å…¬å¸é‚®ä»¶ï¼Œå°†å…¶æ ‡ç­¾æ”¹ä¸ºâ€œç´§æ€¥â€ã€‚&#x27;</span></span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†åŸå§‹ä»»åŠ¡çš„æ‹†è§£éƒ¨åˆ†å·¥ä½œã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ä¸Šè¿°è¿‡ç¨‹å°è£…ä¸ºä¸€ä¸ªå®Œæ•´çš„å‡½æ•°ï¼Œæ–¹ä¾¿ä¹‹åè¿›è¡Œçµæ´»è°ƒç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_decompose_results</span>(<span class="params">req, model=<span class="string">&#x27;glm-4&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å¤æ‚éœ€æ±‚æ‹†è§£å‡½æ•°ï¼Œèƒ½å¤Ÿå°†ç”¨æˆ·è¾“å…¥çš„å¤æ‚éœ€æ±‚æ‹†è§£ä¸ºä¸€ç³»åˆ—æ›´å®¹æ˜“å®Œæˆçš„å­ä»»åŠ¡</span></span><br><span class="line"><span class="string">    :param req: å¿…é€‰å‚æ•°ï¼Œä»¥å­—ç¬¦ä¸²å½¢å¼è¡¨ç¤ºï¼Œç”¨äºè¡¨ç¤ºç”¨æˆ·è¾“å…¥çš„åŸå§‹éœ€æ±‚ï¼›</span></span><br><span class="line"><span class="string">    :param model: æ‹†è§£éœ€æ±‚æ‰€ä½¿ç”¨çš„å¤§æ¨¡å‹ï¼›</span></span><br><span class="line"><span class="string">    :returnï¼šç”±å­ä»»åŠ¡æ‰€ç»„æˆçš„åˆ—è¡¨ï¼›</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    decompose_results = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/decompose_messages.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        decompose_messages = json.load(f)</span><br><span class="line">        </span><br><span class="line">    decompose_messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: req&#125;)</span><br><span class="line">    </span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">                model=model,</span><br><span class="line">                messages=decompose_messages</span><br><span class="line">            )</span><br><span class="line">    </span><br><span class="line">    res = response.choices[<span class="number">0</span>].message.content</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ä»¥1ã€2ã€3å¼€å§‹çš„å¥å­</span></span><br><span class="line">    matches = re.findall(<span class="string">r&#x27;\d\.(.*?ã€‚)&#x27;</span>, res)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        decompose_results.append(<span class="keyword">match</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> decompose_results</span><br></pre></td></tr></table></figure><h4 id="3-2-6-2-ä»£ç ç¼–å†™ä¸æ•´åˆ"><a href="#3-2-6-2-ä»£ç ç¼–å†™ä¸æ•´åˆ" class="headerlink" title="3.2.6.2 ä»£ç ç¼–å†™ä¸æ•´åˆ"></a>3.2.6.2 ä»£ç ç¼–å†™ä¸æ•´åˆ</h4><p>æ–¹æ¡ˆä¸‰ï¼šåˆ†åˆ«åˆ›å»ºå‡½æ•°å†ç»Ÿä¸€ä»£ç ï¼ˆæ¨èæ–¹æ¡ˆï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">func1_name = code_generate(sub_req1, few_shot=<span class="string">&#x27;all&#x27;</span>, g=<span class="built_in">globals</span>(), detail=<span class="number">1</span>)</span><br><span class="line">func2_name = code_generate(sub_req2, few_shot=<span class="string">&#x27;all&#x27;</span>, g=<span class="built_in">globals</span>(), detail=<span class="number">1</span>)</span><br><span class="line">func3_name = code_generate(sub_req3, few_shot=<span class="string">&#x27;all&#x27;</span>, g=<span class="built_in">globals</span>(), detail=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (func1_name, func1_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    func1_str = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (func2_name, func2_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    func2_str = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (func3_name, func3_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    func3_str = f.read()</span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">  model=<span class="string">&#x27;glm-4&#x27;</span>,</span><br><span class="line">  messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;ä»¥ä¸‹æ˜¯å‡½æ•°1çš„ä»£ç ï¼š%s&#x27;</span> % func1_str&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;ä»¥ä¸‹æ˜¯å‡½æ•°2çš„ä»£ç ï¼š%s&#x27;</span> % func2_str&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;ä»¥ä¸‹æ˜¯å‡½æ•°3çš„ä»£ç ï¼š%s&#x27;</span> % func3_str&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;è¯·å°†å‡½æ•°1ã€å‡½æ•°2å’Œå‡½æ•°3çš„ä»£ç åŠŸèƒ½æ•´åˆåˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè¦æ±‚è¯¥å‡½æ•°åŠŸèƒ½å®Œæ•´ï¼Œå¹¶ä¸”å¯ä»¥æ»¡è¶³ä»¥ä¸‹éœ€æ±‚ï¼š%s&#x27;</span> % req&#125;</span><br><span class="line">  ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">req_auto_func</span>(<span class="params">req, few_shot=<span class="string">&#x27;all&#x27;</span>, model=<span class="string">&#x27;glm-4&#x27;</span>, g=<span class="built_in">globals</span>(<span class="params"></span>), detail=<span class="number">0</span></span>):</span><br><span class="line">    <span class="comment"># é»˜è®¤æƒ…å†µä¸‹system_messages = None</span></span><br><span class="line">    system_messages = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°è¯•è¿›è¡Œä»»åŠ¡æ‹†è§£</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decompose_results = get_decompose_results(req=req, model=model)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ä»£ç èƒ½æ‰§è¡Œåˆ°è¿™å„¿å—ï¼Ÿ&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;æš‚åœ1åˆ†é’Ÿåç»§ç»­è°ƒç”¨æ¨¡å‹&#x27;</span>)</span><br><span class="line">        <span class="comment">#time.sleep(60)</span></span><br><span class="line">        decompose_results = get_decompose_results(req=req, model=model)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># å¦‚æœåªæ‹†è§£å¾—åˆ°å¤šä¸ªä»»åŠ¡ï¼Œåˆ™åˆ›å»ºæ–°çš„åŸºäºä»»åŠ¡æ‹†è§£å¾—åˆ°çš„system_message</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(decompose_results) != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;åŸå§‹éœ€æ±‚å°†æ‹†åˆ†ä¸ºå¤šä¸ªå­éœ€æ±‚å¹¶è¿›è¡Œåˆ†æ®µä»£ç åˆ›å»ºä¸åˆå¹¶&#x27;</span>)</span><br><span class="line">        <span class="comment"># è¯»å–åŸå§‹system_message</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/tested functions/system_messages.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            system_messages = json.load(f)</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># ç”¨äºå­˜å‚¨å…¨éƒ¨éœ€æ±‚çš„å‡½æ•°ä»£ç </span></span><br><span class="line">        sub_func_all = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># ç”¨äºå­˜å‚¨å…¨éƒ¨éœ€æ±‚</span></span><br><span class="line">        sub_req_all = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># è®¡æ•°å™¨</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> sub_req <span class="keyword">in</span> decompose_results:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="comment"># æ¯ä¸ªéœ€æ±‚ä¾æ¬¡åˆ›å»ºå­å‡½æ•°</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;ç¬¬%sä¸ªå­éœ€æ±‚ä¸ºï¼š%s&#x27;</span> % (i, sub_req))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;æ­£åœ¨åˆ›å»ºå¯¹åº”å­å‡½æ•°&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                sub_func_name = code_generate(sub_req, few_shot=few_shot, g=g, detail=detail, model=model)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(e)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;æš‚åœ1åˆ†é’Ÿåç»§ç»­è°ƒç”¨æ¨¡å‹&#x27;</span>)</span><br><span class="line">                time.sleep(<span class="number">60</span>)</span><br><span class="line">                sub_func_name = code_generate(sub_req, few_shot=few_shot, g=g, detail=detail, model=model)</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># è¯»å–å­å‡½æ•°æºç </span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./functions/untested functions/%s/%s_module.py&#x27;</span> % (sub_func_name, sub_func_name), encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                sub_func_str = f.read()</span><br><span class="line">            <span class="comment"># å¯¹å­å‡½æ•°æºç è¿›è¡Œæ‹¼æ¥</span></span><br><span class="line">            sub_func_all += sub_func_str</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æŒ‰é¡ºåºæ‹¼æ¥å­éœ€æ±‚</span></span><br><span class="line">            sub_req_all += <span class="built_in">str</span>(i)+(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">            sub_req_all += sub_req            </span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;å­éœ€æ±‚å¯¹åº”çš„å­å‡½æ•°å…¨éƒ¨åˆ›å»ºå®Œæ¯•ï¼Œæ¥ä¸‹æ¥è¿›å…¥åˆ°åŸå§‹éœ€æ±‚å‡½æ•°åˆ›å»ºè¿‡ç¨‹...&#x27;</span>)</span><br><span class="line">        <span class="comment"># æ·»åŠ ä¸€ä¸ªsystem_message</span></span><br><span class="line">        decompose_description = <span class="string">&#x27;å¯¹äºå½“å‰ç¼–ç¨‹éœ€æ±‚ï¼Œå¯ä»¥æ‹†è§£ä¸ºè‹¥å¹²ä¸ªå­éœ€æ±‚ï¼Œä¹Ÿå°±æ˜¯ï¼š%sã€‚è¿™äº›å­éœ€æ±‚çš„å®ç°æ–¹å¼å¯ä»¥å‚è€ƒå¦‚ä¸‹ä»£ç ï¼š%s&#x27;</span> % (sub_req_all, sub_func_all)</span><br><span class="line">        system_messages[<span class="string">&#x27;system_message&#x27;</span>].append(&#123;<span class="string">&#x27;role&#x27;</span>: <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;content&#x27;</span>: decompose_description&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿›è¡Œä»£ç åˆ›å»ºå’Œä»£ç å®¡æŸ¥</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        function_name = code_generate(req=req, few_shot=few_shot, model=model, g=g, detail=detail, system_messages=system_messages)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;æš‚åœ1åˆ†é’Ÿåç»§ç»­è°ƒç”¨æ¨¡å‹&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">60</span>)</span><br><span class="line">        function_name = code_generate(req=req, few_shot=few_shot, model=model, g=g, detail=detail, system_messages=system_messages)</span><br><span class="line">        </span><br><span class="line">    function_test(function_name=function_name, req=req, few_shot=few_shot, model=model, g=g, system_messages=system_messages)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>3.Agentå®æˆ˜åŸºç¡€ä¹‹åœ¨çº¿å¤§æ¨¡å‹å¼€å‘</title>
      <link href="/2025/03/16/3.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9C%A8%E7%BA%BF%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/"/>
      <url>/2025/03/16/3.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9C%A8%E7%BA%BF%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<h1 id="1-Chat-Completion-API"><a href="#1-Chat-Completion-API" class="headerlink" title="1. Chat Completion API"></a>1. Chat Completion API</h1><h2 id="1-1-Chat-Completion-API-ä¼˜åŠ¿"><a href="#1-1-Chat-Completion-API-ä¼˜åŠ¿" class="headerlink" title="1.1 Chat Completion API ä¼˜åŠ¿"></a>1.1 Chat Completion API ä¼˜åŠ¿</h2><ul><li>Completion APIï¼ˆÃ—ï¼‰</li><li>Chat Completion APIï¼ˆâˆšï¼‰</li></ul><blockquote><p>è¯´æ˜ï¼š</p><ul><li>Chat æ¨¡å‹æ ¸å¿ƒèƒ½åŠ›åœ¨äºå¯¹è¯äº¤äº’</li><li>Completion æ¨¡å‹æœ¬è´¨ä¸Šæ˜¯æ–‡æœ¬è¡¥å…¨æ¨¡å‹</li><li>Chat æ¨¡å‹æ˜¯å¯¹ Completion æ¨¡å‹çš„å‡çº§</li><li>åŒæ—¶æ”¯æŒ Function Calling å’Œ ChatGPT Plugin</li></ul></blockquote><h2 id="1-2-Chat-Completion-API-ç¯å¢ƒéƒ¨ç½²"><a href="#1-2-Chat-Completion-API-ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="1.2 Chat Completion API ç¯å¢ƒéƒ¨ç½²"></a>1.2 Chat Completion API ç¯å¢ƒéƒ¨ç½²</h2><h3 id="1-2-1-æœåŠ¡å™¨-Anaconda-ç¯å¢ƒéƒ¨ç½²"><a href="#1-2-1-æœåŠ¡å™¨-Anaconda-ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="1.2.1 æœåŠ¡å™¨ Anaconda ç¯å¢ƒéƒ¨ç½²"></a>1.2.1 æœåŠ¡å™¨ Anaconda ç¯å¢ƒéƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n AI python=3.9</span><br><span class="line">conda activate AI</span><br><span class="line">pip install openai</span><br></pre></td></tr></table></figure><h3 id="1-2-2-PyCharm-è¿œç¨‹è¿æ¥æœåŠ¡å™¨å¼€å‘"><a href="#1-2-2-PyCharm-è¿œç¨‹è¿æ¥æœåŠ¡å™¨å¼€å‘" class="headerlink" title="1.2.2 PyCharm è¿œç¨‹è¿æ¥æœåŠ¡å™¨å¼€å‘"></a>1.2.2 PyCharm è¿œç¨‹è¿æ¥æœåŠ¡å™¨å¼€å‘</h3><ul><li>ä½¿ç”¨ PyCharm é…ç½®è¿œç¨‹ Python è§£é‡Šå™¨</li><li>é…ç½® SSH éš§é“ï¼ˆè‹¥éœ€ï¼‰</li></ul><h3 id="1-2-3-è´­ä¹°-API-åŠä»£ç†"><a href="#1-2-3-è´­ä¹°-API-åŠä»£ç†" class="headerlink" title="1.2.3 è´­ä¹° API åŠä»£ç†"></a>1.2.3 è´­ä¹° API åŠä»£ç†</h3><ul><li>æ·˜å®è´­ä¹° OpenAI API åŠç›¸åº”ä»£ç†æœåŠ¡</li></ul><h3 id="1-2-4-åˆå§‹åŒ–å®¢æˆ·ç«¯"><a href="#1-2-4-åˆå§‹åŒ–å®¢æˆ·ç«¯" class="headerlink" title="1.2.4 åˆå§‹åŒ–å®¢æˆ·ç«¯"></a>1.2.4 åˆå§‹åŒ–å®¢æˆ·ç«¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– OpenAI å®¢æˆ·ç«¯</span></span><br><span class="line">openai.api_key = <span class="string">&quot;api_key&quot;</span></span><br><span class="line">openai.api_base = <span class="string">&quot;api_base&quot;</span></span><br><span class="line"></span><br><span class="line">client = OpenAI(api_key=openai.api_key, base_url=openai.api_base)</span><br></pre></td></tr></table></figure><h2 id="1-3-å¤§æ¨¡å‹äº¤äº’æ–¹å¼"><a href="#1-3-å¤§æ¨¡å‹äº¤äº’æ–¹å¼" class="headerlink" title="1.3 å¤§æ¨¡å‹äº¤äº’æ–¹å¼"></a>1.3 å¤§æ¨¡å‹äº¤äº’æ–¹å¼</h2><h3 id="1-3-1-å¤§æ¨¡å‹äº¤äº’æ–¹å¼1ï¼ˆæœ€å¸¸ç”¨ï¼‰"><a href="#1-3-1-å¤§æ¨¡å‹äº¤äº’æ–¹å¼1ï¼ˆæœ€å¸¸ç”¨ï¼‰" class="headerlink" title="1.3.1 å¤§æ¨¡å‹äº¤äº’æ–¹å¼1ï¼ˆæœ€å¸¸ç”¨ï¼‰"></a>1.3.1 å¤§æ¨¡å‹äº¤äº’æ–¹å¼1ï¼ˆæœ€å¸¸ç”¨ï¼‰</h3><p>ç›´æ¥é€šè¿‡ chat æ¥å£è¿›è¡Œäº¤äº’ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">completion = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ å¥½!è¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(completion)</span><br><span class="line"><span class="built_in">print</span>(completion.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-3-2-å¤§æ¨¡å‹äº¤äº’æ–¹å¼2ï¼ˆæµå¼å“åº”ï¼Œé€‚ç”¨äºå®æ—¶å±•ç¤ºï¼‰"><a href="#1-3-2-å¤§æ¨¡å‹äº¤äº’æ–¹å¼2ï¼ˆæµå¼å“åº”ï¼Œé€‚ç”¨äºå®æ—¶å±•ç¤ºï¼‰" class="headerlink" title="1.3.2 å¤§æ¨¡å‹äº¤äº’æ–¹å¼2ï¼ˆæµå¼å“åº”ï¼Œé€‚ç”¨äºå®æ—¶å±•ç¤ºï¼‰"></a>1.3.2 å¤§æ¨¡å‹äº¤äº’æ–¹å¼2ï¼ˆæµå¼å“åº”ï¼Œé€‚ç”¨äºå®æ—¶å±•ç¤ºï¼‰</h3><p>æµå¼æ‰“å°ï¼Œæ¯æ¬¡è¿”å›å“åº”çš„ä¸€ä¸ªå°å—ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">stream = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ å¥½!è¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±&quot;</span>&#125;],</span><br><span class="line">    stream=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> chunk <span class="keyword">in</span> stream:</span><br><span class="line">    <span class="keyword">if</span> chunk.choices[<span class="number">0</span>].delta.content <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(chunk.choices[<span class="number">0</span>].delta.content, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="1-4-Chat-Completion-API-è¯¦ç»†å‚æ•°"><a href="#1-4-Chat-Completion-API-è¯¦ç»†å‚æ•°" class="headerlink" title="1.4 Chat Completion API è¯¦ç»†å‚æ•°"></a>1.4 Chat Completion API è¯¦ç»†å‚æ•°</h2><h3 id="1-4-1-å‚æ•°è¯´æ˜è¡¨"><a href="#1-4-1-å‚æ•°è¯´æ˜è¡¨" class="headerlink" title="1.4.1 å‚æ•°è¯´æ˜è¡¨"></a>1.4.1 å‚æ•°è¯´æ˜è¡¨</h3><table><thead><tr><th>å‚æ•°</th><th>æ˜¯å¦å¿…é€‰</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼&#x2F;å–å€¼èŒƒå›´</th></tr></thead><tbody><tr><td>model</td><td>å¿…é€‰</td><td>å¤§æ¨¡å‹çš„åç§°</td><td>â€”</td></tr><tr><td>messages</td><td>å¿…é€‰</td><td>æç¤ºè¯ï¼ˆå¯åŒ…å«è§’è‰²è®¾å®šï¼‰</td><td>â€”</td></tr><tr><td>max_tokens</td><td>å¯é€‰</td><td>è¿”å›ç»“æœçš„ token æ•°é‡</td><td>â€”</td></tr><tr><td>temperature</td><td>å¯é€‰</td><td>é‡‡æ ·æ¸©åº¦ã€‚æ•°å€¼è¶Šå°ç”Ÿæˆæ–‡æœ¬è¶Šä¿å®ˆï¼›è¾ƒé«˜æ—¶æ–‡æœ¬å¤šæ ·</td><td>é»˜è®¤ 1ï¼ŒèŒƒå›´ 0-2</td></tr><tr><td>top_p</td><td>å¯é€‰</td><td>æ§åˆ¶è¾“å‡ºæ–‡æœ¬çš„éšæœºæ€§ï¼Œå»ºè®®è°ƒèŠ‚ temperature</td><td>é»˜è®¤ 1ï¼ŒèŒƒå›´ 0-1</td></tr><tr><td>n</td><td>å¯é€‰</td><td>è¡¨ç¤ºåŒä¸€æç¤ºè¿”å›å‡ ä¸ª Completion</td><td>é»˜è®¤ 1</td></tr><tr><td>stream</td><td>å¯é€‰</td><td>å“åº”æ–¹å¼ã€‚False ä¸€æ¬¡æ€§è¿”å›ï¼›True æµå¼è¿”å›</td><td>é»˜è®¤ False</td></tr><tr><td>logprobs</td><td>å¯é€‰</td><td>è¿”å›æ¯ä¸ª token çš„å‰ N ä¸ªæ¦‚ç‡åŠå¯¹æ•°æ¦‚ç‡</td><td>é»˜è®¤ null</td></tr><tr><td>stop</td><td>å¯é€‰</td><td>æŒ‡å®šç”Ÿæˆæ–‡æœ¬çš„åœæ­¢ä¿¡å·ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²ï¼‰</td><td>é»˜è®¤ null</td></tr><tr><td>presence_penalty</td><td>å¯é€‰</td><td>è°ƒæ•´ç”Ÿæˆæ–°å†…å®¹çš„å€¾å‘æ€§ï¼Œè¾ƒé«˜å€¼æ›´æ˜“ç”Ÿæˆæ–°å†…å®¹</td><td>é»˜è®¤ 0ï¼ŒèŒƒå›´ [-2, 2]</td></tr><tr><td>frequency_penalty</td><td>å¯é€‰</td><td>è°ƒæ•´æ¨¡å‹é‡å¤è‡ªèº«çš„å€¾å‘æ€§ï¼Œè¾ƒé«˜å€¼é¿å…é‡å¤</td><td>é»˜è®¤ 0ï¼ŒèŒƒå›´ [-2, 2]</td></tr><tr><td>logit_bias</td><td>å¯é€‰</td><td>è°ƒæ•´ç‰¹å®š token çš„å¯¹æ•°æ¦‚ç‡åç½®</td><td>â€”</td></tr><tr><td>tools</td><td>å¯é€‰</td><td>å¯è°ƒç”¨çš„å‡½æ•°åˆ—è¡¨</td><td>â€”</td></tr><tr><td>tool_choice</td><td>å¯é€‰</td><td>è°ƒç”¨å‡½æ•°çš„ç­–ç•¥</td><td>â€”</td></tr><tr><td>functions</td><td>åºŸå¼ƒ</td><td>å¯è°ƒç”¨çš„å‡½æ•°ï¼ˆå·²åºŸå¼ƒï¼‰</td><td>â€”</td></tr><tr><td>function_call</td><td>åºŸå¼ƒ</td><td>è°ƒç”¨å‡½æ•°çš„ç­–ç•¥ï¼ˆå·²åºŸå¼ƒï¼‰</td><td>â€”</td></tr></tbody></table><h3 id="1-4-2-messages-å¯ä»¥åŒ…å«å¤šæ¡ä¿¡æ¯"><a href="#1-4-2-messages-å¯ä»¥åŒ…å«å¤šæ¡ä¿¡æ¯" class="headerlink" title="1.4.2 messages å¯ä»¥åŒ…å«å¤šæ¡ä¿¡æ¯"></a>1.4.2 messages å¯ä»¥åŒ…å«å¤šæ¡ä¿¡æ¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># messages å¯ä»¥åŒ…å«å¤šæ¡ä¿¡æ¯ï¼Œä½†æ¨¡å‹åªä¼šå¯¹æœ€åä¸€æ¡ç”¨æˆ·ä¿¡æ¯è¿›è¡Œå›ç­”</span></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ å¥½!è¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±&quot;</span>&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·é—®ï¼Œä¸­å›½çš„é¦–éƒ½æ˜¯ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-4-3-message-è§’è‰²è®¾å®š"><a href="#1-4-3-message-è§’è‰²è®¾å®š" class="headerlink" title="1.4.3 message è§’è‰²è®¾å®š"></a>1.4.3 message è§’è‰²è®¾å®š</h3><p>ç¤ºä¾‹ä¸€ï¼šå•ç”¨æˆ·ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;å‡è®¾ä½ æ˜¯ä¸€åèµ„æ·±çš„AIå¤§æ¨¡å‹ä¸“å®¶ï¼Œè¯·å¸®æˆ‘å›ç­”ï¼Œä»€ä¹ˆæ˜¯AIå¤§æ¨¡å‹ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹äºŒï¼šå…ˆè®¾å®š system åç”¨æˆ·æé—®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ æ˜¯ä¸€åAIå¤§æ¨¡å‹èµ„æ·±ä¸“å®¶&quot;</span>&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·é—®ä»€ä¹ˆæ˜¯AIå¤§æ¨¡å‹ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè‹¥ user æ¶ˆæ¯åœ¨å‰ï¼Œsystem æ¶ˆæ¯å°†ä¸ç”Ÿæ•ˆï¼</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·é—®ä»€ä¹ˆæ˜¯AIå¤§æ¨¡å‹ï¼Ÿ&quot;</span>&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ æ˜¯ä¸€åå¹½é»˜çš„è„±å£ç§€æ¼”å‘˜ï¼Œå›ç­”é—®é¢˜æ—¶è¯­è¨€è¦å¹½é»˜&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-4-4-message-ä¹‹-Few-shot-æ•ˆæœæ¼”ç¤º"><a href="#1-4-4-message-ä¹‹-Few-shot-æ•ˆæœæ¼”ç¤º" class="headerlink" title="1.4.4 message ä¹‹ Few-shot æ•ˆæœæ¼”ç¤º"></a>1.4.4 message ä¹‹ Few-shot æ•ˆæœæ¼”ç¤º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Q1 = <span class="string">&#x27;å°ç±³æœ‰6ä¸ªæ°”çƒï¼Œå¥¹åˆä¹°äº†3è¢‹ï¼Œæ¯è¢‹æœ‰10ä¸ªæ°”çƒï¼Œè¯·é—®å¥¹ç°åœ¨æ€»å…±æœ‰å¤šå°‘ä¸ªæ°”çƒï¼Ÿ&#x27;</span></span><br><span class="line">A1 = <span class="string">&#x27;ç°åœ¨å°ç±³æ€»å…±æœ‰36ä¸ªæ°”çƒã€‚&#x27;</span></span><br><span class="line">Q2 = <span class="string">&#x27;å°æ˜æ€»å…±æœ‰10ä¸ªè‹¹æœï¼Œåƒäº†3ä¸ªè‹¹æœï¼Œç„¶ååˆä¹°äº†5ä¸ªè‹¹æœï¼Œè¯·é—®ç°åœ¨å°æ˜æ€»å…±æœ‰å¤šå°‘ä¸ªè‹¹æœï¼Ÿ&#x27;</span></span><br><span class="line">A2 = <span class="string">&#x27;ç°åœ¨å°æ˜æ€»å…±æœ‰12ä¸ªè‹¹æœã€‚&#x27;</span></span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: Q1&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: A1&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: Q2&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å°†æç¤ºç¤ºä¾‹å†™å…¥ system ä¿¡æ¯ä¸­ä½œä¸ºèƒŒæ™¯ä¿¡æ¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;Q: &#x27;</span> + Q1 + <span class="string">&#x27; A: &#x27;</span> + A1&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&#x27;Q: &#x27;</span> + Q2 &#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-4-5-message-ä¹‹-Zero-shot-CoT-æ•ˆæœ"><a href="#1-4-5-message-ä¹‹-Zero-shot-CoT-æ•ˆæœ" class="headerlink" title="1.4.5 message ä¹‹ Zero-shot-CoT æ•ˆæœ"></a>1.4.5 message ä¹‹ Zero-shot-CoT æ•ˆæœ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">prompt_temp_cot = <span class="string">&#x27;è¯·ä¸€æ­¥æ­¥æ€è€ƒå¹¶è§£å†³é—®é¢˜&#x27;</span></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt_temp_cot&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: Q1&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-4-6-message-ä¹‹å®ç°ç®€æ˜“çŸ¥è¯†åº“"><a href="#1-4-6-message-ä¹‹å®ç°ç®€æ˜“çŸ¥è¯†åº“" class="headerlink" title="1.4.6 message ä¹‹å®ç°ç®€æ˜“çŸ¥è¯†åº“"></a>1.4.6 message ä¹‹å®ç°ç®€æ˜“çŸ¥è¯†åº“</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">text = (<span class="string">&#x27;è¥¿ç“œè€å¸ˆï¼Œç”·ï¼Œ1988å¹´6æœˆ16æ—¥å‡ºç”Ÿäºäº‘å—çœå¤§ç†å¸‚\n&#x27;</span></span><br><span class="line">        <span class="string">&#x27;2011å¹´æ¯•ä¸šäºäº‘å—å¤§å­¦è®¡ç®—æœºä¸“ä¸šã€‚\n&#x27;</span></span><br><span class="line">        <span class="string">&#x27;æ¯•ä¸šåçš„è¥¿ç“œè€å¸ˆåœ¨åŒ—äº¬çš„ä¸€å®¶è‘—åç§‘æŠ€å…¬å¸å·¥ä½œäº†12å¹´ï¼Œä¸“æ³¨äºäººå·¥æ™ºèƒ½æ–¹é¢çš„ç ”ç©¶ã€‚&#x27;</span>)</span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: text&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·é—®è¥¿ç“œè€å¸ˆå‡ºç”Ÿäºå“ªå„¿ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h2 id="1-5-å€ŸåŠ©æœ¬åœ°çŸ¥è¯†åº“å®ç°ç®€æ˜“ç‰ˆå¤šè½®å¯¹è¯æœºå™¨äºº"><a href="#1-5-å€ŸåŠ©æœ¬åœ°çŸ¥è¯†åº“å®ç°ç®€æ˜“ç‰ˆå¤šè½®å¯¹è¯æœºå™¨äºº" class="headerlink" title="1.5 å€ŸåŠ©æœ¬åœ°çŸ¥è¯†åº“å®ç°ç®€æ˜“ç‰ˆå¤šè½®å¯¹è¯æœºå™¨äºº"></a>1.5 å€ŸåŠ©æœ¬åœ°çŸ¥è¯†åº“å®ç°ç®€æ˜“ç‰ˆå¤šè½®å¯¹è¯æœºå™¨äºº</h2><h3 id="1-5-1-æµ‹è¯•å¤§æ¨¡å‹ï¼ˆæ— çŸ¥è¯†èƒŒæ™¯ï¼‰"><a href="#1-5-1-æµ‹è¯•å¤§æ¨¡å‹ï¼ˆæ— çŸ¥è¯†èƒŒæ™¯ï¼‰" class="headerlink" title="1.5.1 æµ‹è¯•å¤§æ¨¡å‹ï¼ˆæ— çŸ¥è¯†èƒŒæ™¯ï¼‰"></a>1.5.1 æµ‹è¯•å¤§æ¨¡å‹ï¼ˆæ— çŸ¥è¯†èƒŒæ™¯ï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;null&quot;</span>&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ çŸ¥é“é™ˆæ€è¯šå¯¼æ¼”çš„ã€Šæ¶ˆå¤±çš„å¥¹ã€‹çš„ç”µå½±é‡Œè§’è‰²æœ‰å“ªäº›å—ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-5-2-è¯»å–æœ¬åœ°çŸ¥è¯†åº“"><a href="#1-5-2-è¯»å–æœ¬åœ°çŸ¥è¯†åº“" class="headerlink" title="1.5.2 è¯»å–æœ¬åœ°çŸ¥è¯†åº“"></a>1.5.2 è¯»å–æœ¬åœ°çŸ¥è¯†åº“</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;æ¶ˆå¤±çš„å¥¹.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    chatCompletion_kg = f.read()</span><br></pre></td></tr></table></figure><h3 id="1-5-3-é—®ç­”æµ‹è¯•"><a href="#1-5-3-é—®ç­”æµ‹è¯•" class="headerlink" title="1.5.3 é—®ç­”æµ‹è¯•"></a>1.5.3 é—®ç­”æµ‹è¯•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=[</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: chatCompletion_kg&#125;,</span><br><span class="line">      &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ çŸ¥é“ã€Šæ¶ˆå¤±çš„å¥¹ã€‹çš„ç”µå½±é‡Œè§’è‰²æœ‰å“ªäº›å—ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message.content)</span><br></pre></td></tr></table></figure><h3 id="1-5-4-æ·»åŠ å¤šè½®å¯¹è¯æ•ˆæœ"><a href="#1-5-4-æ·»åŠ å¤šè½®å¯¹è¯æ•ˆæœ" class="headerlink" title="1.5.4 æ·»åŠ å¤šè½®å¯¹è¯æ•ˆæœ"></a>1.5.4 æ·»åŠ å¤šè½®å¯¹è¯æ•ˆæœ</h3><p>å®šä¹‰ä¸€ä¸ªå‡½æ•°å®ç°å¤šè½®å¯¹è¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">chat_with_model</span>(<span class="params">messages</span>):</span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">        messages=messages</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> response.choices[<span class="number">0</span>].message.content</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gpt_chat_with_model</span>():</span><br><span class="line">    <span class="comment"># åˆå§‹é—®å€™ï¼ŒåŠ å…¥æœ¬åœ°çŸ¥è¯†åº“ä½œä¸ºèƒŒæ™¯</span></span><br><span class="line">    messages = [</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: chatCompletion_kg&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªAIGCæ™ºèƒ½åŠ©ç†ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜æˆ‘å¯ä»¥å¸®åŠ©ä½ ï¼Ÿ&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">    <span class="built_in">print</span>(chat_with_model(messages))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿›è¡Œå¯¹è¯</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        user_input = <span class="built_in">input</span>(<span class="string">&quot;ç”¨æˆ·ï¼š&quot;</span>)</span><br><span class="line">        messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_input&#125;)</span><br><span class="line">        assistant_response = chat_with_model(messages)</span><br><span class="line">        messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>, <span class="string">&quot;content&quot;</span>: assistant_response&#125;)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;åŠ©ç†ï¼š&quot;</span> + assistant_response)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ¤æ–­æ˜¯å¦ç»“æŸå¯¹è¯</span></span><br><span class="line">        <span class="keyword">if</span> user_input.lower() == <span class="string">&#x27;quit&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">gpt_chat_with_model()</span><br></pre></td></tr></table></figure><blockquote><p> è¯´æ˜ï¼šPrompt æ¨¡å¼å¯¹æ¯”è¡¨</p><table><thead><tr><th>Promptæ¨¡å¼</th><th>æè¿°</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Zero-Shot</td><td>ç›´æ¥ç»™å‡ºä»»åŠ¡ï¼Œä¸æä¾›ä»»ä½•ç¤ºä¾‹æˆ–ä¸Šä¸‹æ–‡ã€‚</td><td>å¿«é€Ÿã€ç®€å•ï¼Œä¸éœ€è¦äº‹å…ˆå‡†å¤‡æ•°æ®ï¼›é€‚åˆä»»åŠ¡æ˜ç¡®ä¸”æ¨¡å‹èƒ½åŠ›è¾ƒå¼ºæ—¶ä½¿ç”¨ã€‚</td><td>æ€§èƒ½å¯èƒ½è¾ƒä½ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤æ‚ä»»åŠ¡ï¼›éœ€è¦æ¨¡å‹åœ¨å°‘é‡ä¿¡æ¯ä¸‹èƒ½æ¨ç†å‡ºç­”æ¡ˆã€‚</td><td>åŸºæœ¬ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯å½“ä»»åŠ¡è¯´æ˜éå¸¸æ¸…æ™°æ—¶ï¼›è¦æ±‚æ¨¡å‹èƒ½æ ¹æ®ä»»åŠ¡ç›´æ¥ç»™å‡ºç­”æ¡ˆã€‚</td></tr><tr><td>Few-Shot</td><td>ç»™å‡ºä»»åŠ¡å’Œå°‘é‡çš„ç¤ºä¾‹ï¼ˆé€šå¸¸1-5ä¸ªä¾‹å­ï¼‰ï¼Œè®©æ¨¡å‹å­¦ä¹ å¦‚ä½•è§£å†³ä»»åŠ¡ã€‚</td><td>æä¾›ä¸Šä¸‹æ–‡å’Œå®ä¾‹ï¼Œå¸®åŠ©æ¨¡å‹æ›´å¥½åœ°ç†è§£ä»»åŠ¡ï¼›æé«˜ä»»åŠ¡å¤æ‚åº¦æ—¶æ›´æœ‰æ•ˆã€‚</td><td>éœ€è¦é€‰æ‹©åˆé€‚çš„ç¤ºä¾‹ï¼Œç¤ºä¾‹é€‰æ‹©ä¸å½“å¯èƒ½å½±å“æ€§èƒ½ï¼›å¯¹ä»»åŠ¡çš„å¤šæ ·æ€§è¦æ±‚è¾ƒé«˜ã€‚</td><td>ä»»åŠ¡æ˜ç¡®ä½†å…·æœ‰å¤æ‚æ€§ï¼Œæˆ–éœ€è¦æ¨¡å‹åœ¨å°‘é‡ç¤ºä¾‹çš„å¸®åŠ©ä¸‹æ¨ç†ã€‚</td></tr><tr><td>COT (Chain of Thought)</td><td>å¼•å¯¼æ¨¡å‹é€šè¿‡ä¸€æ­¥æ­¥çš„æ¨ç†è¿‡ç¨‹æ¥å¾—å‡ºç­”æ¡ˆï¼Œé€šå¸¸ä¼šå¢åŠ ä¸€ç³»åˆ—ä¸­é—´æ¨ç†æ­¥éª¤ã€‚</td><td>æé«˜æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ï¼Œå°¤å…¶æ˜¯å¤æ‚é—®é¢˜ï¼›èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†éœ€è¦æ¨ç†å’Œé€»è¾‘çš„ä»»åŠ¡ã€‚</td><td>ç”Ÿæˆçš„æ¨ç†é“¾å¯èƒ½è¿‡äºå†—é•¿æˆ–ä¸æ¸…æ™°ï¼›æœ‰æ—¶å¯èƒ½éš¾ä»¥åˆ¤æ–­æ¨ç†é“¾çš„æœ‰æ•ˆæ€§ã€‚</td><td>éœ€è¦å¤æ‚æ¨ç†æˆ–é€»è¾‘æ­¥éª¤çš„ä»»åŠ¡ï¼Œå¦‚æ•°å­¦é¢˜è§£ã€å¤æ‚æ¨ç†é—®é¢˜ç­‰ã€‚</td></tr><tr><td>SC (Self-Consistent)</td><td>é€šè¿‡å¤šæ¬¡ç”Ÿæˆä¸åŒç­”æ¡ˆå¹¶é€šè¿‡æŠ•ç¥¨æˆ–æ¯”è¾ƒæ¥ç¡®å®šæœ€ä¸€è‡´çš„ç­”æ¡ˆã€‚</td><td>æé«˜ç­”æ¡ˆçš„å‡†ç¡®æ€§ï¼Œå‡å°‘æ¨¡å‹å•æ¬¡è¾“å‡ºçš„è¯¯å·®ã€‚</td><td>éœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºå’Œæ—¶é—´ï¼›å¯èƒ½å¯¼è‡´é‡å¤çš„è¾“å‡ºï¼Œå¢åŠ å†—ä½™ã€‚</td><td>å¯¹å‡†ç¡®æ€§è¦æ±‚è¾ƒé«˜çš„ä»»åŠ¡ï¼Œå°¤å…¶æ˜¯åœ¨é«˜ä¸ç¡®å®šæ€§æˆ–æ¨¡ç³Šæƒ…å†µä¸‹ã€‚</td></tr><tr><td>TOT (Task-Oriented Thought)</td><td>åœ¨ä»»åŠ¡è¿‡ç¨‹ä¸­ï¼Œé’ˆå¯¹ç‰¹å®šç›®æ ‡è¿›è¡Œæ€ç»´å¼•å¯¼ï¼Œé€šå¸¸ä¼šæŒç»­å…³æ³¨ä»»åŠ¡ç›®æ ‡ï¼Œè€Œä¸æ˜¯æ‰€æœ‰æ¨ç†æ­¥éª¤ã€‚</td><td>æé«˜æ•ˆç‡ï¼Œæ¨¡å‹æ›´åŠ å…³æ³¨ä»»åŠ¡çš„æœ€ç»ˆç›®æ ‡ï¼›é€‚ç”¨äºé•¿æ—¶é—´çš„ä»»åŠ¡ã€‚</td><td>å¯èƒ½å¿½è§†å…¶ä»–é‡è¦ä¿¡æ¯ï¼Œåªå…³æ³¨ç›®æ ‡ï¼›æ¨ç†è¿‡ç¨‹å¯èƒ½ä¸å…¨é¢ã€‚</td><td>é•¿æœŸä»»åŠ¡ï¼Œæˆ–éœ€è¦æ˜ç¡®ç›®æ ‡å¯¼å‘çš„ä»»åŠ¡ï¼Œä¾‹å¦‚æ–‡æœ¬ç”Ÿæˆã€ç¿»è¯‘ç­‰ã€‚</td></tr><tr><td>Step-Back</td><td>åœ¨è§£ç­”é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå½“å‰æ­¥éª¤å¤±è´¥ï¼Œå›é€€åˆ°å‰ä¸€æ­¥é‡æ–°è¯„ä¼°æˆ–æ¨ç†ã€‚</td><td>å¢å¼ºæ¨¡å‹å¤„ç†å¤æ‚ä»»åŠ¡æ—¶çš„å®¹é”™èƒ½åŠ›ï¼›å¸®åŠ©æ¨¡å‹åœ¨æ¨ç†è¿‡ç¨‹ä¸­çº é”™ã€‚</td><td>å›é€€å¯èƒ½å¯¼è‡´æ›´å¤šçš„è®¡ç®—ï¼Œå¢åŠ å¤„ç†æ—¶é—´ï¼›å¹¶éæ‰€æœ‰ä»»åŠ¡éƒ½é€‚åˆåå‘æ¨ç†ã€‚</td><td>å¤æ‚ä»»åŠ¡æˆ–å¤šæ­¥éª¤é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¨¡å‹å¯èƒ½çŠ¯é”™æ—¶ã€‚</td></tr></tbody></table></blockquote><h1 id="2-Function-Calling"><a href="#2-Function-Calling" class="headerlink" title="2. Function Calling"></a>2. Function Calling</h1><h2 id="2-1-Function-Callingè¯¦ç»†æµç¨‹å‰–æ"><a href="#2-1-Function-Callingè¯¦ç»†æµç¨‹å‰–æ" class="headerlink" title="2.1 Function Callingè¯¦ç»†æµç¨‹å‰–æ"></a>2.1 Function Callingè¯¦ç»†æµç¨‹å‰–æ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">openai.api_key = <span class="string">&quot;your_api_key&quot;</span></span><br><span class="line"></span><br><span class="line">openai.api_base=<span class="string">&quot;your_api_base&quot;</span></span><br><span class="line"></span><br><span class="line">client = OpenAI(api_key=openai.api_key ,base_url=openai.api_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¤ºä¾‹å‡½æ•° - å­™æ‚Ÿç©ºç®—æ³•</span></span><br><span class="line"><span class="comment"># è¯¥å‡½æ•°ç”¨äºæ¥æ”¶ä¸€ä¸ªæ•°æ®è¡¨ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†å¹¶è¿”å›JSONæ ¼å¼ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sunwukong_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å­™æ‚Ÿç©ºç®—æ³•å‡½æ•°ï¼Œè¯¥å‡½æ•°å®šä¹‰äº†æ•°æ®é›†è®¡ç®—è¿‡ç¨‹</span></span><br><span class="line"><span class="string">    :param data: å¿…è¦å‚æ•°ï¼Œè¡¨ç¤ºå¸¦å…¥è®¡ç®—çš„æ•°æ®è¡¨ï¼Œç”¨å­—ç¬¦ä¸²è¿›è¡Œè¡¨ç¤º</span></span><br><span class="line"><span class="string">    :return: sunwukong_functionå‡½æ•°è®¡ç®—åçš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºJSONæ ¼å¼çš„Dataframeç±»å‹å¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new[<span class="string">&#x27;x1&#x27;</span>] * <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line">df_str = pd.DataFrame(&#123;<span class="string">&#x27;x1&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">&#x27;x2&#x27;</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;).to_string</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„å¯¹è¯æµç¨‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_conversation</span>():</span><br><span class="line">    <span class="comment"># Step 1: åˆå§‹åŒ–å¯¹è¯ï¼Œå‘é€æ•°æ®é›†å’Œå‡½æ•°ä¿¡æ¯</span></span><br><span class="line">    messages = [</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æ•°æ®é›†dataï¼š%sï¼Œæ•°æ®é›†ä»¥å­—ç¬¦ä¸²å½¢å¼å‘ˆç°&quot;</span> % df_str&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·åœ¨æ•°æ®é›†dataä¸Šæ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰å·¥å…·ï¼ˆå‡½æ•°ï¼‰</span></span><br><span class="line">    tools = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">            <span class="string">&quot;function&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;sunwukong_function&quot;</span>,</span><br><span class="line">                <span class="string">&quot;description&quot;</span>: <span class="string">&quot;ç”¨äºæ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•å‡½æ•°ï¼Œå®šä¹‰äº†ä¸€ç§ç‰¹æ®Šçš„æ•°æ®é›†è®¡ç®—è¿‡ç¨‹&quot;</span>,</span><br><span class="line">                <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;data&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>, <span class="string">&quot;description&quot;</span>: <span class="string">&quot;æ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•çš„æ•°æ®é›†&quot;</span>&#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;data&quot;</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 2: å‘é€åˆæ¬¡è¯·æ±‚</span></span><br><span class="line">    response = client.chat.completions.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">        messages=messages,</span><br><span class="line">        tools=tools,</span><br><span class="line">        tool_choice=<span class="string">&quot;auto&quot;</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–æ¨¡å‹è¿”å›çš„æ¶ˆæ¯</span></span><br><span class="line">    response_message = response.choices[<span class="number">0</span>].message</span><br><span class="line">    tool_calls = response_message.tool_calls</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Step 3: åˆ¤æ–­æ¨¡å‹æ˜¯å¦è¦è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="keyword">if</span> tool_calls:</span><br><span class="line">        available_functions = &#123;<span class="string">&quot;sunwukong_function&quot;</span>: sunwukong_function&#125;  <span class="comment"># è¿™é‡Œå¯ä»¥æ‰©å±•å¤šç§å‡½æ•°</span></span><br><span class="line">        messages.append(response_message)  <span class="comment"># å°†æ¨¡å‹è¿”å›ç»“æœåŠ å…¥æ¶ˆæ¯åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Step 4: æ‰§è¡Œå‡½æ•°ï¼Œå¹¶å°†è¿”å›ç»“æœä¼ å›æ¨¡å‹</span></span><br><span class="line">        <span class="keyword">for</span> tool_call <span class="keyword">in</span> tool_calls:</span><br><span class="line">            function_name = tool_call.function.name</span><br><span class="line">            function_to_call = available_functions[function_name]</span><br><span class="line">            function_args = json.loads(tool_call.function.arguments)</span><br><span class="line">            function_response = function_to_call(**function_args)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># å°†å‡½æ•°ç»“æœä¼ å›å¯¹è¯ä¸Šä¸‹æ–‡</span></span><br><span class="line">            messages.append(&#123;</span><br><span class="line">                <span class="string">&quot;tool_call_id&quot;</span>: tool_call.<span class="built_in">id</span>,</span><br><span class="line">                <span class="string">&quot;role&quot;</span>: <span class="string">&quot;tool&quot;</span>,</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: function_name,</span><br><span class="line">                <span class="string">&quot;content&quot;</span>: function_response,</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Step 5: å‘é€æœ€ç»ˆè¯·æ±‚ï¼Œè·å–å®Œæ•´å›ç­”</span></span><br><span class="line">        second_response = client.chat.completions.create(</span><br><span class="line">            model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">            messages=messages,</span><br><span class="line">        )</span><br><span class="line">        <span class="keyword">return</span> second_response</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå¯¹è¯æµç¨‹å¹¶è¾“å‡ºæœ€ç»ˆç»“æœ</span></span><br><span class="line">result = run_conversation()</span><br><span class="line"><span class="built_in">print</span>(result.choices[<span class="number">0</span>].message.content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨StringIOå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ–‡ä»¶å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">df_str = <span class="string">&#x27;\n    x1\n0  10\n1  20\n.&#x27;</span></span><br><span class="line">data = io.StringIO(df_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨read_csv()å‡½æ•°è¯»å–æ•°æ®ï¼Œå¹¶è®¾ç½®ç¬¬ä¸€åˆ—ä¸ºç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(df_new)</span><br></pre></td></tr></table></figure><blockquote><p>è¯¦è§£ï¼šfunction_response &#x3D; function_to_call(**function_args)</p><ol><li><code>function_to_call</code> ä»£è¡¨æŸä¸ªå‡½æ•°ï¼ˆåŠ¨æ€å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ï¼‰ã€‚</li><li><code>function_args</code> æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œ<code>**</code> è§£åŒ…å®ƒï¼ŒæŠŠé”®å€¼å¯¹ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°ã€‚</li><li><code>function_response</code> æ¥æ”¶å‡½æ•°è¿”å›å€¼ã€‚</li></ol></blockquote><h2 id="2-2-Function-Callingå‡½æ•°å°è£…"><a href="#2-2-Function-Callingå‡½æ•°å°è£…" class="headerlink" title="2.2 Function Callingå‡½æ•°å°è£…"></a>2.2 Function Callingå‡½æ•°å°è£…</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"></span><br><span class="line">openai.api_key = <span class="string">&quot;your_api_key&quot;</span></span><br><span class="line">openai.api_base = <span class="string">&quot;your_api_base&quot;</span></span><br><span class="line"></span><br><span class="line">client = OpenAI(api_key=openai.api_key, base_url=openai.api_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å‡½æ•°ï¼šè‡ªåŠ¨ç”ŸæˆChatæ¨¡å‹æ‰€éœ€çš„functionså‚æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auto_functions</span>(<span class="params">functions_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ ¹æ®è¾“å…¥çš„å‡½æ•°åˆ—è¡¨ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆChatæ¨¡å‹functionså‚æ•°æ ¼å¼çš„æè¿°å­—å…¸</span></span><br><span class="line"><span class="string">    :param functions_list: åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•°å¯¹è±¡çš„åˆ—è¡¨</span></span><br><span class="line"><span class="string">    :return: ç¬¦åˆChatæ¨¡å‹functionså‚æ•°è¦æ±‚çš„functionså¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">functions_generate</span>(<span class="params">functions_list</span>):</span><br><span class="line">        functions = []</span><br><span class="line">        <span class="comment"># éå†æ¯ä¸ªå‡½æ•°å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">for</span> function <span class="keyword">in</span> functions_list:</span><br><span class="line">            <span class="comment"># è·å–å‡½æ•°çš„è¯´æ˜æ–‡æ¡£å’Œåç§°</span></span><br><span class="line">            function_description = inspect.getdoc(function)</span><br><span class="line">            function_name = function.__name__</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è®¾ç½®æç¤ºè¯ï¼Œç”Ÿæˆç¬¦åˆJSONæ ¼å¼çš„å‡½æ•°æè¿°</span></span><br><span class="line">            system_prompt = <span class="string">&#x27;ä»¥ä¸‹æ˜¯æŸçš„å‡½æ•°è¯´æ˜ï¼š%s&#x27;</span> % function_description</span><br><span class="line">            user_prompt = <span class="string">&#x27;æ ¹æ®è¿™ä¸ªå‡½æ•°çš„å‡½æ•°è¯´æ˜ï¼Œè¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ªJSONæ ¼å¼çš„å­—å…¸ï¼Œè¿™ä¸ªå­—å…¸æœ‰å¦‚ä¸‹5ç‚¹è¦æ±‚ï¼š\</span></span><br><span class="line"><span class="string">                           1.å­—å…¸æ€»å…±æœ‰ä¸‰ä¸ªé”®å€¼å¯¹ï¼›\</span></span><br><span class="line"><span class="string">                           2.ç¬¬ä¸€ä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²nameï¼Œvalueæ˜¯è¯¥å‡½æ•°çš„åå­—ï¼š%sï¼Œä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼›\</span></span><br><span class="line"><span class="string">                           3.ç¬¬äºŒä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²descriptionï¼Œvalueæ˜¯è¯¥å‡½æ•°çš„å‡½æ•°çš„åŠŸèƒ½è¯´æ˜ï¼Œä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼›\</span></span><br><span class="line"><span class="string">                           4.ç¬¬ä¸‰ä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²parametersï¼Œvalueæ˜¯ä¸€ä¸ªJSON Schemaå¯¹è±¡ï¼Œç”¨äºè¯´æ˜è¯¥å‡½æ•°çš„å‚æ•°è¾“å…¥è§„èŒƒã€‚\</span></span><br><span class="line"><span class="string">                           5.è¾“å‡ºç»“æœå¿…é¡»æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„å­—å…¸ï¼Œåªè¾“å‡ºè¿™ä¸ªå­—å…¸å³å¯ï¼Œå‰åä¸éœ€è¦ä»»ä½•å‰åä¿®é¥°æˆ–è¯´æ˜çš„è¯­å¥&#x27;</span> % function_name</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è°ƒç”¨Chatæ¨¡å‹ç”Ÿæˆå‡½æ•°æè¿°</span></span><br><span class="line">            response = client.chat.completions.create(</span><br><span class="line">                model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">                messages=[</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: system_prompt&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_prompt&#125;</span><br><span class="line">                ]</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è§£æè¿”å›çš„JSONå­—ç¬¦ä¸²</span></span><br><span class="line">            json_function_description = json.loads(response.choices[<span class="number">0</span>].message.content.replace(<span class="string">&quot;```&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;json&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">            json_str = &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>, <span class="string">&quot;function&quot;</span>: json_function_description&#125;</span><br><span class="line">            functions.append(json_str)</span><br><span class="line">        <span class="keyword">return</span> functions</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æœ€å¤§å°è¯•4æ¬¡ï¼Œé˜²æ­¢å¼‚å¸¸</span></span><br><span class="line">    max_attempts = <span class="number">4</span></span><br><span class="line">    attempts = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> attempts &lt; max_attempts:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            functions = functions_generate(functions_list)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            attempts += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å‘ç”Ÿé”™è¯¯ï¼š&quot;</span>, e)</span><br><span class="line">            <span class="keyword">if</span> attempts == max_attempts:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å·²è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œç¨‹åºç»ˆæ­¢ã€‚&quot;</span>)</span><br><span class="line">                <span class="keyword">raise</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨é‡æ–°è¿è¡Œ...&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> functions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å­™æ‚Ÿç©ºç®—æ³•å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sunwukong_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å­™æ‚Ÿç©ºç®—æ³•ï¼Œç»™æ•°æ®é›†æ‰€æœ‰æ•°å€¼ä¹˜ä»¥10</span></span><br><span class="line"><span class="string">    :param data: è¾“å…¥æ•°æ®é›†ï¼Œå­—ç¬¦ä¸²å½¢å¼</span></span><br><span class="line"><span class="string">    :return: è¿”å›å¤„ç†åçš„æ•°æ®é›†ï¼ŒJSONæ ¼å¼</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new * <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å”åƒ§ç®—æ³•å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tangseng_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å”åƒ§ç®—æ³•ï¼Œç»™æ•°æ®é›†æ‰€æœ‰æ•°å€¼ä¹˜ä»¥1000000</span></span><br><span class="line"><span class="string">    :param data: è¾“å…¥æ•°æ®é›†ï¼Œå­—ç¬¦ä¸²å½¢å¼</span></span><br><span class="line"><span class="string">    :return: è¿”å›å¤„ç†åçš„æ•°æ®é›†ï¼ŒJSONæ ¼å¼</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new * <span class="number">1000000</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å‡½æ•°åˆ—è¡¨ä¼ å…¥ï¼Œç”Ÿæˆtoolså‚æ•°</span></span><br><span class="line">functions_list = [sunwukong_function, tangseng_function]</span><br><span class="line">tools = auto_functions(functions_list)</span><br><span class="line"><span class="built_in">print</span>(tools)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®é›†</span></span><br><span class="line"></span><br><span class="line">df_str = pd.DataFrame(&#123;<span class="string">&#x27;x1&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">&#x27;x2&#x27;</span>: [<span class="number">3</span>, <span class="number">4</span>]&#125;).to_string()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ç¬¬ä¸€ç»„å¯¹è¯ï¼Œè°ƒç”¨å­™æ‚Ÿç©ºç®—æ³•</span></span><br><span class="line">messages = [</span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æ•°æ®é›†dataï¼š%sï¼Œæ•°æ®é›†ä»¥å­—ç¬¦ä¸²å½¢å¼å‘ˆç°&quot;</span> % df_str&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·åœ¨æ•°æ®é›†dataä¸Šæ‰§è¡Œå­™æ‚Ÿç©ºç®—æ³•&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=messages,</span><br><span class="line">    tools=tools,</span><br><span class="line">    tool_choice=<span class="string">&quot;auto&quot;</span>,</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ç¬¬äºŒç»„å¯¹è¯ï¼Œè°ƒç”¨å”åƒ§ç®—æ³•</span></span><br><span class="line">messages = [</span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;æ•°æ®é›†dataï¼š%sï¼Œæ•°æ®é›†ä»¥å­—ç¬¦ä¸²å½¢å¼å‘ˆç°&quot;</span> % df_str&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;è¯·åœ¨æ•°æ®é›†dataä¸Šæ‰§è¡Œå”åƒ§ç®—æ³•å‡½æ•°&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">    messages=messages,</span><br><span class="line">    tools=tools,</span><br><span class="line">    tool_choice=<span class="string">&quot;auto&quot;</span>,</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(response.choices[<span class="number">0</span>].message)</span><br></pre></td></tr></table></figure><h2 id="2-3-å°è£…è°ƒç”¨2è½®responseçš„å‡½æ•°-å¢åŠ å¤šè½®å¯¹è¯çš„æ•ˆæœ"><a href="#2-3-å°è£…è°ƒç”¨2è½®responseçš„å‡½æ•°-å¢åŠ å¤šè½®å¯¹è¯çš„æ•ˆæœ" class="headerlink" title="2.3 å°è£…è°ƒç”¨2è½®responseçš„å‡½æ•°+å¢åŠ å¤šè½®å¯¹è¯çš„æ•ˆæœ"></a>2.3 å°è£…è°ƒç”¨2è½®responseçš„å‡½æ•°+å¢åŠ å¤šè½®å¯¹è¯çš„æ•ˆæœ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"></span><br><span class="line">openai.api_key = <span class="string">&quot;your_api_key&quot;</span></span><br><span class="line">openai.api_base = <span class="string">&quot;your_api_base&quot;</span></span><br><span class="line"></span><br><span class="line">client = OpenAI(api_key=openai.api_key, base_url=openai.api_base)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sunwukong_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å­™æ‚Ÿç©ºç®—æ³•å‡½æ•°ï¼Œè¯¥å‡½æ•°å®šä¹‰äº†æ•°æ®é›†è®¡ç®—è¿‡ç¨‹</span></span><br><span class="line"><span class="string">    :param data: å¿…è¦å‚æ•°ï¼Œè¡¨ç¤ºå¸¦å…¥è®¡ç®—çš„æ•°æ®è¡¨ï¼Œç”¨å­—ç¬¦ä¸²è¿›è¡Œè¡¨ç¤º</span></span><br><span class="line"><span class="string">    :returnï¼šsunwukong_functionå‡½æ•°è®¡ç®—åçš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºè¡¨ç¤ºä¸ºJSONæ ¼å¼çš„Dataframeç±»å‹å¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new * <span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tangseng_function</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    å”åƒ§ç®—æ³•å‡½æ•°ï¼Œè¯¥å‡½æ•°å®šä¹‰äº†æ•°æ®é›†è®¡ç®—è¿‡ç¨‹</span></span><br><span class="line"><span class="string">    :param data: å¿…è¦å‚æ•°ï¼Œè¡¨ç¤ºå¸¦å…¥è®¡ç®—çš„æ•°æ®è¡¨ï¼Œç”¨å­—ç¬¦ä¸²è¿›è¡Œè¡¨ç¤º</span></span><br><span class="line"><span class="string">    :returnï¼štangseng_functionå‡½æ•°è®¡ç®—åçš„ç»“æœï¼Œè¿”å›ç»“æœä¸ºè¡¨ç¤ºä¸ºJSONæ ¼å¼çš„Dataframeç±»å‹å¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = io.StringIO(data)</span><br><span class="line">    df_new = pd.read_csv(data, sep=<span class="string">&#x27;\s+&#x27;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">    res = df_new * <span class="number">1000000</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(res.to_string())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auto_functions</span>(<span class="params">functions_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Chatæ¨¡å‹çš„functionså‚æ•°ç¼–å†™å‡½æ•°</span></span><br><span class="line"><span class="string">    :param functions_list: åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‡½æ•°å¯¹è±¡çš„åˆ—è¡¨ï¼›</span></span><br><span class="line"><span class="string">    :returnï¼šæ»¡è¶³Chatæ¨¡å‹functionså‚æ•°è¦æ±‚çš„functionså¯¹è±¡</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">functions_generate</span>(<span class="params">functions_list</span>):</span><br><span class="line">        <span class="comment"># åˆ›å»ºç©ºåˆ—è¡¨ï¼Œç”¨äºä¿å­˜æ¯ä¸ªå‡½æ•°çš„æè¿°å­—å…¸</span></span><br><span class="line">        functions = []</span><br><span class="line">        <span class="comment"># å¯¹æ¯ä¸ªå¤–éƒ¨å‡½æ•°è¿›è¡Œå¾ªç¯</span></span><br><span class="line">        <span class="keyword">for</span> function <span class="keyword">in</span> functions_list:</span><br><span class="line">            <span class="comment"># è¯»å–å‡½æ•°å¯¹è±¡çš„å‡½æ•°è¯´æ˜</span></span><br><span class="line">            function_description = inspect.getdoc(function)</span><br><span class="line">            <span class="comment"># è¯»å–å‡½æ•°çš„å‡½æ•°åå­—ç¬¦ä¸²</span></span><br><span class="line">            function_name = function.__name__</span><br><span class="line"></span><br><span class="line">            system_prompt = <span class="string">&#x27;ä»¥ä¸‹æ˜¯æŸçš„å‡½æ•°è¯´æ˜ï¼š%s&#x27;</span> % function_description</span><br><span class="line">            user_prompt = <span class="string">&#x27;æ ¹æ®è¿™ä¸ªå‡½æ•°çš„å‡½æ•°è¯´æ˜ï¼Œè¯·å¸®æˆ‘åˆ›å»ºä¸€ä¸ªJSONæ ¼å¼çš„å­—å…¸ï¼Œè¿™ä¸ªå­—å…¸æœ‰å¦‚ä¸‹5ç‚¹è¦æ±‚ï¼š\</span></span><br><span class="line"><span class="string">                           1.å­—å…¸æ€»å…±æœ‰ä¸‰ä¸ªé”®å€¼å¯¹ï¼›\</span></span><br><span class="line"><span class="string">                           2.ç¬¬ä¸€ä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²nameï¼Œvalueæ˜¯è¯¥å‡½æ•°çš„åå­—ï¼š%sï¼Œä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼›\</span></span><br><span class="line"><span class="string">                           3.ç¬¬äºŒä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²descriptionï¼Œvalueæ˜¯è¯¥å‡½æ•°çš„å‡½æ•°çš„åŠŸèƒ½è¯´æ˜ï¼Œä¹Ÿæ˜¯å­—ç¬¦ä¸²ï¼›\</span></span><br><span class="line"><span class="string">                           4.ç¬¬ä¸‰ä¸ªé”®å€¼å¯¹çš„Keyæ˜¯å­—ç¬¦ä¸²parametersï¼Œvalueæ˜¯ä¸€ä¸ªJSON Schemaå¯¹è±¡ï¼Œç”¨äºè¯´æ˜è¯¥å‡½æ•°çš„å‚æ•°è¾“å…¥è§„èŒƒã€‚\</span></span><br><span class="line"><span class="string">                           5.è¾“å‡ºç»“æœå¿…é¡»æ˜¯ä¸€ä¸ªJSONæ ¼å¼çš„å­—å…¸ï¼Œåªè¾“å‡ºè¿™ä¸ªå­—å…¸å³å¯ï¼Œå‰åä¸éœ€è¦ä»»ä½•å‰åä¿®é¥°æˆ–è¯´æ˜çš„è¯­å¥&#x27;</span> % function_name</span><br><span class="line"></span><br><span class="line">            response = client.chat.completions.create(</span><br><span class="line">                model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">                messages=[</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: system_prompt&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_prompt&#125;</span><br><span class="line">                ]</span><br><span class="line">            )</span><br><span class="line">            json_function_description = json.loads(</span><br><span class="line">                response.choices[<span class="number">0</span>].message.content.replace(<span class="string">&quot;```&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;json&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">            json_str = &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>, <span class="string">&quot;function&quot;</span>: json_function_description&#125;</span><br><span class="line">            functions.append(json_str)</span><br><span class="line">        <span class="keyword">return</span> functions</span><br><span class="line"></span><br><span class="line">    <span class="comment">## æœ€å¤§å¯ä»¥å°è¯•4æ¬¡</span></span><br><span class="line">    max_attempts = <span class="number">4</span></span><br><span class="line">    attempts = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> attempts &lt; max_attempts:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            functions = functions_generate(functions_list)</span><br><span class="line">            <span class="keyword">break</span>  <span class="comment"># å¦‚æœä»£ç æˆåŠŸæ‰§è¡Œï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            attempts += <span class="number">1</span>  <span class="comment"># å¢åŠ å°è¯•æ¬¡æ•°</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;å‘ç”Ÿé”™è¯¯ï¼š&quot;</span>, e)</span><br><span class="line">            <span class="keyword">if</span> attempts == max_attempts:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;å·²è¾¾åˆ°æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œç¨‹åºç»ˆæ­¢ã€‚&quot;</span>)</span><br><span class="line">                <span class="keyword">raise</span>  <span class="comment"># é‡æ–°å¼•å‘æœ€åä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;æ­£åœ¨é‡æ–°è¿è¡Œ...&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> functions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_conversation</span>(<span class="params">messages, functions_list=<span class="literal">None</span>, model=<span class="string">&quot;gpt-3.5-turbo&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    èƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œå¤–éƒ¨å‡½æ•°è°ƒç”¨çš„å¯¹è¯æ¨¡å‹</span></span><br><span class="line"><span class="string">    :param messages: å¿…è¦å‚æ•°ï¼Œå­—å…¸ç±»å‹ï¼Œè¾“å…¥åˆ°Chatæ¨¡å‹çš„messageså‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="string">    :param functions_list: å¯é€‰å‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œå¯ä»¥è®¾ç½®ä¸ºåŒ…å«å…¨éƒ¨å¤–éƒ¨å‡½æ•°çš„åˆ—è¡¨å¯¹è±¡</span></span><br><span class="line"><span class="string">    :param model: Chatæ¨¡å‹ï¼Œå¯é€‰å‚æ•°ï¼Œé»˜è®¤æ¨¡å‹ä¸ºgpt-3.5-turbo</span></span><br><span class="line"><span class="string">    :returnï¼šChatæ¨¡å‹è¾“å‡ºç»“æœ</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># å¦‚æœæ²¡æœ‰å¤–éƒ¨å‡½æ•°åº“ï¼Œåˆ™æ‰§è¡Œæ™®é€šçš„å¯¹è¯ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">if</span> functions_list == <span class="literal">None</span>:</span><br><span class="line">        response = client.chat.completions.create(</span><br><span class="line">            model=model,</span><br><span class="line">            messages=messages,</span><br><span class="line">        )</span><br><span class="line">        response_message = response.choices[<span class="number">0</span>].message</span><br><span class="line">        final_response = response_message.content</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è‹¥å­˜åœ¨å¤–éƒ¨å‡½æ•°åº“ï¼Œåˆ™éœ€è¦çµæ´»é€‰å–å¤–éƒ¨å‡½æ•°å¹¶è¿›è¡Œå›ç­”</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># åˆ›å»ºfunctionså¯¹è±¡</span></span><br><span class="line">        tools = auto_functions(functions_list)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ›å»ºå¤–éƒ¨å‡½æ•°åº“å­—å…¸</span></span><br><span class="line">        available_functions = &#123;func.__name__: func <span class="keyword">for</span> func <span class="keyword">in</span> functions_list&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¬¬ä¸€æ¬¡è°ƒç”¨å¤§æ¨¡å‹</span></span><br><span class="line">        response = client.chat.completions.create(</span><br><span class="line">            model=model,</span><br><span class="line">            messages=messages,</span><br><span class="line">            tools=tools,</span><br><span class="line">            tool_choice=<span class="string">&quot;auto&quot;</span>, )</span><br><span class="line">        response_message = response.choices[<span class="number">0</span>].message</span><br><span class="line"></span><br><span class="line">        tool_calls = response_message.tool_calls</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> tool_calls:</span><br><span class="line"></span><br><span class="line">            messages.append(response_message)</span><br><span class="line">            <span class="keyword">for</span> tool_call <span class="keyword">in</span> tool_calls:</span><br><span class="line">                function_name = tool_call.function.name</span><br><span class="line">                function_to_call = available_functions[function_name]</span><br><span class="line">                function_args = json.loads(tool_call.function.arguments)</span><br><span class="line">                <span class="comment">## çœŸæ­£æ‰§è¡Œå¤–éƒ¨å‡½æ•°çš„å°±æ˜¯è¿™å„¿çš„ä»£ç </span></span><br><span class="line">                function_response = function_to_call(**function_args)</span><br><span class="line">                messages.append(</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="string">&quot;tool_call_id&quot;</span>: tool_call.<span class="built_in">id</span>,</span><br><span class="line">                        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;tool&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;name&quot;</span>: function_name,</span><br><span class="line">                        <span class="string">&quot;content&quot;</span>: function_response,</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">                <span class="comment">## ç¬¬äºŒæ¬¡è°ƒç”¨æ¨¡å‹</span></span><br><span class="line">            second_response = client.chat.completions.create(</span><br><span class="line">                model=model,</span><br><span class="line">                messages=messages,</span><br><span class="line">            )</span><br><span class="line">            <span class="comment"># è·å–æœ€ç»ˆç»“æœ</span></span><br><span class="line">            final_response = second_response.choices[<span class="number">0</span>].message.content</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            final_response = response_message.content</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> final_response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chat_with_model</span>(<span class="params">functions_list=<span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                    prompt=<span class="string">&quot;ä½ å¥½&quot;</span>,</span></span><br><span class="line"><span class="params">                    model=<span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span></span><br><span class="line"><span class="params">                    system_message=[&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;ä½ æ˜¯å°æ™ºåŠ©æ‰‹ã€‚&quot;</span>&#125;]</span>):</span><br><span class="line">    messages = system_message</span><br><span class="line">    messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: prompt&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        answer = run_conversation(messages=messages,</span><br><span class="line">                                  functions_list=functions_list,</span><br><span class="line">                                  model=model)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ™ºèƒ½åŠ©æ‰‹å›ç­”: <span class="subst">&#123;answer&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¯¢é—®ç”¨æˆ·æ˜¯å¦è¿˜æœ‰å…¶ä»–é—®é¢˜</span></span><br><span class="line">        user_input = <span class="built_in">input</span>(<span class="string">&quot;æ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜å—ï¼Ÿ(è¾“å…¥é€€å‡ºä»¥ç»“æŸå¯¹è¯): &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> user_input == <span class="string">&quot;é€€å‡º&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®°å½•ç”¨æˆ·å›ç­”</span></span><br><span class="line">        messages.append(&#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: user_input&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">functions_list = [sunwukong_function, tangseng_function]</span><br><span class="line">chat_with_model(functions_list, prompt=<span class="string">&quot;ä½ å¥½&quot;</span>)</span><br></pre></td></tr></table></figure><h1 id="3-ChatGPT-Plugin"><a href="#3-ChatGPT-Plugin" class="headerlink" title="3.ChatGPT Plugin"></a>3.ChatGPT Plugin</h1><h2 id="3-1-ChatGPT-Plugin-çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#3-1-ChatGPT-Plugin-çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="3.1 ChatGPT Plugin çš„æ ¸å¿ƒæ¦‚å¿µ"></a>3.1 ChatGPT Plugin çš„æ ¸å¿ƒæ¦‚å¿µ</h2><p>ChatGPT Plugin çš„æœ¬è´¨æ˜¯ä¸€ä¸ª API æœåŠ¡ï¼Œè®© ChatGPT èƒ½è°ƒç”¨ä½ çš„æ¥å£ï¼Œæ‰©å±•åŠŸèƒ½ã€‚ä¾‹å¦‚æŸ¥è¯¢æ•°æ®åº“ã€è·å–å®æ—¶æ•°æ®ã€æ“ä½œç¬¬ä¸‰æ–¹æœåŠ¡ç­‰ç­‰ã€‚</p><ol><li><p>APIï¼šæä¾›åŠŸèƒ½çš„æ¥å£ï¼Œé€šå¸¸æ˜¯ RESTful API</p></li><li><p>OpenAPI è§„èŒƒï¼šæè¿° API çš„åŠŸèƒ½ã€å‚æ•°ã€è¿”å›ç»“æœ</p></li><li><p>Manifest æ–‡ä»¶ï¼šå®šä¹‰æ’ä»¶çš„å…ƒæ•°æ®ï¼ˆæ¯”å¦‚åç§°ã€æè¿°ã€æˆæƒç­‰ï¼‰</p></li></ol><h2 id="3-2-æ­å»º-API-æœåŠ¡"><a href="#3-2-æ­å»º-API-æœåŠ¡" class="headerlink" title="3.2 æ­å»º API æœåŠ¡"></a>3.2 æ­å»º API æœåŠ¡</h2><p>åˆ›å»ºä¸€ä¸ª Web æœåŠ¡ï¼Œæä¾› REST APIã€‚ä½ å¯ä»¥ç”¨ Flask (Python)ã€Express (Node.js)ã€FastAPI ç­‰æ¡†æ¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/get_weather&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weather</span>():</span><br><span class="line">    city = request.args.get(<span class="string">&#x27;city&#x27;</span>, <span class="string">&#x27;Beijing&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;city&quot;</span>: city, <span class="string">&quot;weather&quot;</span>: <span class="string">&quot;sunny&quot;</span>, <span class="string">&quot;temperature&quot;</span>: <span class="string">&quot;25Â°C&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><ul><li>å®šä¹‰è·¯ç”±ï¼ˆAPI ç«¯ç‚¹ï¼‰</li><li>å¤„ç†å‚æ•°å’Œè¿”å› JSON</li><li>éƒ¨ç½²åˆ°å…¬ç½‘å¯è®¿é—®æœåŠ¡å™¨</li></ul><h2 id="3-3-åˆ›å»º-OpenAPI-è§„èŒƒæ–‡ä»¶"><a href="#3-3-åˆ›å»º-OpenAPI-è§„èŒƒæ–‡ä»¶" class="headerlink" title="3.3 åˆ›å»º OpenAPI è§„èŒƒæ–‡ä»¶"></a>3.3 åˆ›å»º OpenAPI è§„èŒƒæ–‡ä»¶</h2><p>åˆ›å»ºä¸€ä¸ª <code>openapi.yaml</code> æ–‡ä»¶ï¼Œæè¿° APIã€‚ChatGPT éœ€è¦å®ƒç†è§£ä½ çš„æ’ä»¶æ€ä¹ˆè°ƒç”¨ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">openapi:</span> <span class="number">3.0</span><span class="number">.1</span></span><br><span class="line"><span class="attr">info:</span></span><br><span class="line">  <span class="attr">title:</span> <span class="string">Weather</span> <span class="string">Plugin</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">A</span> <span class="string">plugin</span> <span class="string">that</span> <span class="string">provides</span> <span class="string">weather</span> <span class="string">information</span></span><br><span class="line">  <span class="attr">version:</span> <span class="string">&#x27;1.0.0&#x27;</span></span><br><span class="line"><span class="attr">servers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">https://your-plugin-domain.com</span></span><br><span class="line"><span class="attr">paths:</span></span><br><span class="line">  <span class="string">/get_weather:</span></span><br><span class="line">    <span class="attr">get:</span></span><br><span class="line">      <span class="attr">operationId:</span> <span class="string">getWeather</span></span><br><span class="line">      <span class="attr">summary:</span> <span class="string">Get</span> <span class="string">weather</span> <span class="string">information</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">city</span></span><br><span class="line">          <span class="attr">in:</span> <span class="string">query</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">City</span> <span class="string">name</span></span><br><span class="line">          <span class="attr">required:</span> <span class="literal">false</span></span><br><span class="line">          <span class="attr">schema:</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">      <span class="attr">responses:</span></span><br><span class="line">        <span class="attr">&#x27;200&#x27;:</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">Weather</span> <span class="string">data</span></span><br><span class="line">          <span class="attr">content:</span></span><br><span class="line">            <span class="attr">application/json:</span></span><br><span class="line">              <span class="attr">schema:</span></span><br><span class="line">                <span class="attr">type:</span> <span class="string">object</span></span><br><span class="line">                <span class="attr">properties:</span></span><br><span class="line">                  <span class="attr">city:</span></span><br><span class="line">                    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">                  <span class="attr">weather:</span></span><br><span class="line">                    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">                  <span class="attr">temperature:</span></span><br><span class="line">                    <span class="attr">type:</span> <span class="string">string</span></span><br></pre></td></tr></table></figure><h2 id="3-4-åˆ›å»ºæ’ä»¶çš„-Manifest-æ–‡ä»¶"><a href="#3-4-åˆ›å»ºæ’ä»¶çš„-Manifest-æ–‡ä»¶" class="headerlink" title="3.4 åˆ›å»ºæ’ä»¶çš„ Manifest æ–‡ä»¶"></a>3.4 åˆ›å»ºæ’ä»¶çš„ Manifest æ–‡ä»¶</h2><p>åˆ›å»º <code>ai-plugin.json</code> æ–‡ä»¶ï¼Œæä¾›æ’ä»¶çš„å…ƒæ•°æ®ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;schema_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name_for_model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;weather_plugin&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name_for_human&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Weather Plugin&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description_for_model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Provides weather information for a given city.&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description_for_human&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Get real-time weather data for any city.&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;auth&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;none&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;api&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openapi&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://your-plugin-domain.com/openapi.yaml&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;logo_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://your-plugin-domain.com/logo.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;contact_email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;support@yourdomain.com&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;legal_info_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://yourdomain.com/legal&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li><code>name_for_model</code>: ç¡®ä¿ç®€çŸ­ä¸”ä¾¿äº ChatGPT è¯†åˆ«</li><li><code>auth</code>: æ”¯æŒ <code>none</code>ï¼ˆå…¬å¼€ï¼‰ã€<code>oauth</code>ï¼ˆéœ€è¦ç™»å½•æˆæƒï¼‰</li><li><code>api</code>: æŒ‡å®š OpenAPI æ–‡ä»¶åœ°å€</li><li><code>logo_url</code>: è®©æ’ä»¶ç•Œé¢æ›´ä¸“ä¸š</li></ul><h2 id="3-5-éƒ¨ç½²æ’ä»¶æœåŠ¡"><a href="#3-5-éƒ¨ç½²æ’ä»¶æœåŠ¡" class="headerlink" title="3.5 éƒ¨ç½²æ’ä»¶æœåŠ¡"></a>3.5 éƒ¨ç½²æ’ä»¶æœåŠ¡</h2><p>ç¡®ä¿ä½ çš„æœåŠ¡å¯ä»¥è¢«å¤–ç½‘è®¿é—®ï¼Œå¯ä»¥é€‰æ‹©ï¼š</p><ol><li><p>Cloudflare Pages &#x2F; Workersï¼ˆè½»é‡çº§ï¼‰</p></li><li><p>Vercel &#x2F; Renderï¼ˆé€‚åˆå‰åç«¯ä¸€èµ·æ‰˜ç®¡ï¼‰</p></li><li><p>AWS &#x2F; GCP &#x2F; Azureï¼ˆå¤§å‹é¡¹ç›®ï¼‰</p></li></ol><p>ç¡®ä¿ API æ”¯æŒ HTTPSï¼Œå¦åˆ™ ChatGPT æ— æ³•è°ƒç”¨ã€‚</p><blockquote><p>Function calling VS ChatGPT Plugin</p><p><img src="/images/3.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%9C%A8%E7%BA%BF%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/image-20250317113459547.png" alt="image-20250317113459547"></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2.Agentå®æˆ˜åŸºç¡€ä¹‹å¤§æ¨¡å‹åŸºç¡€</title>
      <link href="/2025/03/15/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/"/>
      <url>/2025/03/15/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="1-transformer"><a href="#1-transformer" class="headerlink" title="1. transformer"></a>1. transformer</h1><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315135636248.png" alt="image-20250315135636248"></p><h2 id="1-1-è¾“å…¥éƒ¨åˆ†"><a href="#1-1-è¾“å…¥éƒ¨åˆ†" class="headerlink" title="1.1 è¾“å…¥éƒ¨åˆ†"></a>1.1 è¾“å…¥éƒ¨åˆ†</h2><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315135837941.png" alt="image-20250315135837941"></p><h3 id="1-1-1-æ¡†æ¶"><a href="#1-1-1-æ¡†æ¶" class="headerlink" title="1.1.1 æ¡†æ¶"></a>1.1.1 æ¡†æ¶</h3><ol><li>æºæ–‡æœ¬ï¼šåµŒå…¥å±‚ä»¥åŠä½ç½®ç¼–ç å™¨</li><li>ç›®æ ‡æ–‡æœ¬ï¼šåµŒå…¥å±‚ä»¥åŠä½ç½®ç¼–ç å™¨</li></ol><h3 id="1-1-2-ç»„ä»¶"><a href="#1-1-2-ç»„ä»¶" class="headerlink" title="1.1.2 ç»„ä»¶"></a>1.1.2 ç»„ä»¶</h3><h4 id="1-1-2-1-æ–‡æœ¬åµŒå…¥å±‚-Embedding"><a href="#1-1-2-1-æ–‡æœ¬åµŒå…¥å±‚-Embedding" class="headerlink" title="1.1.2.1 æ–‡æœ¬åµŒå…¥å±‚ (Embedding)"></a>1.1.2.1 æ–‡æœ¬åµŒå…¥å±‚ (Embedding)</h4><ul><li><p>æ¦‚å¿µï¼š<br>æ–‡æœ¬åµŒå…¥å±‚ç”¨äºå°†ç¦»æ•£çš„è¯æˆ–ç¬¦å·è½¬åŒ–ä¸ºè¿ç»­çš„å‘é‡è¡¨ç¤ºï¼Œä½¿å¾—æ¯ä¸ªè¯éƒ½æ‹¥æœ‰ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¯­ä¹‰è¡¨ç¤ºã€‚</p></li><li><p>ä½œç”¨ï¼š  </p><ul><li>å°†è¯æ±‡è½¬æ¢ä¸ºä½ç»´å‘é‡ï¼Œä¾¿äºåç»­çš„è®¡ç®—å¤„ç†ã€‚  </li><li>æ•è·è¯ä¸è¯ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼Œä¸ºæ¨¡å‹ç†è§£æ–‡æœ¬æä¾›åŸºç¡€ä¿¡æ¯ã€‚</li></ul></li></ul><h4 id="1-1-2-2-ä½ç½®ç¼–ç å™¨-Positional-Encoding"><a href="#1-1-2-2-ä½ç½®ç¼–ç å™¨-Positional-Encoding" class="headerlink" title="1.1.2.2 ä½ç½®ç¼–ç å™¨ (Positional Encoding)"></a>1.1.2.2 ä½ç½®ç¼–ç å™¨ (Positional Encoding)</h4><ul><li><p>æ¦‚å¿µï¼š<br>ä½ç½®ç¼–ç å™¨ä¸ºåµŒå…¥å‘é‡æ·»åŠ ä½ç½®ä¿¡æ¯ï¼Œç”±äºåµŒå…¥å±‚æœ¬èº«ä¸åŒ…å«è¯åºä¿¡æ¯ï¼Œä½ç½®ç¼–ç å™¨å¼¥è¡¥äº†è¿™ä¸€ä¸è¶³ã€‚</p></li><li><p>ä½œç”¨ï¼š  </p><ul><li>æ³¨å…¥åºåˆ—ä¸­å„è¯çš„ç›¸å¯¹æˆ–ç»å¯¹ä½ç½®ä¿¡æ¯ï¼Œå¸®åŠ©æ¨¡å‹è¯†åˆ«è¯åºã€‚  </li><li>ä¿æŒè¯­æ³•ç»“æ„ï¼Œç¡®ä¿æ¨¡å‹ç†è§£å¥å­å†…éƒ¨çš„ä¾èµ–å…³ç³»ã€‚</li></ul></li></ul><h2 id="1-2-è¾“å‡ºéƒ¨åˆ†"><a href="#1-2-è¾“å‡ºéƒ¨åˆ†" class="headerlink" title="1.2 è¾“å‡ºéƒ¨åˆ†"></a>1.2 è¾“å‡ºéƒ¨åˆ†</h2><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315140112908.png" alt="image-20250315140112908"></p><h3 id="1-2-1-æ¡†æ¶"><a href="#1-2-1-æ¡†æ¶" class="headerlink" title="1.2.1 æ¡†æ¶"></a>1.2.1 æ¡†æ¶</h3><ol><li>çº¿æ€§å±‚  </li><li>softmax å¤„ç†å™¨</li></ol><h2 id="1-3-è§£ç å™¨éƒ¨åˆ†"><a href="#1-3-è§£ç å™¨éƒ¨åˆ†" class="headerlink" title="1.3 è§£ç å™¨éƒ¨åˆ†"></a>1.3 è§£ç å™¨éƒ¨åˆ†</h2><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315140122384.png" alt="image-20250315140122384"></p><h3 id="1-3-1-æ¡†æ¶"><a href="#1-3-1-æ¡†æ¶" class="headerlink" title="1.3.1 æ¡†æ¶"></a>1.3.1 æ¡†æ¶</h3><ol><li>ç”± N ä¸ªç¼–ç å™¨å †å   </li><li>æ¯ä¸ªç¼–ç å™¨åŒ…å«ä¸¤ä¸ªå­å±‚ï¼š<ul><li>ç¬¬ä¸€ä¸ªå­å±‚ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›å­å±‚ + è§„èŒƒåŒ–å±‚ + æ®‹å·®è¿æ¥  </li><li>ç¬¬äºŒä¸ªå­å±‚ï¼šå‰é¦ˆå…¨è¿æ¥å­å±‚ + è§„èŒƒåŒ–å±‚ + æ®‹å·®è¿æ¥</li></ul></li></ol><h3 id="1-3-2-ç»„ä»¶"><a href="#1-3-2-ç»„ä»¶" class="headerlink" title="1.3.2 ç»„ä»¶"></a>1.3.2 ç»„ä»¶</h3><h4 id="1-3-2-1-æ©ç å¼ é‡-mask"><a href="#1-3-2-1-æ©ç å¼ é‡-mask" class="headerlink" title="1.3.2.1 æ©ç å¼ é‡ (mask)"></a>1.3.2.1 æ©ç å¼ é‡ (mask)</h4><ul><li><p>æ¦‚å¿µï¼š<br>æ©ç å¼ é‡ç”¨äºå±è”½æ‰ä¸åº”å‚ä¸è®¡ç®—çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å¡«å……ç¬¦å·æˆ–åœ¨ç”Ÿæˆä»»åŠ¡ä¸­éœ€è¦å±è”½æœªæ¥çš„ä¿¡æ¯ã€‚</p></li><li><p>ä½œç”¨ï¼š  </p><ul><li>é˜²æ­¢æ¨¡å‹åœ¨è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°æ—¶è€ƒè™‘åˆ°æ— å…³æˆ–ä¸å…è®¸è®¿é—®çš„ä¿¡æ¯ã€‚  </li><li>ç¡®ä¿è®­ç»ƒè¿‡ç¨‹ä¸­çš„å› æœå…³ç³»ï¼ˆä¾‹å¦‚åœ¨è‡ªå›å½’ç”Ÿæˆæ¨¡å‹ä¸­å±è”½æœªæ¥æ—¶åˆ»ï¼‰ã€‚</li></ul></li></ul><h4 id="1-3-2-2-è‡ªæ³¨æ„åŠ›æœºåˆ¶"><a href="#1-3-2-2-è‡ªæ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.3.2.2 è‡ªæ³¨æ„åŠ›æœºåˆ¶"></a>1.3.2.2 è‡ªæ³¨æ„åŠ›æœºåˆ¶</h4><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315143826474.png" alt="image-20250315143826474"></p><p>$$<br>\text{Attention}(Q, K, V) &#x3D; \text{softmax} \left( \frac{QK^T}{\sqrt{d_k}} \right) V<br>$$</p><ul><li><p>æ¦‚å¿µï¼š<br>è‡ªæ³¨æ„åŠ›æœºåˆ¶å…è®¸æ¨¡å‹åœ¨è®¡ç®—å½“å‰è¯çš„è¡¨ç¤ºæ—¶ï¼ŒåŒæ—¶è€ƒè™‘åºåˆ—ä¸­æ‰€æœ‰å…¶ä»–ä½ç½®çš„è¯ï¼Œä»è€Œæ•æ‰å…¨å±€ä¾èµ–å…³ç³»ã€‚</p></li><li><p>ä½œç”¨ï¼š  </p><ul><li>åŠ¨æ€è°ƒæ•´æ¯ä¸ªè¯åœ¨æ•´ä½“è¯­ä¹‰è¡¨ç¤ºä¸­çš„æƒé‡ã€‚  </li><li>æå‡æ¨¡å‹å¯¹é•¿è·ç¦»ä¾èµ–å…³ç³»çš„æ•æ‰èƒ½åŠ›ã€‚</li></ul></li></ul><blockquote><p>è¯´æ˜ï¼š è¾“å…¥çš„ Qã€Kã€V é€šå¸¸ä¸­ï¼ŒK ä¸ V æ˜¯ç›¸åŒçš„ï¼Œè€Œ Q å¯ä»¥ä¸åŒï¼›ç‰¹æ®Šæƒ…å†µä¸‹ Q&#x3D;K&#x3D;V åˆ™ç§°ä¸ºæ ‡å‡†çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚</p></blockquote><h4 id="1-3-2-3-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"><a href="#1-3-2-3-å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶" class="headerlink" title="1.3.2.3 å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶"></a>1.3.2.3 å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</h4><p><img src="/images/2.Agent%E5%AE%9E%E6%88%98%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80/image-20250315144535063.png" alt="image-20250315144535063"></p><ul><li><p>æ¦‚å¿µï¼š<br>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶é€šè¿‡å°†è¾“å…¥çš„ç‰¹å¾å‘é‡åˆ’åˆ†ä¸ºå¤šä¸ªå­ç©ºé—´ï¼ˆheadï¼‰ï¼Œåœ¨æ¯ä¸ªå­ç©ºé—´ä¸Šåˆ†åˆ«è®¡ç®—æ³¨æ„åŠ›ï¼Œç„¶åå°†ç»“æœåˆå¹¶ï¼Œè·å¾—æ›´ä¸°å¯Œçš„è¡¨ç¤ºã€‚</p></li><li><p>ä½œç”¨ï¼š  </p><ul><li>ä½¿æ¨¡å‹èƒ½åœ¨ä¸åŒçš„å­ç©ºé—´ä¸­æ•æ‰å¤šç§è¯­ä¹‰ä¿¡æ¯ã€‚  </li><li>å¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å’Œç¨³å®šæ€§ï¼Œé¿å…å•ä¸€æ³¨æ„åŠ›å¤´çš„å±€é™æ€§ã€‚</li></ul></li></ul><h2 id="2-Open-GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”"><a href="#2-Open-GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”" class="headerlink" title="2. Open GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”"></a>2. Open GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”</h2><h3 id="2-1-ä¸åŒæ¨¡å‹å¯¹æ¯”"><a href="#2-1-ä¸åŒæ¨¡å‹å¯¹æ¯”" class="headerlink" title="2.1 ä¸åŒæ¨¡å‹å¯¹æ¯”"></a>2.1 ä¸åŒæ¨¡å‹å¯¹æ¯”</h3><table><thead><tr><th>æ¨¡å‹</th><th>ç»“æ„</th><th>ä½ç½®ç¼–ç </th><th>æ¿€æ´»å‡½æ•°</th><th>Layer Normæ–¹æ³•</th></tr></thead><tbody><tr><td>åŸç”Ÿ</td><td>Encoder-Decoder</td><td>Sinusoidalç¼–ç </td><td>ReLU</td><td>Post Layer Norm</td></tr><tr><td>Transformer</td><td>Encoder-Decoder</td><td>Sinusoidalç¼–ç </td><td>ReLU</td><td>Post Layer Norm</td></tr><tr><td>BERT</td><td>Encoder</td><td>ç»å¯¹ä½ç½®ç¼–ç </td><td>GeLU</td><td>Post Layer Norm</td></tr><tr><td>LLaMA</td><td>Casual Decoder</td><td>RoPE</td><td>SwiGLU</td><td>Pre RMS Norm</td></tr><tr><td>ChatGLM-6B</td><td>Prefix Decoder</td><td>RoPE</td><td>GeGLU</td><td>Post Deep Norm</td></tr><tr><td>Bloom</td><td>Casual Decoder</td><td>ALiBi</td><td>GeLU</td><td>Pre Layer Norm</td></tr></tbody></table><h3 id="2-2-GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”"><a href="#2-2-GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”" class="headerlink" title="2.2 GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”"></a>2.2 GPTä¸åŒç‰ˆæœ¬å¯¹æ¯”</h3><table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>GPT1</th><th>GPT2</th><th>GPT3</th><th>GPT3.5</th><th>GPT4.0</th></tr></thead><tbody><tr><td>æ¨¡å‹è§„æ¨¡</td><td>117M</td><td>1.5B</td><td>175B</td><td>175B</td><td>ä¸‡äº¿çº§åˆ«</td></tr><tr><td>Transformerå±‚æ•°</td><td>12</td><td>48</td><td>96</td><td>96</td><td>120</td></tr><tr><td>ä¸»è¦è´¡çŒ®</td><td>å¤šä»»åŠ¡å­¦ä¹ </td><td>prompt engineering</td><td>å°‘æ ·æœ¬å­¦ä¹ </td><td>ChatGPTå‘å¸ƒ</td><td>è§„æ¨¡ä¸æ€§èƒ½æå‡</td></tr><tr><td>å‘å¸ƒæ—¥æœŸ</td><td>2018å¹´</td><td>2019å¹´</td><td>2020å¹´</td><td>2022å¹´</td><td>2023å¹´</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1.AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆè¯¾ç¨‹å¯¼è¯»</title>
      <link href="/2025/03/14/1.AI%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AF%BB/"/>
      <url>/2025/03/14/1.AI%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88%E8%AF%BE%E7%A8%8B%E5%AF%BC%E8%AF%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸ¯-ç¬¬ä¸€é˜¶æ®µï¼šæ‰“å¥½åŸºç¡€"><a href="#ğŸ¯-ç¬¬ä¸€é˜¶æ®µï¼šæ‰“å¥½åŸºç¡€" class="headerlink" title="ğŸ¯ ç¬¬ä¸€é˜¶æ®µï¼šæ‰“å¥½åŸºç¡€"></a>ğŸ¯ <strong>ç¬¬ä¸€é˜¶æ®µï¼šæ‰“å¥½åŸºç¡€</strong></h1><p><strong>ç›®æ ‡</strong>ï¼šç†è§£å¤§æ¨¡å‹åŸºç¡€çŸ¥è¯†ï¼ŒæŒæ¡Agentå¼€å‘æ ¸å¿ƒæ¦‚å¿µå’Œå·¥å…·<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š</p><ol><li>AIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å·¥ç¨‹å¸ˆè¯¾ç¨‹å¯¼è¯»</li><li>Agentå®æˆ˜åŸºç¡€ä¹‹å¤§æ¨¡å‹åŸºç¡€</li><li>Agentå®æˆ˜åŸºç¡€ä¹‹åœ¨çº¿å¤§æ¨¡å‹å¼€å‘</li><li>Agentå®æˆ˜åŸºç¡€ä¹‹æç¤ºè¯å·¥ç¨‹å’ŒFunctionè¿›é˜¶å®æˆ˜</li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>ç†Ÿæ‚‰å¤§æ¨¡å‹æ¦‚å¿µã€åŸç†å’Œå¼€å‘ç¯å¢ƒ</li><li>æŒæ¡æç¤ºè¯å·¥ç¨‹ã€Functionè°ƒç”¨ï¼Œæé«˜æ¨¡å‹äº¤äº’èƒ½åŠ›</li></ul><h1 id="ğŸš€-ç¬¬äºŒé˜¶æ®µï¼šå¼ºåŒ–å¤šæ¨¡æ€ä¸Agentæ¶æ„å®æˆ˜"><a href="#ğŸš€-ç¬¬äºŒé˜¶æ®µï¼šå¼ºåŒ–å¤šæ¨¡æ€ä¸Agentæ¶æ„å®æˆ˜" class="headerlink" title="ğŸš€ ç¬¬äºŒé˜¶æ®µï¼šå¼ºåŒ–å¤šæ¨¡æ€ä¸Agentæ¶æ„å®æˆ˜"></a>ğŸš€ <strong>ç¬¬äºŒé˜¶æ®µï¼šå¼ºåŒ–å¤šæ¨¡æ€ä¸Agentæ¶æ„å®æˆ˜</strong></h1><p><strong>ç›®æ ‡</strong>ï¼šæŒæ¡å¤šæ¨¡æ€å¤§æ¨¡å‹å¼€å‘ï¼Œç†Ÿæ‚‰Agentæ¶æ„ä¸è½åœ°æ–¹æ¡ˆ<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š </p><ol start="5"><li><p>Agentå®æˆ˜åŸºç¡€ä¹‹å¤šæ¨¡æ€å¤§æ¨¡å‹å®æˆ˜</p></li><li><p>Agentå®æˆ˜åŸºç¡€ä¹‹Agentæ¶æ„ä¸è½åœ°æ–¹æ¡ˆ</p></li><li><p>Agentå®æˆ˜åŸºç¡€ä¹‹ReActæ¶æ„å®æˆ˜</p></li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>ç†è§£å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼ˆå›¾åƒã€æ–‡æœ¬ã€è¯­éŸ³ï¼‰èåˆå¼€å‘</li><li>ç†Ÿæ‚‰Agentæ¶æ„ï¼ˆä¼ ç»Ÿ+ReActæ€è·¯ï¼‰ï¼ŒæŒæ¡å¤šåœºæ™¯è½åœ°å®ç°</li></ul><h1 id="ğŸ”§-ç¬¬ä¸‰é˜¶æ®µï¼šè¿›é˜¶å¼€å‘æŠ€èƒ½å¼ºåŒ–"><a href="#ğŸ”§-ç¬¬ä¸‰é˜¶æ®µï¼šè¿›é˜¶å¼€å‘æŠ€èƒ½å¼ºåŒ–" class="headerlink" title="ğŸ”§ ç¬¬ä¸‰é˜¶æ®µï¼šè¿›é˜¶å¼€å‘æŠ€èƒ½å¼ºåŒ–"></a>ğŸ”§ <strong>ç¬¬ä¸‰é˜¶æ®µï¼šè¿›é˜¶å¼€å‘æŠ€èƒ½å¼ºåŒ–</strong></h1><p><strong>ç›®æ ‡</strong>ï¼šç†Ÿç»ƒæŒæ¡æ ¸å¿ƒå·¥å…·é“¾ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œåº”ç”¨èƒ½åŠ›<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š </p><ol start="8"><li><p>Agentå®æˆ˜æŠ€èƒ½ä¹‹Difyæ™ºèƒ½åº”ç”¨å¼€å‘</p></li><li><p>Agentå®æˆ˜æŠ€èƒ½ä¹‹Assistants API</p></li><li><p>Agentå®æˆ˜æŠ€èƒ½ä¹‹LangChainå…¨é¢å‰–æ</p></li><li><p>Agentå®æˆ˜æŠ€èƒ½ä¹‹LangGraphæ·±åº¦å®æˆ˜</p></li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>ä¸Šæ‰‹Difyç­‰æ™ºèƒ½åº”ç”¨å¼€å‘å¹³å°</li><li>æ·±å…¥æŒæ¡LangChainã€LangGraphï¼Œå®ç°å¤æ‚ä¸šåŠ¡é€»è¾‘ç¼–æ’</li></ul><h1 id="ğŸ—ï¸-ç¬¬å››é˜¶æ®µï¼šå¤§å‹é¡¹ç›®å®æˆ˜æ¼”ç»ƒ"><a href="#ğŸ—ï¸-ç¬¬å››é˜¶æ®µï¼šå¤§å‹é¡¹ç›®å®æˆ˜æ¼”ç»ƒ" class="headerlink" title="ğŸ—ï¸ ç¬¬å››é˜¶æ®µï¼šå¤§å‹é¡¹ç›®å®æˆ˜æ¼”ç»ƒ"></a>ğŸ—ï¸ <strong>ç¬¬å››é˜¶æ®µï¼šå¤§å‹é¡¹ç›®å®æˆ˜æ¼”ç»ƒ</strong></h1><p><strong>ç›®æ ‡</strong>ï¼šå®Œæˆä»0åˆ°1çš„å¤§å‹å•†ä¸šé¡¹ç›®å¼€å‘ï¼Œç§¯ç´¯å®æˆ˜ç»éªŒ<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š </p><ol start="12"><li><p>Agentå¤§å‹é¡¹ç›®å®æˆ˜1:ç™¾äº¿çº§æ™ºèƒ½æ•°æ®åˆ†æå¹³å°</p></li><li><p>Agentå¤§å‹é¡¹ç›®å®æˆ˜2:å¤šæ¨¡æ€Agentå•†ä¸šå¹³å°</p></li><li><p>Agentå¤§å‹é¡¹ç›®å®æˆ˜3:ChatBIå³å¸­æŸ¥è¯¢å¹³å°</p></li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>å…·å¤‡å¤§è§„æ¨¡æ•°æ®åˆ†æå¹³å°æ­å»ºèƒ½åŠ›</li><li>ç†Ÿæ‚‰å¤šæ¨¡æ€Agentåœ¨å•†ä¸šåœºæ™¯è½åœ°å¼€å‘</li><li>æŒæ¡ChatBIæŸ¥è¯¢å¹³å°çš„å®Œæ•´è®¾è®¡ä¸å®ç°</li></ul><h1 id="ğŸ§ -ç¬¬äº”é˜¶æ®µï¼šRAGæ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–çªç ´"><a href="#ğŸ§ -ç¬¬äº”é˜¶æ®µï¼šRAGæ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–çªç ´" class="headerlink" title="ğŸ§  ç¬¬äº”é˜¶æ®µï¼šRAGæ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–çªç ´"></a>ğŸ§  <strong>ç¬¬äº”é˜¶æ®µï¼šRAGæ¶æ„ä¸æ€§èƒ½ä¼˜åŒ–çªç ´</strong></h1><p><strong>ç›®æ ‡</strong>ï¼šæŒæ¡RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯ï¼Œè§£å†³å¤§æ¨¡å‹çŸ¥è¯†ç“¶é¢ˆ<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š </p><ol start="15"><li><p>RAGå®æˆ˜åŸºç¡€ä¹‹RAGæ¶æ„æ¼”è¿›ä¹‹è·¯</p></li><li><p>RAGå®æˆ˜åŸºç¡€ä¹‹RAGæŠ€æœ¯é€‰å‹</p></li><li><p>RAGå®æˆ˜åŸºç¡€ä¹‹æ€§èƒ½ä¼˜åŒ–</p></li><li><p>RAGå®æˆ˜è¿›é˜¶ä¹‹GraphRAGå®æˆ˜</p></li><li><p>RAGé¡¹ç›®å®æˆ˜:é«˜æ€§èƒ½RAGå•†ä¸šé¡¹ç›®</p></li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>ç†è§£RAGåŸç†ä¸æ¶æ„æ¼”è¿›</li><li>æŒæ¡RAGç³»ç»Ÿæ­å»ºä¸æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</li><li>ä¸Šæ‰‹GraphRAGè¿›é˜¶ç©æ³•ï¼Œè½åœ°é«˜æ€§èƒ½RAGé¡¹ç›®</li></ul><h1 id="ğŸ”¥-ç¬¬å…­é˜¶æ®µï¼šDeepSeekä¸“é¢˜æ·±åº¦ç ”ä¹ "><a href="#ğŸ”¥-ç¬¬å…­é˜¶æ®µï¼šDeepSeekä¸“é¢˜æ·±åº¦ç ”ä¹ " class="headerlink" title="ğŸ”¥ ç¬¬å…­é˜¶æ®µï¼šDeepSeekä¸“é¢˜æ·±åº¦ç ”ä¹ "></a>ğŸ”¥ <strong>ç¬¬å…­é˜¶æ®µï¼šDeepSeekä¸“é¢˜æ·±åº¦ç ”ä¹ </strong></h1><p><strong>ç›®æ ‡</strong>ï¼šæ·±å…¥æ¢ç´¢å¤§æ¨¡å‹é¢†åŸŸæœ€æ–°æŠ€æœ¯è¶‹åŠ¿ï¼Œå®Œæˆä¼ä¸šçº§é¡¹ç›®äº¤ä»˜<br> ğŸ“Œ <strong>è¯¾ç¨‹æ¨¡å—</strong>ï¼š </p><ol start="20"><li><p>DeepSeekä¸“é¢˜ä¹‹å¤§æ¨¡å‹APIå®æˆ˜</p></li><li><p>DeepSeekä¸“é¢˜ä¹‹ç»Ÿä¸€å¤šæ¨¡æ€æ¨¡å‹</p></li><li><p>DeepSeekä¸“é¢˜ä¹‹å¾®è°ƒè¡Œä¸šå¤§æ¨¡å‹</p></li><li><p>DeepSeekä¸“é¢˜ä¹‹è’¸é¦ä¸“å±å¤§æ¨¡å‹</p></li><li><p>DeepSeekä¸“é¢˜ä¹‹ä¼ä¸šçº§æ™ºèƒ½ä½“å®¢æœé¡¹ç›®</p></li></ol><p>âœ… <strong>å­¦ä¹ æˆæœ</strong>ï¼š</p><ul><li>æŒæ¡DeepSeek APIä¸å¤šæ¨¡æ€æ¨¡å‹å¼€å‘</li><li>ç†è§£å¤§æ¨¡å‹å¾®è°ƒã€è’¸é¦ä¸ä¸“å±æ¨¡å‹æ‰“é€ </li><li>å®Œæˆä¼ä¸šçº§æ™ºèƒ½ä½“å®¢æœç³»ç»Ÿè½åœ°</li></ul>]]></content>
      
      
      <categories>
          
          <category> AIå¤§æ¨¡å‹å¼€å‘å·¥ç¨‹å¸ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
